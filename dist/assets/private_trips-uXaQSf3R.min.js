import{_ as U,D as H,e as Q,y as X,z as Y,f as u,t as Z,r as f,o as c,c as y,g as w,h as d,i as h,j as V,A as L,a as B,d as T,b as F,m as $,s as ee,p as te}from"./index.min.js";const se=T(()=>F(()=>import("./map-OGlwx9xa.min.js"),__vite__mapDeps([0,1,2,3]))),ne=T(()=>F(()=>import("./trip_page-o4OZqEmS.min.js"),__vite__mapDeps([4,2,3,5,1]))),ae=T(()=>F(()=>import("./usertype_picker-iazfrFKo.min.js"),__vite__mapDeps([6,2,3]))),oe={components:{datatabble:H,maps:se,delete_icon:Q,car_icon:X,route_icon:Y,trip_page:ne,usertype_picker:ae},name:"Destinations",setup(s){const l=s.conf.url+s.path+"?load=json",C=u(null),t=u({}),i=u({}),k=u({}),_=u([]),v=u(""),I=u(!1),p=u(!1),b=u(!1),a=()=>{};(()=>{$(l).then(e=>{i.value=JSON.parse(JSON.stringify(e)),N(i.value.items),O()})})();const N=e=>{for(let n=0;n<e.length;n++)R(e[n])},P=(e,n)=>{t.value=e;for(let r=0;r<i.value.items.length;r++)i.value.items[r].selected=!1;i.value.items[n].selected=!0;let o,g,J=s.conf.url+"uploads/images/yellow_pin.gif",q=s.conf.url+"uploads/images/blue_pin.gif",G=s.conf.url+"uploads/images/car.svg",K=s.conf.url+"uploads/images/destination.svg",m=[],E={lat:parseFloat(e.vehicle.last_latitude),lng:parseFloat(e.vehicle.last_longitude)};m[0]={drag:!0,status:"waiting",icon:G,origin:E,destination:E};for(let r=0;r<e.pickup_locations.length;r++)o=e.pickup_locations[r],g=r?e.pickup_locations[r-1].location:o.location,m[r+1]={status:o.status,icon:o.status=="waiting"?q:J,origin:{lat:parseFloat(g.latitude),lng:parseFloat(g.longitude)},destination:{lat:parseFloat(o.location.latitude),lng:parseFloat(o.location.longitude)}};return m[m.length]={drag:!0,icon:K,origin:{lat:0,lng:0},destination:{lat:parseFloat(e.route.latitude),lng:parseFloat(e.route.longitude)}},k.value=m[0].destination,_.value=m,m},A=async()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{k.value={lat:e.coords.latitude,lng:e.coords.longitude}},e=>{ee(e.message,5e3)})};A();const O=()=>{for(let e=0;e<i.value.items.length;e++)i.value.items[e].active=v.value.trim()?D(i.value.items[e]):1},D=e=>{let n=!!e.student_name.toLowerCase().includes(v.value.toLowerCase());return n||!!e.location_name.toLowerCase().includes(v.toLowerCase())},S=e=>{t.value=e,z("edit",e)},j=(e,n,o)=>{t.value=o,t.value.latitude=o.destination.lat,t.value.longitude=o.destination.lng,z("edit",t.value)},R=e=>(e.icon=s.conf.url+"uploads/images/blue_pin.gif",e.origin=e.destination={lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)},e.drag=!0,e),z=(e,n)=>{switch(e){case"view":break;case"edit":x(n,!0);break;case"delete":te("destination_id",n,"Destination.delete");break}},M=(e,n)=>{let o=[];for(let g=0;g<e.length;g++)e[g].status==n;return o},x=(e,n=!0)=>{p.value=n,t.value=e};return{setType:e=>{t.value.usertype=e,b.value=!1,showWizard.value=!0},showOptions:b,editFields:x,showTrip:p,activeTrip:C,locations:_,url:l,content:i,center:k,activeItem:t,callback:()=>{x(null,!1),p.value=!1},filterLocations:M,translate:Z,clickMarker:j,updateMarker:S,setLocationsMarkers:P,checkSimilar:D,searchTextChanged:O,searchText:v,getUserLocation:A,collapsed:I,closeSide:a,handleAction:z}},props:["path","lang","setting","conf","auth"]},le={class:"w-full overflow-auto"},ie={key:4,class:"w-full relative"},re={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},ce=["textContent"],ue=["textContent"],de=h("hr",{class:"mt-2"},null,-1),ge={class:"w-full bg-white"},me=["src"],_e=["onClick"],ve=["onClick"];function he(s,l,C,t,i,k){const _=f("subscription_wizard"),v=f("usertype_picker"),I=f("vue-feather"),p=f("delete_icon"),b=f("datatabble");return c(),y("div",le,[s.showWizard&&t.activeItem.usertype=="employee"?(c(),w(_,{onCallback:l[0]||(l[0]=a=>s.showWizard=!1),usertype:t.activeItem.usertype,userslist:t.content.employees,key:s.showWizard,packages:t.content.packages,system_setting:s.system_setting,item:t.activeItem,business_setting:s.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):d("",!0),s.showWizard&&t.activeItem.usertype=="supervisor"?(c(),w(_,{onCallback:l[1]||(l[1]=a=>s.showWizard=!1),usertype:t.activeItem.usertype,userslist:t.content.supervisors,key:s.showWizard,packages:t.content.packages,system_setting:s.system_setting,item:t.activeItem,business_setting:s.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):d("",!0),s.showWizard&&t.activeItem.usertype=="student"?(c(),w(_,{onCallback:l[2]||(l[2]=a=>s.showWizard=!1),usertype:t.activeItem.usertype,userslist:t.content.students,key:s.showWizard,packages:t.content.packages,system_setting:s.system_setting,item:t.activeItem,business_setting:s.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):d("",!0),!s.showWizard&&t.showOptions?(c(),w(v,{key:t.showOptions,auth:C.auth,item:t.activeItem,onCallback:t.setType},null,8,["auth","item","onCallback"])):d("",!0),t.content&&!t.showTrip?(c(),y("div",ie,[t.content?(c(),y("main",{key:t.content.items,class:"flex-1 overflow-x-hidden overflow-y-auto w-full"},[h("div",re,[h("h1",{class:"font-bold text-lg w-full",textContent:V(t.content.title)},null,8,ce),h("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg bg-danger",onClick:l[3]||(l[3]=a=>t.showOptions=!0),textContent:V(t.translate("add_new"))},null,8,ue)]),de,h("div",ge,[t.content.columns?(c(),w(b,{key:0,class:"align-middle fs-6 gy-5 table table-row-dashed px-6","body-text-direction":t.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:t.content.columns,items:t.content.items},{"item-picture":L(a=>[h("img",{src:a.picture,class:"w-8 h-8 rounded-full"},null,8,me)]),"item-details":L(a=>[a.not_editable?d("",!0):(c(),y("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:W=>t.handleAction("edit",a)},[B(I,{class:"w-5",type:"edit"})],8,_e))]),"item-delete":L(a=>[a.not_removeable?d("",!0):(c(),y("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:W=>t.handleAction("delete",a)},[B(p,{class:"w-5"})],8,ve))]),_:1},8,["body-text-direction","headers","items"])):d("",!0)])])):d("",!0)])):d("",!0)])}const we=U(oe,[["render",he]]);export{we as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-OGlwx9xa.min.js","index.es-4z_hVD90.min.js","index.min.js","index.min.css","trip_page-o4OZqEmS.min.js","help-QMf3rqBc.min.js","usertype_picker-iazfrFKo.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
