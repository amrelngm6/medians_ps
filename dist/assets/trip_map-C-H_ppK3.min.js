import{_ as F,r as t,U as G,a as y,o as d,c as x,y as D,O as P,g as L,F as S,f as z,d as p,b as I,ai as E}from"./index.min.js";import{O as J,L as W,j as Z}from"./index.es-BqyRJkQ3.min.js";const A={components:{GoogleMap:J,Polyline:W,CustomMarker:Z},emits:["markerclicked"],setup(m,{emit:h}){const i=t(null),o=t(null),C=t(12),s=t([]),r=t([]),c=t([]),g=t({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),n=t(m.trip),_=(e,l="lat",k="lng",M)=>{let a=JSON.parse(JSON.stringify(e));return a.icon=m.conf.url+"uploads/images/"+M,a.marker_position={lat:parseFloat(e[l]),lng:parseFloat(e[k])},a.drag=!1,a};(()=>{s.value=[_(n.value,"pickup_latitude","pickup_longitude","car.svg")],s.value[s.value.length]=_(n.value,"destination_latitude","destination_longitude","destination.svg")})();const v=t({lat:0,lng:0}),f=t({lat:0,lng:0}),w=t(null),u=t(null),N=()=>{setTimeout(function(){w.value=new window.google.maps.DirectionsService,u.value=new window.google.maps.DirectionsRenderer({draggable:!0,map:i,panel:document.getElementById("panel")}),u.value.addListener("directions_changed",()=>{const e=u.value.getDirections();e&&R(e)}),B(v.value,f.value,w.value,u.value)},1e3)},B=(e,l,k,M)=>{k.route({origin:e,destination:l,waypoints:[],travelMode:google.maps.TravelMode.DRIVING,avoidTolls:!0}).then(a=>{console.log(a);const O=E(a.routes[0].overview_polyline.points);c.value=O,r.value={path:O,geodesic:!0,strokeColor:"#000",strokeOpacity:.9,strokeWeight:2}}).catch(a=>{alert("Could not display directions due to: "+a)})},R=e=>{const l=e.routes[0];!l||l.legs},T=async()=>N();return G(()=>{v.value={lat:n.value.pickup_latitude,lng:n.value.pickup_longitude},o.value=v.value,f.value={lat:n.value.destination_latitude,lng:n.value.destination_longitude},T()}),{map:i,markerClicked:e=>{h("markerclicked",e)},markers:s,mapCenter:o,mapZoom:C,polylinePath:r,routeCoordinates:c,polylineOptions:g}},props:["system_setting","trip","conf"]},U={class:"w-full overflow-auto"},b={style:{"text-align":"center"}},j=["src"],q=p("div",{id:"panel"},null,-1),H=p("div",{id:"total"},null,-1);function K(m,h,i,o,C,s){const r=y("Polyline"),c=y("CustomMarker"),g=y("GoogleMap");return d(),x("div",U,[o.mapCenter?(d(),D(g,{"api-key":i.system_setting.google_map_api,ref:"map",center:o.mapCenter,key:`${o.mapCenter.lat},${o.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:o.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:P(()=>[L(r,{options:o.polylinePath},null,8,["options"]),(d(!0),x(S,null,z(o.markers,(n,_)=>(d(),D(c,{options:{position:n.marker_position},onClick:V=>o.markerClicked(n)},{default:P(()=>[p("div",b,[p("img",{src:n.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,j)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):I("",!0),q,H])}const $=F(A,[["render",K]]);export{$ as t};
