const __vite__fileDeps=["form_field-DSvRoxGR.min.js","index.min.js","index.min.css","Field-DGSjrbSi.min.js","Field.min.css","editable_map_location-C3m7cXEh.min.js","index.es-BqyRJkQ3.min.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as ae,E as ne,x as oe,G as ie,r as o,t as x,al as N,a as I,o as r,c as u,b as m,d as t,g as p,e as n,n as ce,I as de,q as re,u as ue,s as j,J as A,a7 as _e,l as ve,K as me,L as M,M as he,p as fe}from"./index.min.js";import{e as ge}from"./editable_map_location-C3m7cXEh.min.js";import{d as xe}from"./drivers_locations_map-DiTe87JV.min.js";import{t as pe}from"./tooltip-B6mCVe86.min.js";import{t as we}from"./trip_map-CXYk26HB.min.js";import"./index.es-BqyRJkQ3.min.js";const be=re(()=>ue(()=>import("./form_field-DSvRoxGR.min.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ce={components:{trip_map:we,close_icon:ne,delete_icon:oe,car_icon:ie,form_field:be,editable_map_location:ge,drivers_locations_map:xe,tooltip:pe},name:"Taxi trips",emits:["callback"],setup(a,{emit:w}){const _=o(!1),s=o(!1),T=o(!1);o(null);const l=o({}),b=o(a.usertype),S=o({}),C=o({});o([]),o(!0);const c=o(""),L=o(null),z=o(!1),B=o([a.usertype,"Pickup location","Destination","Driver","Time","Cost","Confirm"]),k=o([]),V=o(!1),P=o(""),D=o(""),U=o([{title:x("Scheduled"),status:"scheduled"},{title:x("Started"),status:"started"},{title:x("Completed"),status:"completed"},{title:x("Cancelled"),status:"cancelled"}]);console.log(a.item),a.item?(l.value=a.item,l.value.date=a.item.date??N()):l.value.date=N();const W=a.userslist?o(a.userslist):o([]),O=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{l.value.trip_id||(l.value.pickup_latitude=e.coords.latitude,l.value.pickup_longitude=e.coords.longitude,l.value.destination_latitude=e.coords.latitude,l.value.destination_longitude=e.coords.longitude)},e=>{l.value.trip_id||(l.value.pickup_latitude=l.value.pickup_latitude??30.06,l.value.pickup_longitude=l.value.pickup_longitude??31.21,l.value.destination_latitude=l.value.destination_latitude??30.06,l.value.destination_longitude=l.value.destination_longitude??31.21),j(e.message)}):(j("location error"),L.value="Geolocation is not supported by this browser.")};O();const q=async()=>{let e=P.value.length>3?await A(a.system_setting.google_map_api,P.value,a.business_setting.country):"";k.value=e.predictions},J=async()=>{let e=D.value.length>3?await A(a.system_setting.google_map_api,D.value,a.business_setting.country):"";k.value=e.predictions},R=()=>{_.value=!0;var e=new URLSearchParams;let i=JSON.parse(JSON.stringify(l.value)),v=Object.keys(i),d,f;for(let g=0;g<v.length;g++)d=v[g],f=typeof i[d]=="object"?JSON.stringify(i[d]):i[d],e.append("params["+d+"]",f);let y=i.trip_id>0?"update":"create";e.append("type","TaxiTrip."+y);const h=_e();h&&(h.root.data.loader=!0),ve(e,"/api/"+y).then(g=>{me(g),_.value=!1})},G=async e=>{l.value.pickup_latitude=e.lat(),l.value.pickup_longitude=e.lng(),l.value.pickup_address=await M(e.lat(),e.lng())},K=async e=>{l.value.destination_latitude=e.lat(),l.value.destination_longitude=e.lng(),l.value.destination_address=await M(e.lat(),e.lng())},F=async(e,i)=>{const v=new google.maps.places.PlacesService(document.createElement("div"));let d=e.place_id;v.getDetails({placeId:d},(f,y)=>{if(y===google.maps.places.PlacesServiceStatus.OK&&f){const h=f.geometry.location;i=="pickup"&&(l.value.pickup_address=e.description,l.value.pickup_latitude=h.lat(),l.value.pickup_longitude=h.lng()),i=="destination"&&(l.value.destination_address=e.description,l.value.destination_latitude=h.lat(),l.value.destination_longitude=h.lng()),k.value=[],V.value=!1}else console.error("Failed to fetch place details")})},H=()=>{w("callback")},Q=()=>he(["model_id","driver_id","pickup_address","destination_address","status"],l),X=e=>{l.value.model_id=a.usertype=="student"?e.student_id:e.customer_id,l.value.model=e,b.value="Pickup location",c.value=null},Y=e=>{l.value.driver_id=e.driver_id,l.value.driver=e,E(e.vehicle)},E=e=>{l.value.vehicle_id=e.vehicle_id,l.value.vehicle=e,c.value=null},Z=()=>{if(a.drivers)for(let e=0;e<a.drivers.length;e++)a.drivers[e].show=c.value.trim()?$(a.drivers[e]):1},$=e=>{let i=!!e.name.toLowerCase().includes(c.value.toLowerCase());return i||!!e.mobile.toLowerCase().includes(c.value.toLowerCase())},ee=()=>{if(a.vehicles)for(let e=0;e<a.vehicles.length;e++)a.vehicles[e].show=c.value.trim()?te(a.vehicles[e]):1},te=e=>{let i=!!e.vehicle_name.toLowerCase().includes(c.value.toLowerCase());return i||!!e.plate_number.toLowerCase().includes(c.value.toLowerCase())},se=()=>{if(a.userslist)for(let e=0;e<a.userslist.length;e++)a.userslist[e].show=c.value.trim()?le(a.userslist[e]):1},le=e=>{let i=!!e.name.toLowerCase().includes(c.value.toLowerCase()),v=i||!!e.email.toLowerCase().includes(c.value.toLowerCase());return v||!!e.mobile.toLowerCase().includes(c.value.toLowerCase())};return{loader:_,tripsStatusList:U,selectedObject:(e,i)=>{const v=l.value[i];for(let d=0;d<e.length;d++)if(e[d][i]==v)return e[d];return{}},findDriver:Z,setDriver:Y,findVehicle:ee,setVehicle:E,users:W,progressWidth:Q,setUser:X,findUser:se,setPlaceMarker:F,showPlaceSearch:V,pickupPlaceChanged:q,destinationPlaceChanged:J,pickup_placeSearch:P,destination_placeSearch:D,places:k,showAddSide:s,showEditSide:T,content:S,fillable:B,center:C,activeItem:l,activeTab:b,translate:x,updatePickupMarker:G,updateDestinationMarker:K,searchText:c,getUserLocation:O,collapsed:z,saveTrip:R,back:H}},props:["conf","path","system_setting","business_setting","setting","item","userslist","usertype","drivers","vehicles","currency"]},ke={class:"w-full"},ye=t("img",{class:"m-auto w-500px",src:"/uploads/loader.gif"},null,-1),Ie=[ye],Se={class:"w-full flex overflow-auto"},Le={class:"w-full relative"},Pe={class:"card w-full py-10"},De={class:"w-full stepper stepper-links"},Te={class:"w-full"},Ve={class:""},Oe={class:"card-body pt-0 mx-auto"},Ee={class:"w-full flex gap-10"},Ne={class:"w-full"},je={class:"w-full"},Ae=t("hr",{class:"block mt-6 my-2 opacity-10"},null,-1),Me={class:"bg-gray-200 shadow-md mb-10 rounded-xl"},ze={class:"card-header border-0 pt-9"},Be={key:0,class:"card-title m-0 flex gap-4"},Ue={class:"symbol symbol-50px w-50px bg-light"},We=["src"],qe={class:"w-full"},Je=["textContent"],Re=["textContent"],Ge={key:0,class:"card-body p-9"},Ke={class:"timeline timeline-border-dashed"},Fe={class:"timeline-item"},He=t("div",{class:"timeline-line"},null,-1),Qe={class:"timeline-icon me-4"},Xe={class:"timeline-content mb-10 mt-n2"},Ye={class:"overflow-auto pe-3"},Ze=["textContent"],$e={class:"d-flex align-items-center mt-1 fs-6"},et=["textContent"],tt={class:"timeline-item"},st=t("div",{class:"timeline-line"},null,-1),lt={class:"timeline-icon me-4"},at={class:"timeline-content mb-10 mt-n2"},nt={class:"overflow-auto pe-3"},ot=["textContent"],it={class:"d-flex align-items-center mt-1 fs-6"},ct=["textContent"],dt={class:"h-4px w-100 bg-light mb-5"},rt={key:0,class:"w-full flex gap-4"},ut={key:0,class:"flex gap-4 w-full"},_t=["src"],vt={class:"block gap-4 w-full"},mt=["textContent"],ht=["textContent"],ft={key:1,class:"w-full flex gap-4"},gt={class:"block gap-4"},xt=["textContent"],pt=["textContent"],wt={key:2,class:"w-full flex-end"},bt=["textContent"],Ct={class:"w-full flex gap-4"},kt=["textContent"],yt=["textContent"],It={class:"flex gap-6 pb-4 font-semibold text-lg"},St={class:"flex gap-6 w-full"},Lt=["textContent"],Pt=["textContent"],Dt={class:"flex gap-6 w-full"},Tt=["textContent"],Vt=["textContent"],Ot={class:"flex gap-6 w-full"},Et=["textContent"],Nt=["textContent"],jt={class:"notice d-flex bg-light-warning rounded border-warning border border-dashed mb-12 p-6 gap-4"},At=fe('<i class="vue-feather vue-feather--alert-octagon ki-duotone ki-information fs-2tx text-warning me-4" data-name="alert-octagon" data-tags="warning,alert,danger" data-type="alert-octagon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-octagon vue-feather__content"><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></i>',1),Mt={class:"d-flex flex-stack flex-grow-1"},zt={class:"fw-semibold"},Bt=["textContent"],Ut={class:"fs-6 text-gray-700"},Wt=["textContent"],qt={class:"text-center mt-10"},Jt=["textContent"];function Rt(a,w,_,s,T,l){const b=I("close_icon"),S=I("trip_map"),C=I("vue-feather"),c=I("car_icon");return r(),u("div",ke,[s.loader?(r(),u("div",{key:s.loader,class:"bg-white fixed w-full h-full top-0 left-0",style:{"z-index":"99999",opacity:".9"}},Ie)):m("",!0),t("div",Se,[t("div",Le,[p(b,{class:"absolute top-4 right-4 z-10 cursor-pointer",onClick:s.back},null,8,["onClick"]),t("div",Pe,[t("div",De,[t("div",Te,[t("div",Ve,[t("div",Oe,[t("div",Ee,[t("div",Ne,[p(S,{onMarkerclicked:a.markerClicked,class:"w-full rounded-xl shadow-md mx-4",system_setting:_.system_setting,conf:_.conf,trip:s.activeItem},null,8,["onMarkerclicked","system_setting","conf","trip"])]),t("div",je,[Ae,t("div",Me,[t("div",ze,[s.activeItem.model?(r(),u("div",Be,[t("div",Ue,[t("img",{src:s.activeItem.model.picture,alt:"image",class:"p-3"},null,8,We)]),t("div",qe,[t("div",{class:"font-semibold",textContent:n(s.activeItem.model.name)},null,8,Je),t("div",{class:"",textContent:n(s.activeItem.model.mobile)},null,8,Re)])])):m("",!0)]),s.activeItem?(r(),u("div",Ge,[t("div",Ke,[t("div",Fe,[He,t("div",Qe,[p(C,{type:"circle",class:"fs-2 text-success"})]),t("div",Xe,[t("div",Ye,[s.activeItem?(r(),u("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:n(s.activeItem.pickup_address)},null,8,Ze)):m("",!0),t("div",$e,[t("div",{class:"text-muted me-2 fs-7",textContent:n(s.translate("Pickup"))},null,8,et)])])])]),t("div",tt,[st,t("div",lt,[p(C,{type:"map-pin",class:"fs-2 text-danger"})]),t("div",at,[t("div",nt,[s.activeItem?(r(),u("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:n(s.activeItem.destination_address)},null,8,ot)):m("",!0),t("div",it,[t("div",{class:"text-muted me-2 fs-7",textContent:n(s.translate("Destination"))},null,8,ct)])])])])]),t("div",dt,[t("div",{class:ce(["rounded h-4px transition transition-all",s.progressWidth()<100?"bg-info":"bg-success"]),role:"progressbar",style:de({width:s.progressWidth()+"%"})},null,6)]),s.activeItem?(r(),u("div",rt,[s.activeItem.driver?(r(),u("div",ut,[t("img",{src:s.activeItem.driver.picture,class:"rounded-full bg-white border-1 border border-gray-600 p-1 w-12 h-12"},null,8,_t),t("div",vt,[t("span",{class:"w-full block font-semibold",textContent:n(s.translate("Driver"))},null,8,mt),t("span",{class:"w-full block",textContent:n(s.activeItem.driver.name)},null,8,ht)])])):m("",!0),s.activeItem.vehicle?(r(),u("div",ft,[p(c),t("div",gt,[t("span",{class:"w-full block font-semibold",textContent:n(s.translate("Vehicle"))},null,8,xt),t("span",{class:"w-full block",textContent:n(s.activeItem.vehicle.plate_number)},null,8,pt)])])):m("",!0),s.activeItem.date?(r(),u("div",wt,[t("span",{class:"w-full block font-semibold",textContent:n(s.translate("Trip date"))},null,8,bt),t("div",Ct,[t("span",{class:"",textContent:n(s.activeItem.date)},null,8,kt),t("span",{class:"",textContent:n(s.activeItem.start_time)},null,8,yt)])])):m("",!0)])):m("",!0)])):m("",!0)]),t("div",It,[t("div",St,[t("div",{textContent:n(s.translate("Subtotal"))},null,8,Lt),t("div",{textContent:n(_.currency.symbol+""+s.activeItem.subtotal)},null,8,Pt)]),t("div",Dt,[t("div",{textContent:n(s.translate("Discount"))},null,8,Tt),t("div",{textContent:n(_.currency.symbol+""+s.activeItem.discount_amount)},null,8,Vt)]),t("div",Ot,[t("div",{textContent:n(s.translate("Total cost"))},null,8,Et),t("div",{textContent:n(_.currency.symbol+""+s.activeItem.total_cost)},null,8,Nt)])]),t("div",jt,[At,t("div",Mt,[t("div",zt,[t("h4",{class:"text-gray-900 fw-bold",textContent:n(s.translate(s.activeItem.payment_status))},null,8,Bt),t("div",Ut,[t("div",{textContent:n(s.translate("Payment status"))},null,8,Wt)])])])])])]),t("p",qt,[t("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:w[0]||(w[0]=(...L)=>s.back&&s.back(...L)),textContent:n(s.translate("Back"))},null,8,Jt)])])])])])])])])])}const Zt=ae(Ce,[["render",Rt]]);export{Zt as default};
