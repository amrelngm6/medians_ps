const __vite__fileDeps=["side-form-create-DwwFhpNu.min.js","index.min.js","index.min.css","Field-DGSjrbSi.min.js","Field.min.css","side-form-update-1JDxVMwr.min.js","form_field-DSvRoxGR.min.js","editable_map_location-C3m7cXEh.min.js","index.es-BqyRJkQ3.min.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as ot,D as it,E as ct,x as dt,G as rt,r as o,t as p,al as M,a as b,o as r,c as _,b as m,d as e,g as f,e as n,n as _t,I as ut,q as V,u as E,s as U,J as z,a7 as vt,l as mt,K as ht,L as B,M as ft,p as gt}from"./index.min.js";import{e as xt}from"./editable_map_location-C3m7cXEh.min.js";import{d as pt}from"./drivers_locations_map-D2jb4AK9.min.js";import{t as bt}from"./tooltip-B6mCVe86.min.js";import{t as wt}from"./trip_map-FSnhAuFV.min.js";import"./index.es-BqyRJkQ3.min.js";const kt=V(()=>E(()=>import("./side-form-create-DwwFhpNu.min.js"),__vite__mapDeps([0,1,2,3,4]))),yt=V(()=>E(()=>import("./side-form-update-1JDxVMwr.min.js"),__vite__mapDeps([5,1,2,3,4,6,7,8]))),Ct=V(()=>E(()=>import("./form_field-DSvRoxGR.min.js"),__vite__mapDeps([6,1,2,3,4,7,8]))),It={components:{datatabble:it,SideFormCreate:kt,SideFormUpdate:yt,trip_map:wt,close_icon:ct,delete_icon:dt,car_icon:rt,form_field:Ct,editable_map_location:xt,drivers_locations_map:pt,tooltip:bt},name:"Taxi trips",emits:["callback"],setup(a,{emit:w}){const u=o(!1),s=o(!1),O=o(!1);o(null);const l=o({}),k=o(a.usertype),I=o({}),S=o({});o([]),o(!0);const c=o(""),L=o(null),P=o(!1),R=o([a.usertype,"Pickup location","Destination","Driver","Time","Cost","Confirm"]),y=o([]),A=o(!1),D=o(""),T=o(""),W=o([{title:p("Scheduled"),status:"scheduled"},{title:p("Started"),status:"started"},{title:p("Completed"),status:"completed"},{title:p("Cancelled"),status:"cancelled"}]);console.log(a.item),a.item?(l.value=a.item,l.value.date=a.item.date??M()):l.value.date=M();const q=a.userslist?o(a.userslist):o([]),N=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{l.value.trip_id||(l.value.pickup_latitude=t.coords.latitude,l.value.pickup_longitude=t.coords.longitude,l.value.destination_latitude=t.coords.latitude,l.value.destination_longitude=t.coords.longitude)},t=>{l.value.trip_id||(l.value.pickup_latitude=l.value.pickup_latitude??30.06,l.value.pickup_longitude=l.value.pickup_longitude??31.21,l.value.destination_latitude=l.value.destination_latitude??30.06,l.value.destination_longitude=l.value.destination_longitude??31.21),U(t.message)}):(U("location error"),L.value="Geolocation is not supported by this browser.")};N();const J=async()=>{let t=D.value.length>3?await z(a.system_setting.google_map_api,D.value,a.business_setting.country):"";y.value=t.predictions},F=async()=>{let t=T.value.length>3?await z(a.system_setting.google_map_api,T.value,a.business_setting.country):"";y.value=t.predictions},G=()=>{u.value=!0;var t=new URLSearchParams;let i=JSON.parse(JSON.stringify(l.value)),v=Object.keys(i),d,g;for(let x=0;x<v.length;x++)d=v[x],g=typeof i[d]=="object"?JSON.stringify(i[d]):i[d],t.append("params["+d+"]",g);let C=i.trip_id>0?"update":"create";t.append("type","TaxiTrip."+C);const h=vt();h&&(h.root.data.loader=!0),mt(t,"/api/"+C).then(x=>{ht(x),u.value=!1})},K=async t=>{l.value.pickup_latitude=t.lat(),l.value.pickup_longitude=t.lng(),l.value.pickup_address=await B(t.lat(),t.lng())},H=async t=>{l.value.destination_latitude=t.lat(),l.value.destination_longitude=t.lng(),l.value.destination_address=await B(t.lat(),t.lng())},Q=async(t,i)=>{const v=new google.maps.places.PlacesService(document.createElement("div"));let d=t.place_id;v.getDetails({placeId:d},(g,C)=>{if(C===google.maps.places.PlacesServiceStatus.OK&&g){const h=g.geometry.location;i=="pickup"&&(l.value.pickup_address=t.description,l.value.pickup_latitude=h.lat(),l.value.pickup_longitude=h.lng()),i=="destination"&&(l.value.destination_address=t.description,l.value.destination_latitude=h.lat(),l.value.destination_longitude=h.lng()),y.value=[],A.value=!1}else console.error("Failed to fetch place details")})},X=()=>{w("callback")},Y=()=>ft(["model_id","driver_id","pickup_address","destination_address","status"],l),Z=t=>{l.value.model_id=a.usertype=="student"?t.student_id:t.customer_id,l.value.model=t,k.value="Pickup location",c.value=null},$=t=>{l.value.driver_id=t.driver_id,l.value.driver=t,j(t.vehicle)},j=t=>{l.value.vehicle_id=t.vehicle_id,l.value.vehicle=t,c.value=null},tt=()=>{if(a.drivers)for(let t=0;t<a.drivers.length;t++)a.drivers[t].show=c.value.trim()?et(a.drivers[t]):1},et=t=>{let i=!!t.name.toLowerCase().includes(c.value.toLowerCase());return i||!!t.mobile.toLowerCase().includes(c.value.toLowerCase())},st=()=>{if(a.vehicles)for(let t=0;t<a.vehicles.length;t++)a.vehicles[t].show=c.value.trim()?lt(a.vehicles[t]):1},lt=t=>{let i=!!t.vehicle_name.toLowerCase().includes(c.value.toLowerCase());return i||!!t.plate_number.toLowerCase().includes(c.value.toLowerCase())},at=()=>{if(a.userslist)for(let t=0;t<a.userslist.length;t++)a.userslist[t].show=c.value.trim()?nt(a.userslist[t]):1},nt=t=>{let i=!!t.name.toLowerCase().includes(c.value.toLowerCase()),v=i||!!t.email.toLowerCase().includes(c.value.toLowerCase());return v||!!t.mobile.toLowerCase().includes(c.value.toLowerCase())};return{loader:u,tripsStatusList:W,selectedObject:(t,i)=>{const v=l.value[i];for(let d=0;d<t.length;d++)if(t[d][i]==v)return t[d];return{}},findDriver:tt,setDriver:$,findVehicle:st,setVehicle:j,users:q,progressWidth:Y,setUser:Z,findUser:at,setPlaceMarker:Q,showPlaceSearch:A,pickupPlaceChanged:J,destinationPlaceChanged:F,pickup_placeSearch:D,destination_placeSearch:T,places:y,showAddSide:s,showEditSide:O,content:I,fillable:R,center:S,activeItem:l,activeTab:k,translate:p,updatePickupMarker:K,updateDestinationMarker:H,searchText:c,getUserLocation:N,collapsed:P,saveTrip:G,back:X}},props:["conf","path","system_setting","business_setting","setting","item","userslist","usertype","drivers","vehicles","currency"]},St={class:"w-full"},Lt=e("img",{class:"m-auto w-500px",src:"/uploads/loader.gif"},null,-1),Pt=[Lt],Dt={class:"w-full flex overflow-auto"},Tt={class:"w-full relative"},Vt={class:"card w-full py-10"},Et={class:"w-full stepper stepper-links"},Ot={class:"w-full"},At={class:""},Nt={class:"card-body pt-0 mx-auto max-w-xl"},jt={class:"w-full flex gap-10"},Mt={class:"w-full"},Ut={class:"w-full"},zt=e("hr",{class:"block mt-6 my-2 opacity-10"},null,-1),Bt={class:"bg-gray-200 shadow-md mb-10 rounded-xl"},Rt={class:"card-header border-0 pt-9"},Wt={key:0,class:"card-title m-0 flex gap-4"},qt={class:"symbol symbol-50px w-50px bg-light"},Jt=["src"],Ft={class:"w-full"},Gt=["textContent"],Kt=["textContent"],Ht={class:"flex gap-2 cursor-pointer"},Qt={class:"pt-3"},Xt={class:"relative badge badge-light fw-bold me-auto px-4 py-3"},Yt={key:0,class:"card-body p-9"},Zt={class:"timeline timeline-border-dashed"},$t={class:"timeline-item"},te=e("div",{class:"timeline-line"},null,-1),ee={class:"timeline-icon me-4"},se={class:"timeline-content mb-10 mt-n2"},le={class:"overflow-auto pe-3"},ae=["textContent"],ne={class:"d-flex align-items-center mt-1 fs-6"},oe=["textContent"],ie={class:"timeline-item"},ce=e("div",{class:"timeline-line"},null,-1),de={class:"timeline-icon me-4"},re={class:"timeline-content mb-10 mt-n2"},_e={class:"overflow-auto pe-3"},ue=["textContent"],ve={class:"d-flex align-items-center mt-1 fs-6"},me=["textContent"],he={class:"h-4px w-100 bg-light mb-5"},fe={key:0,class:"w-full flex gap-4"},ge={key:0,class:"flex gap-4 min-w-250px"},xe=["src"],pe={class:"block gap-4 w-full"},be=["textContent"],we=["textContent"],ke={key:1,class:"w-150px flex gap-4"},ye={class:"block gap-4"},Ce=["textContent"],Ie=["textContent"],Se={key:2,class:"w-125px flex-end"},Le=["textContent"],Pe={class:"w-full flex gap-4"},De=["textContent"],Te=["textContent"],Ve={class:"flex gap-6 pb-4 font-semibold text-lg"},Ee={class:"flex gap-6 w-full"},Oe=["textContent"],Ae=["textContent"],Ne={class:"flex gap-6 w-full"},je=["textContent"],Me=["textContent"],Ue={class:"flex gap-6 w-full"},ze=["textContent"],Be=["textContent"],Re={class:"notice d-flex bg-light-warning rounded border-warning border border-dashed mb-12 p-6 gap-4"},We=gt('<i class="vue-feather vue-feather--alert-octagon ki-duotone ki-information fs-2tx text-warning me-4" data-name="alert-octagon" data-tags="warning,alert,danger" data-type="alert-octagon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-octagon vue-feather__content"><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></i>',1),qe={class:"d-flex flex-stack flex-grow-1"},Je={class:"fw-semibold"},Fe=["textContent"],Ge={class:"fs-6 text-gray-700"},Ke=["textContent"],He={class:"text-center mt-10"},Qe=["textContent"];function Xe(a,w,u,s,O,l){const k=b("close_icon"),I=b("trip_map"),S=b("form_field"),c=b("vue-feather"),L=b("car_icon");return r(),_("div",St,[s.loader?(r(),_("div",{key:s.loader,class:"bg-white fixed w-full h-full top-0 left-0",style:{"z-index":"99999",opacity:".9"}},Pt)):m("",!0),e("div",Dt,[e("div",Tt,[f(k,{class:"absolute top-4 right-4 z-10 cursor-pointer",onClick:s.back},null,8,["onClick"]),e("div",Vt,[e("div",Et,[e("div",Ot,[e("div",At,[e("div",Nt,[e("div",jt,[e("div",Mt,[f(I,{onMarkerclicked:a.markerClicked,class:"rounded-xl shadow-md mx-4",system_setting:u.system_setting,conf:u.conf,trip:s.activeItem},null,8,["onMarkerclicked","system_setting","conf","trip"])]),e("div",Ut,[zt,e("div",Bt,[e("div",Rt,[s.activeItem.model?(r(),_("div",Wt,[e("div",qt,[e("img",{src:s.activeItem.model.picture,alt:"image",class:"p-3"},null,8,Jt)]),e("div",Ft,[e("div",{class:"font-semibold",textContent:n(s.activeItem.model.name)},null,8,Gt),e("div",{class:"",textContent:n(s.activeItem.model.mobile)},null,8,Kt)])])):m("",!0),e("label",Ht,[e("div",Qt,[e("span",Xt,[f(S,{class:"flex-end",item:s.activeItem,column:{key:"status",title:s.translate("Status"),column_type:"select",text_key:"title",data:s.tripsStatusList,hide_text:!0}},null,8,["item","column"]),f(c,{class:"absolute right-4",type:"chevron-down"})])])])]),s.activeItem?(r(),_("div",Yt,[e("div",Zt,[e("div",$t,[te,e("div",ee,[f(c,{type:"circle",class:"fs-2 text-success"})]),e("div",se,[e("div",le,[s.activeItem?(r(),_("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:n(s.activeItem.pickup_address)},null,8,ae)):m("",!0),e("div",ne,[e("div",{class:"text-muted me-2 fs-7",textContent:n(s.translate("Pickup"))},null,8,oe)])])])]),e("div",ie,[ce,e("div",de,[f(c,{type:"map-pin",class:"fs-2 text-danger"})]),e("div",re,[e("div",_e,[s.activeItem?(r(),_("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:n(s.activeItem.destination_address)},null,8,ue)):m("",!0),e("div",ve,[e("div",{class:"text-muted me-2 fs-7",textContent:n(s.translate("Destination"))},null,8,me)])])])])]),e("div",he,[e("div",{class:_t(["rounded h-4px transition transition-all",s.progressWidth()<100?"bg-info":"bg-success"]),role:"progressbar",style:ut({width:s.progressWidth()+"%"})},null,6)]),s.activeItem?(r(),_("div",fe,[s.activeItem.driver?(r(),_("div",ge,[e("img",{src:s.activeItem.driver.picture,class:"rounded-full bg-white border-1 border border-gray-600 p-1 w-12 h-12"},null,8,xe),e("div",pe,[e("span",{class:"w-full block font-semibold",textContent:n(s.translate("Driver"))},null,8,be),e("span",{class:"w-full block",textContent:n(s.activeItem.driver.name)},null,8,we)])])):m("",!0),s.activeItem.vehicle?(r(),_("div",ke,[f(L),e("div",ye,[e("span",{class:"w-full block font-semibold",textContent:n(s.translate("Vehicle"))},null,8,Ce),e("span",{class:"w-full block",textContent:n(s.activeItem.vehicle.plate_number)},null,8,Ie)])])):m("",!0),s.activeItem.date?(r(),_("div",Se,[e("span",{class:"w-full block font-semibold",textContent:n(s.translate("Trip date"))},null,8,Le),e("div",Pe,[e("span",{class:"",textContent:n(s.activeItem.date)},null,8,De),e("span",{class:"",textContent:n(s.activeItem.start_time)},null,8,Te)])])):m("",!0)])):m("",!0)])):m("",!0)]),e("div",Ve,[e("div",Ee,[e("div",{textContent:n(s.translate("Subtotal"))},null,8,Oe),e("div",{textContent:n(u.currency.symbol+""+s.activeItem.subtotal)},null,8,Ae)]),e("div",Ne,[e("div",{textContent:n(s.translate("Discount"))},null,8,je),e("div",{textContent:n(u.currency.symbol+""+s.activeItem.discount_amount)},null,8,Me)]),e("div",Ue,[e("div",{textContent:n(s.translate("Total cost"))},null,8,ze),e("div",{textContent:n(u.currency.symbol+""+s.activeItem.total_cost)},null,8,Be)])]),e("div",Re,[We,e("div",qe,[e("div",Je,[e("h4",{class:"text-gray-900 fw-bold",textContent:n(s.translate(s.activeItem.payment_status))},null,8,Fe),e("div",Ge,[e("div",{textContent:n(s.translate("Payment status"))},null,8,Ke)])])])])])]),e("p",He,[e("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:w[0]||(w[0]=(...P)=>s.back&&s.back(...P)),textContent:n(s.translate("Back"))},null,8,Qe)])])])])])])])])])}const as=ot(It,[["render",Xe]]);export{as as default};
