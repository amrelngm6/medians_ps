import{_ as Y,D as Z,e as $,y as ee,z as te,f,t as se,r as v,o,c as i,g as w,h as a,i as n,j as g,H as ne,I as le,F as S,k as V,x as B,a as T,B as z,l as P,A as E,d as U,b as R,m as oe,s as ae,p as ie}from"./index.min.js";const ce=U(()=>R(()=>import("./map-OGlwx9xa.min.js"),__vite__mapDeps([0,1,2,3]))),re=U(()=>R(()=>import("./trip_page-o4OZqEmS.min.js"),__vite__mapDeps([4,2,3,5,1]))),de={components:{datatabble:Z,maps:ce,delete_icon:$,car_icon:ee,route_icon:te,trip_page:re},name:"Destinations",setup(l){const c=l.conf.url+l.path+"?load=json",_=f(null),e=f({}),h=f({}),j=f({}),k=f([]),p=f(""),F=f(!1),C=f(!1),L=()=>{};(()=>{oe(c).then(s=>{h.value=JSON.parse(JSON.stringify(s)),M(h.value.items),b()})})();const M=s=>{for(let r=0;r<s.length;r++)K(s[r])},W=(s,r)=>{e.value=s;for(let m=0;m<h.value.items.length;m++)h.value.items[m].selected=!1;h.value.items[r].selected=!0;let u,y,G=l.conf.url+"uploads/images/yellow_pin.gif",H=l.conf.url+"uploads/images/blue_pin.gif",Q=l.conf.url+"uploads/images/car.svg",X=l.conf.url+"uploads/images/destination.svg",x=[],N={lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)};x[0]={drag:!0,status:"waiting",icon:Q,origin:N,destination:N};for(let m=0;m<s.pickup_locations.length;m++)u=s.pickup_locations[m],y=m?s.pickup_locations[m-1].location:u.location,x[m+1]={status:u.status,icon:u.status=="waiting"?H:G,origin:{lat:parseFloat(y.latitude),lng:parseFloat(y.longitude)},destination:{lat:parseFloat(u.location.latitude),lng:parseFloat(u.location.longitude)}};return x[x.length]={drag:!0,icon:X,origin:{lat:0,lng:0},destination:{lat:parseFloat(s.route.latitude),lng:parseFloat(s.route.longitude)}},j.value=x[0].destination,k.value=x,x},t=async()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>{j.value={lat:s.coords.latitude,lng:s.coords.longitude}},s=>{ae(s.message,5e3)})};t();const b=()=>{for(let s=0;s<h.value.items.length;s++)h.value.items[s].active=p.value.trim()?d(h.value.items[s]):1},d=s=>{let r=!!s.student_name.toLowerCase().includes(p.value.toLowerCase());return r||!!s.location_name.toLowerCase().includes(p.toLowerCase())},I=s=>{e.value=s,D("edit",s)},J=(s,r,u)=>{e.value=u,e.value.latitude=u.destination.lat,e.value.longitude=u.destination.lng,D("edit",e.value)},K=s=>(s.icon=l.conf.url+"uploads/images/blue_pin.gif",s.origin=s.destination={lat:parseFloat(s.latitude),lng:parseFloat(s.longitude)},s.drag=!0,s),D=(s,r)=>{switch(s){case"view":break;case"edit":O(r,!0);break;case"delete":ie("destination_id",r,"Destination.delete");break}},q=(s,r)=>{let u=[];for(let y=0;y<s.length;y++)s[y].status==r;return u},O=(s,r=!0)=>{C.value=r,e.value=s};return{editFields:O,showTrip:C,activeTrip:_,locations:k,url:c,content:h,center:j,activeItem:e,callback:()=>{O(null,!1),C.value=!1},filterLocations:q,translate:se,clickMarker:J,updateMarker:I,setLocationsMarkers:W,checkSimilar:d,searchTextChanged:b,searchText:p,getUserLocation:t,collapsed:F,closeSide:L,handleAction:D}},props:["path","lang","setting","conf","auth"]},ue={class:"w-full flex overflow-auto"},ge={key:4,class:"w-full relative"},he={class:"self-stretch py-4 flex-col justify-center items-start flex"},me=["textContent"],_e=["textContent"],fe={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},ve=["placeholder"],ye={key:0,class:"w-full grow shrink basis-0 px-6 py-4 flex-col justify-center items-start gap-4 inline-flex"},xe={class:"w-full self-stretch justify-start items-start inline-flex cursor-pointer"},ke=["onClick"],pe=["src"],be=["textContent"],we={class:"self-stretch text-slate-500 text-base font-normal flex"},Ce=["textContent"],Ie={class:"self-stretch text-slate-500 text-sm text-muted flex"},Te=["textContent"],ze={class:"gap-2 py-2 justify-start items-start gap-2.5 inline-flex"},je=["onClick"],Fe={class:"text-center text-xs text-white uppercase tracking-tight"},Le=n("hr",{class:"w-full"},null,-1),Ae={class:"w-full relative flex"},Me={class:"w-full relative"},We=["textContent"],De=["src"],Oe=n("i",{class:"fa fa-location-dot text-sm"},null,-1),Se=["textContent"],Ve={class:"w-full relative"},Be=["textContent"],Ee=["src"],Ne=n("i",{class:"fa fa-location-dot text-sm"},null,-1),Pe=["textContent"],Ue={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},Re=["textContent"],Je=n("hr",{class:"mt-2"},null,-1),Ke={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},qe=["textContent"],Ge=n("hr",{class:"mt-2"},null,-1),He={class:"w-full bg-white"},Qe=["src"],Xe=["onClick"],Ye=["onClick"];function Ze(l,c,_,e,h,j){const k=v("subscription_wizard"),p=v("usertype_picker"),F=v("maps"),C=v("car_icon"),L=v("route_icon"),A=v("vue-feather"),M=v("delete_icon"),W=v("datatabble");return o(),i("div",ue,[l.showWizard&&e.activeItem.usertype=="employee"?(o(),w(k,{onCallback:c[0]||(c[0]=t=>l.showWizard=!1),usertype:e.activeItem.usertype,userslist:e.content.employees,key:l.showWizard,packages:e.content.packages,system_setting:l.system_setting,item:e.activeItem,business_setting:l.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):a("",!0),l.showWizard&&e.activeItem.usertype=="supervisor"?(o(),w(k,{onCallback:c[1]||(c[1]=t=>l.showWizard=!1),usertype:e.activeItem.usertype,userslist:e.content.supervisors,key:l.showWizard,packages:e.content.packages,system_setting:l.system_setting,item:e.activeItem,business_setting:l.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):a("",!0),l.showWizard&&e.activeItem.usertype=="student"?(o(),w(k,{onCallback:c[2]||(c[2]=t=>l.showWizard=!1),usertype:e.activeItem.usertype,userslist:e.content.students,key:l.showWizard,packages:e.content.packages,system_setting:l.system_setting,item:e.activeItem,business_setting:l.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):a("",!0),!l.showWizard&&l.showOptions?(o(),w(p,{key:l.showOptions,auth:_.auth,item:e.activeItem},null,8,["auth","item"])):a("",!0),e.content&&!e.showTrip?(o(),i("div",ge,[e.center?(o(),w(F,{conf:_.conf,key:e.center,setting:_.setting,center:e.center,onClickMarker:e.clickMarker,onUpdateMarker:e.updateMarker,showroute:!1,waypoints:e.locations,onIntervalCallback:e.callback},null,8,["conf","setting","center","onClickMarker","onUpdateMarker","waypoints","onIntervalCallback"])):a("",!0),n("div",{style:z(e.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-14 h-full absolute top-4 rounded-lg p-4 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[n("div",he,[n("div",{class:"text-black text-lg font-semibold",textContent:g(e.content.title)},null,8,me),n("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:g(e.translate("Private Trips description"))},null,8,_e)]),e.collapsed?a("",!0):(o(),i("div",fe,[ne(n("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:e.translate("find by name and address"),"onUpdate:modelValue":c[3]||(c[3]=t=>e.searchText=t),onChange:c[4]||(c[4]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t)),onInput:c[5]||(c[5]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t)),onKeydown:c[6]||(c[6]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t))},null,40,ve),[[le,e.searchText]])])),e.content.items?(o(),i("div",{key:e.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[e.collapsed?a("",!0):(o(!0),i(S,{key:0},V(e.content.items,(t,b)=>(o(),i("div",{key:t.active,class:"w-full"},[t.active&&t.trip_status=="Scheduled"?(o(),i("div",{key:0,class:B([t.selected?"text-gray-600":"bg-gray-50","mb-4 w-full rounded-lg justify-start items-center inline-flex"])},[t.vehicle?(o(),i("div",ye,[n("div",xe,[n("div",{onClick:d=>e.setLocationsMarkers(t,b),class:"w-full grow shrink basis-0 justify-start items-start flex gap-4"},[n("img",{src:t.driver.picture,class:"w-10 h-10"},null,8,pe),t.driver.name?(o(),i("div",{key:0,class:B([t.selected?"text-purple-600":"text-gray-800","self-stretch text-base font-semibold tracking-tight"])},[n("span",{textContent:g(t.driver.name)},null,8,be),n("div",we,[T(C,{class:"w-8"}),t.vehicle?(o(),i("span",{key:0,class:"font-semibold text-sm p-2",textContent:g(t.vehicle.plate_number)},null,8,Ce)):a("",!0)]),n("div",Ie,[T(L,{class:"w-8"}),t.route?(o(),i("span",{key:0,class:"font-semibold text-sm p-2",textContent:g(t.route.route_name)},null,8,Te)):a("",!0)])],2)):a("",!0)],8,ke),n("div",ze,[n("div",{class:"mb-2 w-10 h-10 p-2 bg-primary rounded-full justify-center items-center flex cursor-pointer",onClick:d=>e.handleAction("edit",t)},[n("div",Fe,[T(A,{class:"w-5",type:"edit"})])],8,je)])]),Le,n("div",Ae,[n("div",Me,[n("h3",{class:"py-2 text-sm mb-10",textContent:g(e.translate("Waiting pickups"))},null,8,We),l.tripLocation&&l.tripLocation.status=="waiting"?(o(!0),i(S,{key:0},V(e.filterLocations(t.pickup_locations,"waiting"),(d,I)=>(o(),i("img",{style:z((_.lang.lang=="en"?"left: ":"right: ")+20*I+"px"),class:"rounded-full w-8 h-8 left-0 bottom-1 absolute rounded-[50px] border-2 border-purple-800",src:d&&d.location&&d.location.picture?d.location.picture:"https://via.placeholder.com/37x37"},null,12,De))),256)):a("",!0),n("span",{class:"bottom-2 absolute pt-2",style:z((_.lang.lang=="en"?"left: ":"right: ")+(20*t.waiting_locations.length+20)+"px")},[Oe,P(),t.pickup_locations?(o(),i("span",{key:0,class:"font-semibold px-1",textContent:g(t.waiting_locations.length)},null,8,Se)):a("",!0)],4)]),n("div",Ve,[n("h3",{class:"py-2 text-sm mb-10",textContent:g(e.translate("Active pickups"))},null,8,Be),l.tripLocation&&l.tripLocation.status=="moving"?(o(!0),i(S,{key:0},V(e.filterLocations(t.pickup_locations,"moving"),(d,I)=>(o(),i("img",{style:z((_.lang.lang=="en"?"left: ":"right: ")+20*I+"px"),class:"rounded-full w-8 h-8 left-0 bottom-1 absolute rounded-[50px] border-2 border-purple-800",src:d&&d.location&&d.location.picture?d.location.picture:"https://via.placeholder.com/37x37"},null,12,Ee))),256)):a("",!0),n("span",{class:"bottom-2 absolute pt-2",style:z((_.lang.lang=="en"?"left: ":"right: ")+(20*t.moving_locations_count+20)+"px")},[Ne,P(),t.pickup_locations?(o(),i("span",{key:0,class:"font-semibold px-1",textContent:g(t.moving_locations_count)},null,8,Pe)):a("",!0)],4)])])])):a("",!0)],2)):a("",!0)]))),128))])):a("",!0),n("div",Ue,[n("div",{onClick:c[7]||(c[7]=t=>e.collapsed=!e.collapsed),class:"cursor-pointer p-2 block text-center"},[n("i",{class:B(["fa",e.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),n("p",{class:"font-semibold",textContent:g(e.collapsed?e.translate("Expand"):e.translate("Collapse"))},null,8,Re)])])],4),Je,e.content?(o(),i("main",{key:e.content.items,class:"flex-1 overflow-x-hidden overflow-y-auto w-full"},[n("div",Ke,[n("h1",{class:"font-bold text-lg w-full",textContent:g(e.content.title)},null,8,qe)]),Ge,n("div",He,[e.content.columns?(o(),w(W,{key:0,class:"align-middle fs-6 gy-5 table table-row-dashed px-6","body-text-direction":e.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:e.content.columns,items:e.content.items},{"item-picture":E(t=>[n("img",{src:t.picture,class:"w-8 h-8 rounded-full"},null,8,Qe)]),"item-details":E(t=>[t.not_editable?a("",!0):(o(),i("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:b=>e.handleAction("edit",t)},[T(A,{class:"w-5",type:"edit"})],8,Xe))]),"item-delete":E(t=>[t.not_removeable?a("",!0):(o(),i("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:b=>e.handleAction("delete",t)},[T(M,{class:"w-5"})],8,Ye))]),_:1},8,["body-text-direction","headers","items"])):a("",!0)])])):a("",!0)])):a("",!0)])}const tt=Y(de,[["render",Ze]]);export{tt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-OGlwx9xa.min.js","index.es-4z_hVD90.min.js","index.min.js","index.min.css","trip_page-o4OZqEmS.min.js","help-QMf3rqBc.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
