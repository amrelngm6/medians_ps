import{_ as K,D as q,e as H,y as Q,z as X,f as r,t as Y,r as g,o,c as n,g as P,h as i,i as a,j as _,A,B as Z,C as $,F as E,k as V,E as w,G as D,a as k,d as B,b as I,m as ee,s as T,H as te,I as se,p as ae}from"./index.min.js";import{e as oe}from"./editable_map_location-h8_ViIKg.min.js";import le from"./routeWizard-tuRadD8S.min.js";import{t as ne}from"./tooltip-s9Xa9pgY.min.js";import"./index.es-9divdo6P.min.js";import"./route_map-qv63lEG1.min.js";const re=B(()=>I(()=>import("./map-b2mjEKBi.min.js"),__vite__mapDeps([0,1,2,3]))),ie=B(()=>I(()=>import("./form_field-1fpjNFy2.min.js"),__vite__mapDeps([4,2,3,5,6,7,1]))),ce={components:{datatabble:q,maps:re,delete_icon:H,car_icon:Q,route_icon:X,form_field:ie,editable_map_location:oe,route_wizard:le,tooltip:ne},name:"Routes",setup(c){const l=c.conf.url+c.path+"?load=json",d=r(!1),e=r({}),b=r({}),C=r({}),h=r(!1),y=r(["Info","Time","Start location","End location","Driver"]),v=r([]),p=r(!1),m=r(""),t=r(""),u=()=>{d.value=!1};(()=>{ee(l).then(s=>{b.value=JSON.parse(JSON.stringify(s))})})();const z=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{e.value.start_latitude=s.coords.latitude,e.value.start_longitude=s.coords.longitude,e.value.end_latitude=s.coords.latitude,e.value.end_longitude=s.coords.longitude},s=>{e.value.start_latitude=30.06,e.value.start_longitude=31.21,e.value.end_latitude=30.06,e.value.end_longitude=31.21,T(s.message)}):T("location error")},M=()=>{e.value={},h.value=!0,z()},j=async()=>{let s=m.value.length>3?await te(c.system_setting.google_map_api,m.value,c.business_setting.country):"";v.value=s.predictions},F=async s=>{e.value.start_latitude=s.lat(),e.value.start_longitude=s.lng(),e.value.start_address=await se(s.lat(),s.lng())},N=s=>{e.value.end_latitude=s.lat(),e.value.end_longitude=s.lng()},O=(s,f,S)=>{},L=(s,f)=>{switch(s){case"view":break;case"edit":e.value=f,h.value=!0;break;case"delete":ae("route_id",f,"Route.delete");break;case"close":d.value=!1,e.value={};break}},U=r([]),G=async s=>{e.value.start_address=s.description;const f=new google.maps.places.PlacesService(document.createElement("div"));let S=s.place_id;f.getDetails({placeId:S},(R,J)=>{if(J===google.maps.places.PlacesServiceStatus.OK&&R){const W=R.geometry.location;e.value.start_longitude=W.lng(),e.value.start_latitude=W.lat(),v.value=[],p.value=!1}else console.error("Failed to fetch place details")})};return{showTip:r({}),setPlaceMarker:G,showPlaceSearch:p,startPlaceChanged:j,start_placeSearch:m,places:v,waypoints:U,showEditSide:d,url:l,content:b,fillable:y,center:C,activeItem:e,searchValue:t,translate:Y,clickMarker:O,updateStartMarker:F,updateEndMarker:N,getUserLocation:z,showWizard:h,closeSide:u,addRouteWizard:M,handleAction:L}},props:["path","lang","system_setting","business_setting","setting","conf","auth"]},de={class:"w-full flex overflow-auto"},ue={key:0,class:"w-full relative"},_e={key:1,class:""},he={class:"card"},ve={class:"card-body"},me={class:"card-px text-center pt-15 pb-15"},fe=["textContent"],ge=["textContent"],pe=["textContent"],xe={class:"text-center pb-15 px-5"},we=["src"],be={key:2,class:"flex-1 overflow-x-hidden overflow-y-auto w-full relative"},ye={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},ke=["textContent"],Ce=a("hr",{class:"mt-2"},null,-1),ze={class:"w-full bg-white"},Se={class:"card-header align-items-center py-5 gap-2 gap-md-5 w-full flex"},Re={class:"card-title"},We={class:"d-flex align-items-center position-relative my-1"},Pe={class:"card-toolbar flex-row-fluid justify-content-end gap-5"},Ae={class:"w-150px"},Ee=["textContent","value"],Ve=["textContent"],De=["src"],Te={class:"w-full h-8 relative flex"},Be=["src"],Ie=["textContent"],Me=["onClick"],je=["onClick"];function Fe(c,l,d,e,b,C){const h=g("route_wizard"),y=g("route_icon"),v=g("vue-feather"),p=g("delete_icon"),m=g("datatabble");return o(),n("div",de,[e.content?(o(),n("div",ue,[e.showWizard?(o(),P(h,{onCallback:l[0]||(l[0]=t=>e.showWizard=!1),key:e.showWizard,drivers:e.content.drivers,supervisors:e.content.supervisors,vehicles:e.content.vehicles,system_setting:d.system_setting,item:e.activeItem,business_setting:d.business_setting,conf:d.conf},null,8,["drivers","supervisors","vehicles","system_setting","item","business_setting","conf"])):i("",!0),!e.showWizard&&e.content.items&&!e.content.items.length?(o(),n("div",_e,[a("div",he,[a("div",ve,[a("div",me,[a("h2",{class:"fs-2x fw-bold mb-0",textContent:_(e.content.title)},null,8,fe),a("p",{class:"text-gray-400 fs-4 font-semibold py-7",textContent:_(e.translate("Add your first route using this below wizard"))},null,8,ge),a("a",{textContent:_(e.translate("add_new")),onClick:l[1]||(l[1]=(...t)=>e.addRouteWizard&&e.addRouteWizard(...t)),href:"javascript:;",class:"text-white btn btn-primary er fs-6 px-8 py-4"},null,8,pe)]),a("div",xe,[a("img",{src:"/src/asset/img/1.png",alt:"",class:"mx-auto mw-100 h-200px h-sm-325px"},null,8,we)])])])])):i("",!0),e.content.items&&!e.showWizard?(o(),n("main",be,[a("div",ye,[a("h1",{class:"font-bold text-lg w-full",textContent:_(e.content.title)},null,8,ke)]),Ce,a("div",ze,[a("div",Se,[a("div",Re,[a("div",We,[A(a("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=t=>e.searchValue=t),"data-kt-ecommerce-order-filter":"search",class:"form-control form-control-solid w-250px ps-12",placeholder:"Search Report"},null,512),[[Z,e.searchValue]])])]),a("div",Pe,[a("div",Ae,[A(a("select",{"onUpdate:modelValue":l[3]||(l[3]=t=>c.searchField=t),class:"form-select form-select-solid select2-hidden-accessible","data-control":"select2","data-hide-search":"true","data-placeholder":"Rating","data-kt-ecommerce-order-filter":"rating","data-select2-id":"select2-data-9-zple",tabindex:"-1","aria-hidden":"true","data-kt-initialized":"1"},[(o(!0),n(E,null,V(e.content.columns,t=>(o(),n("option",{textContent:_(t.text),value:t.value},null,8,Ee))),256))],512),[[$,c.searchField]])])]),e.showWizard?i("",!0):(o(),n("a",{key:0,href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg bg-danger",onClick:l[4]||(l[4]=(...t)=>e.addRouteWizard&&e.addRouteWizard(...t)),textContent:_(e.translate("add_new"))},null,8,Ve))]),e.content.columns?(o(),P(m,{key:0,class:"align-middle fs-6 gy-5 table table-row-dashed px-6","body-text-direction":e.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:e.content.columns,items:e.content.items},{"item-picture":w(t=>[a("img",{src:t.picture,class:"w-8 h-8 rounded-full"},null,8,De)]),"item-route_locations":w(t=>[a("div",Te,[(o(!0),n(E,null,V(t.route_locations,(u,x)=>(o(),n("div",{style:D("left: "+20*x+"px"),class:"rounded-full w-8 h-8 left-0 top-0 absolute"},[x<3?(o(),n("img",{key:x,class:"rounded-full w-8 h-8 rounded-[50px] border-2 border-purple-800",src:u.student&&u.student.picture?u.student.picture:"https://via.placeholder.com/37x37"},null,8,Be)):i("",!0)],4))),256)),a("span",{class:"flex absolute pt-2",style:D("left: "+(20*(t.route_locations.length<3?t.route_locations.length:3)+20)+"px")},[k(y),t.route_locations?(o(),n("span",{key:0,class:"font-semibold px-1",textContent:_(t.route_locations.length)},null,8,Ie)):i("",!0)],4)])]),"item-edit":w(t=>[t.not_editable?i("",!0):(o(),n("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:u=>e.handleAction("edit",t)},[k(v,{class:"w-5",type:"edit"})],8,Me))]),"item-delete":w(t=>[t.not_removeable?i("",!0):(o(),n("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:u=>e.handleAction("delete",t)},[k(p,{class:"w-5"})],8,je))]),_:1},8,["body-text-direction","headers","items"])):i("",!0)])])):i("",!0)])):i("",!0)])}const qe=K(ce,[["render",Fe]]);export{qe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-b2mjEKBi.min.js","index.es-9divdo6P.min.js","index.min.js","index.min.css","form_field-1fpjNFy2.min.js","Field-vHFTeJAC.min.js","Field.min.css","editable_map_location-h8_ViIKg.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
