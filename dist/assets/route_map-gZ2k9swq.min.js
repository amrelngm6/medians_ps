import{_ as D,r as t,U as F,a as k,o as g,c as P,y as x,O as M,g as G,F as L,f as S,d as O,b as T}from"./index.min.js";import{O as z,L as I,j as E}from"./index.es-BqyRJkQ3.min.js";const J={components:{GoogleMap:z,Polyline:I,CustomMarker:E},emits:["markerclicked"],setup(m,{emit:h}){const i=t(null),o=t(12),r=t([]),_=t([]),u=t([]),v=t({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),l=t(m.route),s=(e,n="lat",p="lng",c)=>{let a=JSON.parse(JSON.stringify(e));return a.icon=m.conf.url+"uploads/images/"+c,a.marker_position={lat:parseFloat(e[n]),lng:parseFloat(e[p])},a.drag=!1,a};(()=>{r.value=[s(l.value.position,"start_latitude","start_longitude","car.svg")];let e=l.value.route_locations;if(e&&e.length)for(let n=0;n<e.length;n++)r.value[n+1]=s(e[n],"start_latitude","start_longitude","yellow_pin.gif");r.value[r.value.length]=s(l.value.position,"end_latitude","end_longitude","destination.svg")})();const y=t({lat:0,lng:0}),C=t({lat:0,lng:0}),f=t(null),d=t(null),N=()=>{setTimeout(function(){f.value=new window.google.maps.DirectionsService,d.value=new window.google.maps.DirectionsRenderer({draggable:!0,map,panel:document.getElementById("panel")}),d.value.addListener("directions_changed",()=>{d.value.getDirections()}),R(y.value,C.value,f.value,d.value)},1e3)},R=(e,n,p,c)=>{p.route({origin:e,destination:n,travelMode:window.google.maps.TravelMode.DRIVING,avoidTolls:!0}).then(a=>{console.log(a);const w=B(a);u.value=w,_.value={path:w,geodesic:!0,strokeColor:"#000",strokeOpacity:.9,strokeWeight:2}}).catch(a=>{alert("Could not display directions due to: "+a)})},B=e=>{const n=e.routes[0].overview_polyline;return window.google.maps.geometry.encoding.decodePath(n).map(c=>({lat:c.lat(),lng:c.lng()}))};return F(()=>{i.value={lat:l.value.position.start_latitude,lng:l.value.position.start_longitude},y.value=i.value,C.value={lat:l.value.position.end_latitude,lng:l.value.position.end_longitude},N()}),{markerClicked:e=>{h("markerclicked",e)},markers:r,mapCenter:i,mapZoom:o,polylinePath:_,routeCoordinates:u,polylineOptions:v}},props:["system_setting","route","conf"]},W={class:"w-full overflow-auto"},Z={style:{"text-align":"center"}},U=["src"];function b(m,h,i,o,r,_){const u=k("Polyline"),v=k("CustomMarker"),l=k("GoogleMap");return g(),P("div",W,[o.mapCenter?(g(),x(l,{"api-key":i.system_setting.google_map_api,ref:"mapRef",center:o.mapCenter,key:`${o.mapCenter.lat},${o.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:o.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:M(()=>[G(u,{options:o.polylinePath},null,8,["options"]),(g(!0),P(L,null,S(o.markers,(s,V)=>(g(),x(v,{options:{position:s.marker_position},onClick:y=>o.markerClicked(s)},{default:M(()=>[O("div",Z,[O("img",{src:s.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,U)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):T("",!0)])}const H=D(J,[["render",b]]);export{H as r};
