import{_ as G,r as t,U as L,a as h,o as d,c as x,y as M,O,g as R,F as S,f as z,d as p,b as I}from"./index.min.js";import{O as E,L as J,j as Z}from"./index.es-BqyRJkQ3.min.js";const A={components:{GoogleMap:E,Polyline:J,CustomMarker:Z},emits:["markerclicked"],setup(m,{emit:C}){const r=t(null),o=t(null),f=t(12),i=t([]),g=t([]),_=t([]),v=t({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),n=t(m.trip),k=(e,a="lat",u="lng",s)=>{let l=JSON.parse(JSON.stringify(e));return l.icon=m.conf.url+"uploads/images/"+s,l.marker_position={lat:parseFloat(e[a]),lng:parseFloat(e[u])},l.drag=!1,l};(()=>{i.value=[k(n.value,"pickup_latitude","pickup_longitude","car.svg")],i.value[i.value.length]=k(n.value,"destination_latitude","destination_longitude","destination.svg")})();const y=t({lat:0,lng:0}),w=t({lat:0,lng:0}),P=t(null),c=t(null),V=()=>{setTimeout(function(){P.value=new window.google.maps.DirectionsService,c.value=new window.google.maps.DirectionsRenderer({draggable:!0,map:r,panel:document.getElementById("panel")}),c.value.addListener("directions_changed",()=>{const e=c.value.getDirections();e&&T(e)}),N(y.value,w.value,P.value,c.value)},1e3)},N=(e,a,u,s)=>{u.route({origin:e,destination:a,travelMode:window.google.maps.TravelMode.DRIVING,avoidTolls:!0}).then(l=>{console.log(l),B(l)}).catch(l=>{alert("Could not display directions due to: "+l)})},B=e=>{console.log(e);const a=e.routes[0].overview_polyline;return window.google.maps.geometry.encoding.decodePath(a).map(s=>({lat:s.lat(),lng:s.lng()}))},T=e=>{const a=e.routes[0];!a||a.legs},F=async()=>V();return L(()=>{y.value={lat:n.value.pickup_latitude,lng:n.value.pickup_longitude},o.value=y.value,w.value={lat:n.value.destination_latitude,lng:n.value.destination_longitude},F()}),{map:r,markerClicked:e=>{C("markerclicked",e)},markers:i,mapCenter:o,mapZoom:f,polylinePath:g,routeCoordinates:_,polylineOptions:v}},props:["system_setting","trip","conf"]},U={class:"w-full overflow-auto"},W={style:{"text-align":"center"}},b=["src"],j=p("div",{id:"panel"},null,-1),q=p("div",{id:"total"},null,-1);function H(m,C,r,o,f,i){const g=h("Polyline"),_=h("CustomMarker"),v=h("GoogleMap");return d(),x("div",U,[o.mapCenter?(d(),M(v,{"api-key":r.system_setting.google_map_api,ref:"map",center:o.mapCenter,key:`${o.mapCenter.lat},${o.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:o.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:O(()=>[R(g,{options:o.polylinePath},null,8,["options"]),(d(!0),x(S,null,z(o.markers,(n,k)=>(d(),M(_,{options:{position:n.marker_position},onClick:D=>o.markerClicked(n)},{default:O(()=>[p("div",W,[p("img",{src:n.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,b)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):I("",!0),j,q])}const Y=G(A,[["render",H]]);export{Y as t};
