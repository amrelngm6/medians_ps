import{_ as B,o as n,c as a,a as l,E as q,G as J,z as u,s as K,r as g,j as C,d as r,t as h,w as Q,v as W,F as L,i as E,n as M,l as b,k as X,u as S,b as V,x as I,y as z,q as Y,B as Z,p as $}from"./index-_nb2pWsW.js";const ee={},te={fill:"#000000",height:"20px",width:"20px",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24","xml:space":"preserve"},le=l("path",{d:"M14.844 20H6.5C5.121 20 4 18.879 4 17.5S5.121 15 6.5 15h7c1.93 0 3.5-1.57 3.5-3.5S15.43 8 13.5 8H8.639a9.812 9.812 0 0 1-1.354 2H13.5c.827 0 1.5.673 1.5 1.5s-.673 1.5-1.5 1.5h-7C4.019 13 2 15.019 2 17.5S4.019 22 6.5 22h9.593a10.415 10.415 0 0 1-1.249-2zM5 2C3.346 2 2 3.346 2 5c0 3.188 3 5 3 5s3-1.813 3-5c0-1.654-1.346-3-3-3zm0 4.5a1.5 1.5 0 1 1 .001-3.001A1.5 1.5 0 0 1 5 6.5z"},null,-1),se=l("path",{d:"M19 14c-1.654 0-3 1.346-3 3 0 3.188 3 5 3 5s3-1.813 3-5c0-1.654-1.346-3-3-3zm0 4.5a1.5 1.5 0 1 1 .001-3.001A1.5 1.5 0 0 1 19 18.5z"},null,-1),ne=[le,se];function oe(p,o){return n(),a("svg",te,ne)}const ae=B(ee,[["render",oe]]),ie=I(()=>z(()=>import("./map-o87yUY2I.js"),__vite__mapDeps([0,1,2]))),ce=I(()=>z(()=>import("./side-form-create-mpLMQWpM.js"),__vite__mapDeps([3,1,2,4,5,6]))),re=I(()=>z(()=>import("./side-form-update-rRMpHFqO.js"),__vite__mapDeps([7,1,2,4,5,6]))),de={components:{datatabble:q,SideFormCreate:ce,SideFormUpdate:re,maps:ie,delete_icon:J,route_icon:ae},name:"Students",setup(p){const o=p.conf.url+p.path+"?load=json",x=u(!1),e=u(!1),A=u(null),k=u({}),f=u({}),w=u({});u([]),u(!0);const v=u(""),F=u(null),T=u(!1),j=()=>{x.value=!1,e.value=!1};(()=>{Y(o).then(s=>{f.value=JSON.parse(JSON.stringify(s)),d()})})();const _=async()=>{navigator.geolocation?(console.log("position 1"),navigator.geolocation.getCurrentPosition(s=>{w.value={lat:s.coords.latitude,lng:s.coords.longitude}},s=>{Z(s.message,5e3)})):F.value="Geolocation is not supported by this browser."};_();const d=()=>{for(let s=0;s<f.value.items.length;s++)f.value.items[s].active=v.value.trim()?y(f.value.items[s]):1},y=s=>{let i=!!s.route_name.toLowerCase().includes(v.value.toLowerCase());return i||!!s.description.toLowerCase().includes(v.toLowerCase())},D=(s,i)=>{k.value=s;for(let c=0;c<f.value.items.length;c++)f.value.items[c].selected=!1;f.value.items[i].selected=!0,R.value=P(s)},N=(s,i,c)=>{},O=(s,i,c)=>{console.log(s),console.log(i),console.log(c)},P=s=>{let i,c=[],H=p.conf.url+"uploads/images/blue_pin.gif";for(let m=0;m<s.pickup_locations.length;m++){i=s.pickup_locations[m];let U=s.pickup_locations[m].student&&s.pickup_locations[m].student.picture?p.conf.url+s.pickup_locations[m].student.picture:H;c[m]={title:s.pickup_locations[m].student_name,icon:U,origin:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)},destination:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)}}}return c[c.length]={icon:p.conf.url+"uploads/images/car.svg",origin:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)},destination:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)}},w.value=c[0].destination,c[c.length]={drag:!0,icon:p.conf.url+"uploads/images/destination.svg",origin:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)},destination:{lat:parseFloat(s.latitude),lng:parseFloat(s.longitude)}},c},G=(s,i)=>{switch(s){case"view":break;case"edit":k.value=i,x.value=!1,e.value=!0,A.value=!0;break;case"delete":$("driver_id",i,"Driver.delete");break;case"close":e.value=!1,x.value=!1,A.value=!1,k.value={};break}},R=u([]);return{showAddSide:x,waypoints:R,showEditSide:e,url:o,content:f,center:w,activeItem:k,translate:K,setLocationsPickups:P,clickMarker:O,updateMarker:N,setLocationsMarkers:D,checkSimilar:y,searchTextChanged:d,searchText:v,getUserLocation:_,collapsed:T,closeSide:j,handleAction:G}},props:["path","lang","setting","conf","auth"]},ue={class:"w-full flex overflow-auto",style:{height:"85vh","z-index":"9999"}},_e={key:0,class:"w-full relative"},he={class:"self-stretch py-4 flex-col justify-center items-start flex"},fe=["textContent"],xe=["textContent"],pe={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},me=["placeholder"],ve={class:"w-full grow shrink basis-0 px-6 py-4 flex-col justify-center items-start gap-4 inline-flex"},ge={class:"w-full self-stretch justify-start items-start inline-flex cursor-pointer"},ke=["onClick"],we=["textContent"],be=["textContent"],ye={class:"gap-2 py-2 flex justify-start items-start gap-2.5 inline-flex"},Ce=["onClick"],Se=l("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[l("i",{class:"fa fa-location-dot"})],-1),Ae=[Se],Fe=["onClick"],Te=l("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[l("i",{class:"fa fa-edit"})],-1),je=[Te],Le=l("hr",{class:"w-full"},null,-1),Ee={class:"w-full h-8 relative flex"},Me=["src"],Ie=l("i",{class:"fa fa-location-dot text-sm"},null,-1),ze=["textContent"],Pe={class:"right-0 absolute self-stretch text-slate-500 text-base font-normal"},Re=l("i",{class:"fa fa-car px-2"},null,-1),Ve=["textContent"],Be={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},De=["textContent"],Ne=["textContent"],Oe=l("hr",{class:"mt-2"},null,-1),Ge={class:"flex-1 overflow-x-hidden overflow-y-auto w-full relative"},He={class:"px-4 mb-6 py-4 rounded-lg shadow-lg bg-white dark:bg-gray-700 flex w-full"},Ue=["textContent"],qe=l("hr",{class:"mt-2"},null,-1),Je={class:"w-full"},Ke=["src"],Qe={class:"w-full h-8 relative flex"},We=["src"],Xe=["textContent"],Ye=["onClick"],Ze=l("i",{class:"fa fa-edit"},null,-1),$e=[Ze],et=["onClick"];function tt(p,o,x,e,A,k){const f=g("maps"),w=g("route_icon"),v=g("delete_icon"),F=g("datatabble"),T=g("side-form-create"),j=g("side-form-update");return n(),a("div",ue,[e.content?(n(),a("div",_e,[e.center?(n(),C(f,{conf:x.conf,setting:x.setting,key:e.center,center:e.center,onClickMarker:e.clickMarker,waypoints:e.waypoints,showroute:!1},null,8,["conf","setting","center","onClickMarker","waypoints"])):r("",!0),l("div",{style:b(e.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-16 h-full absolute top-4 rounded-lg p-4 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[l("div",he,[l("div",{class:"text-black text-lg font-semibold",textContent:h(e.translate("Routes"))},null,8,fe),l("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:h(e.translate("Routes description"))},null,8,xe)]),e.collapsed?r("",!0):(n(),a("div",pe,[Q(l("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:e.translate("find by name and address"),"onUpdate:modelValue":o[0]||(o[0]=t=>e.searchText=t),onChange:o[1]||(o[1]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t)),onInput:o[2]||(o[2]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t)),onKeydown:o[3]||(o[3]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t))},null,40,me),[[W,e.searchText]])])),!e.collapsed&&e.content.items?(n(),a("div",{key:e.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[(n(!0),a(L,null,E(e.content.items,(t,_)=>(n(),a("div",{key:t.active,class:"w-full"},[t.active?(n(),a("div",{key:0,class:M([t.selected?"text-fuchsia-600":"bg-gray-50","mb-4 w-full rounded-lg justify-start items-center inline-flex"])},[l("div",ve,[l("div",ge,[l("div",{onClick:d=>e.setLocationsMarkers(t,_),class:"w-full grow shrink basis-0 flex-col justify-start items-start inline-flex"},[l("div",{class:M([t.selected?"text-fuchsia-600":"text-gray-800","self-stretch text-base font-semibold tracking-tight"]),textContent:h(t.route_name)},null,10,we),l("div",{class:"py-1 self-stretch text-slate-500 text-sm font-semibold leading-relaxed tracking-wide",textContent:h(t.description)},null,8,be)],8,ke),l("div",ye,[l("div",{class:"px-3 py-2 bg-purple-800 rounded-full justify-center items-center flex cursor-pointer",onClick:d=>e.setLocationsMarkers(t,_)},Ae,8,Ce),l("div",{class:"px-3 py-2 bg-purple-800 rounded justify-center items-center flex cursor-pointer",onClick:d=>e.handleAction("edit",t)},je,8,Fe)])]),Le,l("div",Ee,[(n(!0),a(L,null,E(t.pickup_locations,(d,y)=>(n(),a("img",{style:b("left: "+20*y+"px"),class:"rounded-full w-8 h-8 left-0 top-0 absolute rounded-[50px] border-2 border-purple-800",src:d.student&&d.student.picture?d.student.picture:"https://via.placeholder.com/37x37"},null,12,Me))),256)),l("span",{class:"absolute pt-2",style:b("left: "+(20*t.pickup_locations.length+20)+"px")},[Ie,X(),t.pickup_locations?(n(),a("span",{key:0,class:"font-semibold px-1",textContent:h(t.pickup_locations.length)},null,8,ze)):r("",!0)],4),l("div",Pe,[Re,t.vehicle?(n(),a("span",{key:0,class:"font-semibold text-sm",textContent:h(t.vehicle.plate_number)},null,8,Ve)):r("",!0)])])])],2)):r("",!0)]))),128))])):r("",!0),l("div",Be,[l("div",{class:"menu-dark rounded-lg text-white text-xs font-medium px-4 py-3 uppercase cursor-pointer",onClick:o[4]||(o[4]=t=>{e.showAddSide=!0,e.activeItem={}}),textContent:h(e.translate("add new"))},null,8,De),l("div",{onClick:o[5]||(o[5]=t=>e.collapsed=!e.collapsed),class:"cursor-pointer p-2 block text-center"},[l("i",{class:M(["fa",e.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),l("p",{class:"font-semibold",textContent:h(e.collapsed?e.translate("Expand"):e.translate("Collapse"))},null,8,Ne)])])],4),Oe,l("main",Ge,[l("div",He,[l("h1",{class:"font-bold text-lg w-full",textContent:h(e.content.title)},null,8,Ue),l("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg menu-dark hover:bg-purple-800",onClick:o[6]||(o[6]=t=>{e.showAddSide=!0,e.activeItem={}})},h(e.translate("add_new")),1)]),qe,l("div",Je,[e.content.columns?(n(),C(F,{key:0,"body-text-direction":e.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:e.content.columns,items:e.content.items},{"item-picture":S(t=>[l("img",{src:t.picture,class:"w-8 h-8 rounded-full"},null,8,Ke)]),"item-pickup_locations":S(t=>[l("div",Qe,[(n(!0),a(L,null,E(t.pickup_locations,(_,d)=>(n(),a("div",{style:b("left: "+20*d+"px"),class:"rounded-full w-8 h-8 left-0 top-0 absolute"},[d<3?(n(),a("img",{key:d,class:"rounded-full w-8 h-8 rounded-[50px] border-2 border-purple-800",src:_.student&&_.student.picture?_.student.picture:"https://via.placeholder.com/37x37"},null,8,We)):r("",!0)],4))),256)),l("span",{class:"flex absolute pt-2",style:b("left: "+(20*(t.pickup_locations.length<3?t.pickup_locations.length:3)+20)+"px")},[V(w),t.pickup_locations?(n(),a("span",{key:0,class:"font-semibold px-1",textContent:h(t.pickup_locations.length)},null,8,Xe)):r("",!0)],4)])]),"item-edit":S(t=>[t.not_editable?r("",!0):(n(),a("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:_=>e.handleAction("edit",t)},$e,8,Ye))]),"item-delete":S(t=>[t.not_removeable?r("",!0):(n(),a("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:_=>e.handleAction("delete",t)},[V(v,{class:"w-4"})],8,et))]),_:1},8,["body-text-direction","headers","items"])):r("",!0),e.showAddSide&&e.content&&e.content.fillable?(n(),C(T,{key:1,onCallback:e.closeSide,conf:x.conf,model:"Routes.create",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","columns"])):r("",!0),e.showEditSide&&!e.showAddSide?(n(),C(j,{onCallback:e.closeSide,key:e.activeItem,conf:x.conf,model:"Routes.update",item:e.activeItem,model_id:e.activeItem.route_id,index:"route_id",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","item","model_id","columns"])):r("",!0)])])])):r("",!0)])}const st=B(de,[["render",tt]]);export{st as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/map-o87yUY2I.js","assets/index-_nb2pWsW.js","assets/index-pdpIohfm.css","assets/side-form-create-mpLMQWpM.js","assets/Field-gVGGrFG_.js","assets/Manager-Ods76_QB.js","assets/Manager-Cgf44v6b.css","assets/side-form-update-rRMpHFqO.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}