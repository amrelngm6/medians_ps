const __vite__fileDeps=["side-form-create-DwwFhpNu.min.js","index.min.js","index.min.css","Field-DGSjrbSi.min.js","Field.min.css","side-form-update-1JDxVMwr.min.js","form_field-DSvRoxGR.min.js","editable_map_location-C3m7cXEh.min.js","index.es-BqyRJkQ3.min.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as oe,D as ie,E as ce,x as de,G as re,r as o,t as x,al as j,a as I,o as r,c as _,b as m,d as t,g as p,e as n,n as _e,I as ue,q as T,u as V,s as M,J as U,a7 as ve,l as me,K as he,L as z,M as fe,p as ge}from"./index.min.js";import{e as xe}from"./editable_map_location-C3m7cXEh.min.js";import{d as pe}from"./drivers_locations_map-D2jb4AK9.min.js";import{t as we}from"./tooltip-B6mCVe86.min.js";import{t as be}from"./trip_map-FSnhAuFV.min.js";import"./index.es-BqyRJkQ3.min.js";const Ce=T(()=>V(()=>import("./side-form-create-DwwFhpNu.min.js"),__vite__mapDeps([0,1,2,3,4]))),ke=T(()=>V(()=>import("./side-form-update-1JDxVMwr.min.js"),__vite__mapDeps([5,1,2,3,4,6,7,8]))),ye=T(()=>V(()=>import("./form_field-DSvRoxGR.min.js"),__vite__mapDeps([6,1,2,3,4,7,8]))),Ie={components:{datatabble:ie,SideFormCreate:Ce,SideFormUpdate:ke,trip_map:be,close_icon:ce,delete_icon:de,car_icon:re,form_field:ye,editable_map_location:xe,drivers_locations_map:pe,tooltip:we},name:"Taxi trips",emits:["callback"],setup(a,{emit:w}){const u=o(!1),s=o(!1),E=o(!1);o(null);const l=o({}),b=o(a.usertype),S=o({}),C=o({});o([]),o(!0);const c=o(""),L=o(null),B=o(!1),R=o([a.usertype,"Pickup location","Destination","Driver","Time","Cost","Confirm"]),k=o([]),O=o(!1),P=o(""),D=o(""),W=o([{title:x("Scheduled"),status:"scheduled"},{title:x("Started"),status:"started"},{title:x("Completed"),status:"completed"},{title:x("Cancelled"),status:"cancelled"}]);console.log(a.item),a.item?(l.value=a.item,l.value.date=a.item.date??j()):l.value.date=j();const q=a.userslist?o(a.userslist):o([]),A=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{l.value.trip_id||(l.value.pickup_latitude=e.coords.latitude,l.value.pickup_longitude=e.coords.longitude,l.value.destination_latitude=e.coords.latitude,l.value.destination_longitude=e.coords.longitude)},e=>{l.value.trip_id||(l.value.pickup_latitude=l.value.pickup_latitude??30.06,l.value.pickup_longitude=l.value.pickup_longitude??31.21,l.value.destination_latitude=l.value.destination_latitude??30.06,l.value.destination_longitude=l.value.destination_longitude??31.21),M(e.message)}):(M("location error"),L.value="Geolocation is not supported by this browser.")};A();const J=async()=>{let e=P.value.length>3?await U(a.system_setting.google_map_api,P.value,a.business_setting.country):"";k.value=e.predictions},F=async()=>{let e=D.value.length>3?await U(a.system_setting.google_map_api,D.value,a.business_setting.country):"";k.value=e.predictions},G=()=>{u.value=!0;var e=new URLSearchParams;let i=JSON.parse(JSON.stringify(l.value)),v=Object.keys(i),d,f;for(let g=0;g<v.length;g++)d=v[g],f=typeof i[d]=="object"?JSON.stringify(i[d]):i[d],e.append("params["+d+"]",f);let y=i.trip_id>0?"update":"create";e.append("type","TaxiTrip."+y);const h=ve();h&&(h.root.data.loader=!0),me(e,"/api/"+y).then(g=>{he(g),u.value=!1})},K=async e=>{l.value.pickup_latitude=e.lat(),l.value.pickup_longitude=e.lng(),l.value.pickup_address=await z(e.lat(),e.lng())},H=async e=>{l.value.destination_latitude=e.lat(),l.value.destination_longitude=e.lng(),l.value.destination_address=await z(e.lat(),e.lng())},Q=async(e,i)=>{const v=new google.maps.places.PlacesService(document.createElement("div"));let d=e.place_id;v.getDetails({placeId:d},(f,y)=>{if(y===google.maps.places.PlacesServiceStatus.OK&&f){const h=f.geometry.location;i=="pickup"&&(l.value.pickup_address=e.description,l.value.pickup_latitude=h.lat(),l.value.pickup_longitude=h.lng()),i=="destination"&&(l.value.destination_address=e.description,l.value.destination_latitude=h.lat(),l.value.destination_longitude=h.lng()),k.value=[],O.value=!1}else console.error("Failed to fetch place details")})},X=()=>{w("callback")},Y=()=>fe(["model_id","driver_id","pickup_address","destination_address","status"],l),Z=e=>{l.value.model_id=a.usertype=="student"?e.student_id:e.customer_id,l.value.model=e,b.value="Pickup location",c.value=null},$=e=>{l.value.driver_id=e.driver_id,l.value.driver=e,N(e.vehicle)},N=e=>{l.value.vehicle_id=e.vehicle_id,l.value.vehicle=e,c.value=null},ee=()=>{if(a.drivers)for(let e=0;e<a.drivers.length;e++)a.drivers[e].show=c.value.trim()?te(a.drivers[e]):1},te=e=>{let i=!!e.name.toLowerCase().includes(c.value.toLowerCase());return i||!!e.mobile.toLowerCase().includes(c.value.toLowerCase())},se=()=>{if(a.vehicles)for(let e=0;e<a.vehicles.length;e++)a.vehicles[e].show=c.value.trim()?le(a.vehicles[e]):1},le=e=>{let i=!!e.vehicle_name.toLowerCase().includes(c.value.toLowerCase());return i||!!e.plate_number.toLowerCase().includes(c.value.toLowerCase())},ae=()=>{if(a.userslist)for(let e=0;e<a.userslist.length;e++)a.userslist[e].show=c.value.trim()?ne(a.userslist[e]):1},ne=e=>{let i=!!e.name.toLowerCase().includes(c.value.toLowerCase()),v=i||!!e.email.toLowerCase().includes(c.value.toLowerCase());return v||!!e.mobile.toLowerCase().includes(c.value.toLowerCase())};return{loader:u,tripsStatusList:W,selectedObject:(e,i)=>{const v=l.value[i];for(let d=0;d<e.length;d++)if(e[d][i]==v)return e[d];return{}},findDriver:ee,setDriver:$,findVehicle:se,setVehicle:N,users:q,progressWidth:Y,setUser:Z,findUser:ae,setPlaceMarker:Q,showPlaceSearch:O,pickupPlaceChanged:J,destinationPlaceChanged:F,pickup_placeSearch:P,destination_placeSearch:D,places:k,showAddSide:s,showEditSide:E,content:S,fillable:R,center:C,activeItem:l,activeTab:b,translate:x,updatePickupMarker:K,updateDestinationMarker:H,searchText:c,getUserLocation:A,collapsed:B,saveTrip:G,back:X}},props:["conf","path","system_setting","business_setting","setting","item","userslist","usertype","drivers","vehicles","currency"]},Se={class:"w-full"},Le=t("img",{class:"m-auto w-500px",src:"/uploads/loader.gif"},null,-1),Pe=[Le],De={class:"w-full flex overflow-auto"},Te={class:"w-full relative"},Ve={class:"card w-full py-10"},Ee={class:"w-full stepper stepper-links"},Oe={class:"w-full"},Ae={class:""},Ne={class:"card-body pt-0 mx-auto"},je={class:"w-full flex gap-10"},Me={class:"w-full"},Ue={class:"w-full"},ze=t("hr",{class:"block mt-6 my-2 opacity-10"},null,-1),Be={class:"bg-gray-200 shadow-md mb-10 rounded-xl"},Re={class:"card-header border-0 pt-9"},We={key:0,class:"card-title m-0 flex gap-4"},qe={class:"symbol symbol-50px w-50px bg-light"},Je=["src"],Fe={class:"w-full"},Ge=["textContent"],Ke=["textContent"],He={key:0,class:"card-body p-9"},Qe={class:"timeline timeline-border-dashed"},Xe={class:"timeline-item"},Ye=t("div",{class:"timeline-line"},null,-1),Ze={class:"timeline-icon me-4"},$e={class:"timeline-content mb-10 mt-n2"},et={class:"overflow-auto pe-3"},tt=["textContent"],st={class:"d-flex align-items-center mt-1 fs-6"},lt=["textContent"],at={class:"timeline-item"},nt=t("div",{class:"timeline-line"},null,-1),ot={class:"timeline-icon me-4"},it={class:"timeline-content mb-10 mt-n2"},ct={class:"overflow-auto pe-3"},dt=["textContent"],rt={class:"d-flex align-items-center mt-1 fs-6"},_t=["textContent"],ut={class:"h-4px w-100 bg-light mb-5"},vt={key:0,class:"w-full flex gap-4"},mt={key:0,class:"flex gap-4 w-full"},ht=["src"],ft={class:"block gap-4 w-full"},gt=["textContent"],xt=["textContent"],pt={key:1,class:"w-full flex gap-4"},wt={class:"block gap-4"},bt=["textContent"],Ct=["textContent"],kt={key:2,class:"w-full flex-end"},yt=["textContent"],It={class:"w-full flex gap-4"},St=["textContent"],Lt=["textContent"],Pt={class:"flex gap-6 pb-4 font-semibold text-lg"},Dt={class:"flex gap-6 w-full"},Tt=["textContent"],Vt=["textContent"],Et={class:"flex gap-6 w-full"},Ot=["textContent"],At=["textContent"],Nt={class:"flex gap-6 w-full"},jt=["textContent"],Mt=["textContent"],Ut={class:"notice d-flex bg-light-warning rounded border-warning border border-dashed mb-12 p-6 gap-4"},zt=ge('<i class="vue-feather vue-feather--alert-octagon ki-duotone ki-information fs-2tx text-warning me-4" data-name="alert-octagon" data-tags="warning,alert,danger" data-type="alert-octagon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-octagon vue-feather__content"><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></i>',1),Bt={class:"d-flex flex-stack flex-grow-1"},Rt={class:"fw-semibold"},Wt=["textContent"],qt={class:"fs-6 text-gray-700"},Jt=["textContent"],Ft={class:"text-center mt-10"},Gt=["textContent"];function Kt(a,w,u,s,E,l){const b=I("close_icon"),S=I("trip_map"),C=I("vue-feather"),c=I("car_icon");return r(),_("div",Se,[s.loader?(r(),_("div",{key:s.loader,class:"bg-white fixed w-full h-full top-0 left-0",style:{"z-index":"99999",opacity:".9"}},Pe)):m("",!0),t("div",De,[t("div",Te,[p(b,{class:"absolute top-4 right-4 z-10 cursor-pointer",onClick:s.back},null,8,["onClick"]),t("div",Ve,[t("div",Ee,[t("div",Oe,[t("div",Ae,[t("div",Ne,[t("div",je,[t("div",Me,[p(S,{onMarkerclicked:a.markerClicked,class:"w-full rounded-xl shadow-md mx-4",system_setting:u.system_setting,conf:u.conf,trip:s.activeItem},null,8,["onMarkerclicked","system_setting","conf","trip"])]),t("div",Ue,[ze,t("div",Be,[t("div",Re,[s.activeItem.model?(r(),_("div",We,[t("div",qe,[t("img",{src:s.activeItem.model.picture,alt:"image",class:"p-3"},null,8,Je)]),t("div",Fe,[t("div",{class:"font-semibold",textContent:n(s.activeItem.model.name)},null,8,Ge),t("div",{class:"",textContent:n(s.activeItem.model.mobile)},null,8,Ke)])])):m("",!0)]),s.activeItem?(r(),_("div",He,[t("div",Qe,[t("div",Xe,[Ye,t("div",Ze,[p(C,{type:"circle",class:"fs-2 text-success"})]),t("div",$e,[t("div",et,[s.activeItem?(r(),_("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:n(s.activeItem.pickup_address)},null,8,tt)):m("",!0),t("div",st,[t("div",{class:"text-muted me-2 fs-7",textContent:n(s.translate("Pickup"))},null,8,lt)])])])]),t("div",at,[nt,t("div",ot,[p(C,{type:"map-pin",class:"fs-2 text-danger"})]),t("div",it,[t("div",ct,[s.activeItem?(r(),_("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:n(s.activeItem.destination_address)},null,8,dt)):m("",!0),t("div",rt,[t("div",{class:"text-muted me-2 fs-7",textContent:n(s.translate("Destination"))},null,8,_t)])])])])]),t("div",ut,[t("div",{class:_e(["rounded h-4px transition transition-all",s.progressWidth()<100?"bg-info":"bg-success"]),role:"progressbar",style:ue({width:s.progressWidth()+"%"})},null,6)]),s.activeItem?(r(),_("div",vt,[s.activeItem.driver?(r(),_("div",mt,[t("img",{src:s.activeItem.driver.picture,class:"rounded-full bg-white border-1 border border-gray-600 p-1 w-12 h-12"},null,8,ht),t("div",ft,[t("span",{class:"w-full block font-semibold",textContent:n(s.translate("Driver"))},null,8,gt),t("span",{class:"w-full block",textContent:n(s.activeItem.driver.name)},null,8,xt)])])):m("",!0),s.activeItem.vehicle?(r(),_("div",pt,[p(c),t("div",wt,[t("span",{class:"w-full block font-semibold",textContent:n(s.translate("Vehicle"))},null,8,bt),t("span",{class:"w-full block",textContent:n(s.activeItem.vehicle.plate_number)},null,8,Ct)])])):m("",!0),s.activeItem.date?(r(),_("div",kt,[t("span",{class:"w-full block font-semibold",textContent:n(s.translate("Trip date"))},null,8,yt),t("div",It,[t("span",{class:"",textContent:n(s.activeItem.date)},null,8,St),t("span",{class:"",textContent:n(s.activeItem.start_time)},null,8,Lt)])])):m("",!0)])):m("",!0)])):m("",!0)]),t("div",Pt,[t("div",Dt,[t("div",{textContent:n(s.translate("Subtotal"))},null,8,Tt),t("div",{textContent:n(u.currency.symbol+""+s.activeItem.subtotal)},null,8,Vt)]),t("div",Et,[t("div",{textContent:n(s.translate("Discount"))},null,8,Ot),t("div",{textContent:n(u.currency.symbol+""+s.activeItem.discount_amount)},null,8,At)]),t("div",Nt,[t("div",{textContent:n(s.translate("Total cost"))},null,8,jt),t("div",{textContent:n(u.currency.symbol+""+s.activeItem.total_cost)},null,8,Mt)])]),t("div",Ut,[zt,t("div",Bt,[t("div",Rt,[t("h4",{class:"text-gray-900 fw-bold",textContent:n(s.translate(s.activeItem.payment_status))},null,8,Wt),t("div",qt,[t("div",{textContent:n(s.translate("Payment status"))},null,8,Jt)])])])])])]),t("p",Ft,[t("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:w[0]||(w[0]=(...L)=>s.back&&s.back(...L)),textContent:n(s.translate("Back"))},null,8,Gt)])])])])])])])])])}const ts=oe(Ie,[["render",Kt]]);export{ts as default};
