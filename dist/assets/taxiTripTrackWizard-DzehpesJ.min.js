const __vite__fileDeps=["form_field-CmliNem_.min.js","index.min.js","index.min.css","Field-DGSjrbSi.min.js","Field.min.css","editable_map_location-C3m7cXEh.min.js","index.es-BqyRJkQ3.min.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as tt,E as et,x as st,G as lt,r as n,t as p,ak as N,a as I,o as d,c as r,b as m,d as t,g as x,e as a,n as at,I as nt,q as ot,u as it,s as j,J as A,a7 as ct,l as dt,K as rt,L as M,M as _t,p as ut}from"./index.min.js";import{e as vt}from"./editable_map_location-C3m7cXEh.min.js";import{d as mt}from"./drivers_locations_map-DiTe87JV.min.js";import{t as ht}from"./tooltip-B6mCVe86.min.js";import{t as ft}from"./trip_map-CgMcL7Bn.min.js";import"./index.es-BqyRJkQ3.min.js";const gt=ot(()=>it(()=>import("./form_field-CmliNem_.min.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),pt={components:{trip_map:ft,close_icon:et,delete_icon:st,car_icon:lt,form_field:gt,editable_map_location:vt,drivers_locations_map:mt,tooltip:ht},name:"Taxi trips",emits:["callback"],setup(o,{emit:b}){const _=n(!1),s=n(!1),L=n(!1);n(null);const l=n({}),k=n(o.usertype),S=n({}),w=n({});n([]),n(!0);const u=n(""),P=n(null),z=n(!1),B=n([o.usertype,"Pickup location","Destination","Driver","Time","Cost","Confirm"]),y=n([]),O=n(!1),D=n(""),T=n(""),U=n([{title:p("Scheduled"),status:"scheduled"},{title:p("Started"),status:"started"},{title:p("Completed"),status:"completed"},{title:p("Cancelled"),status:"cancelled"}]);console.log(o.item),o.item?(l.value=o.item,l.value.date=o.item.date??N()):l.value.date=N();const W=o.userslist?n(o.userslist):n([]),V=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{l.value.trip_id||(l.value.pickup_latitude=e.coords.latitude,l.value.pickup_longitude=e.coords.longitude,l.value.destination_latitude=e.coords.latitude,l.value.destination_longitude=e.coords.longitude)},e=>{l.value.trip_id||(l.value.pickup_latitude=l.value.pickup_latitude??30.06,l.value.pickup_longitude=l.value.pickup_longitude??31.21,l.value.destination_latitude=l.value.destination_latitude??30.06,l.value.destination_longitude=l.value.destination_longitude??31.21),j(e.message)}):(j("location error"),P.value="Geolocation is not supported by this browser.")};V();const q=async()=>{let e=D.value.length>3?await A(o.system_setting.google_map_api,D.value,o.business_setting.country):"";y.value=e.predictions},J=async()=>{let e=T.value.length>3?await A(o.system_setting.google_map_api,T.value,o.business_setting.country):"";y.value=e.predictions},R=()=>{_.value=!0;var e=new URLSearchParams;let i=JSON.parse(JSON.stringify(l.value)),v=Object.keys(i),c,f;for(let g=0;g<v.length;g++)c=v[g],f=typeof i[c]=="object"?JSON.stringify(i[c]):i[c],e.append("params["+c+"]",f);let C=i.trip_id>0?"update":"create";e.append("type","TaxiTrip."+C);const h=ct();h&&(h.root.data.loader=!0),dt(e,"/api/"+C).then(g=>{rt(g),_.value=!1})},G=async e=>{l.value.pickup_latitude=e.lat(),l.value.pickup_longitude=e.lng(),l.value.pickup_address=await M(e.lat(),e.lng())},K=async e=>{l.value.destination_latitude=e.lat(),l.value.destination_longitude=e.lng(),l.value.destination_address=await M(e.lat(),e.lng())},F=async(e,i)=>{const v=new google.maps.places.PlacesService(document.createElement("div"));let c=e.place_id;v.getDetails({placeId:c},(f,C)=>{if(C===google.maps.places.PlacesServiceStatus.OK&&f){const h=f.geometry.location;i=="pickup"&&(l.value.pickup_address=e.description,l.value.pickup_latitude=h.lat(),l.value.pickup_longitude=h.lng()),i=="destination"&&(l.value.destination_address=e.description,l.value.destination_latitude=h.lat(),l.value.destination_longitude=h.lng()),y.value=[],O.value=!1}else console.error("Failed to fetch place details")})},H=()=>{b("callback")},Q=()=>_t(["model_id","driver_id","pickup_address","destination_address","status"],l),X=e=>{l.value.model_id=o.usertype=="student"?e.student_id:e.customer_id,l.value.model=e,k.value="Pickup location",u.value=null},Y=e=>{l.value.driver_id=e.driver_id,l.value.driver=e,E(e.vehicle)},E=e=>{l.value.vehicle_id=e.vehicle_id,l.value.vehicle=e,u.value=null},Z=()=>{if(o.userslist)for(let e=0;e<o.userslist.length;e++)o.userslist[e].show=u.value.trim()?$(o.userslist[e]):1},$=e=>{let i=!!e.name.toLowerCase().includes(u.value.toLowerCase()),v=i||!!e.email.toLowerCase().includes(u.value.toLowerCase());return v||!!e.mobile.toLowerCase().includes(u.value.toLowerCase())};return{loader:_,tripsStatusList:U,selectedObject:(e,i)=>{const v=l.value[i];for(let c=0;c<e.length;c++)if(e[c][i]==v)return e[c];return{}},setDriver:Y,setVehicle:E,users:W,progressWidth:Q,setUser:X,findUser:Z,setPlaceMarker:F,showPlaceSearch:O,pickupPlaceChanged:q,destinationPlaceChanged:J,pickup_placeSearch:D,destination_placeSearch:T,places:y,showAddSide:s,showEditSide:L,content:S,fillable:B,center:w,activeItem:l,activeTab:k,translate:p,updatePickupMarker:G,updateDestinationMarker:K,searchText:u,getUserLocation:V,collapsed:z,saveTrip:R,back:H}},props:["conf","path","system_setting","business_setting","setting","item","userslist","usertype","drivers","vehicles","currency"]},xt={class:"w-full"},bt=t("img",{class:"m-auto w-500px",src:"/uploads/loader.gif"},null,-1),kt=[bt],wt={class:"w-full flex overflow-auto"},yt={class:"w-full relative"},Ct={class:"card w-full py-10"},It={class:"w-full stepper stepper-links"},St={class:"w-full"},Pt={class:""},Dt={class:"card-body pt-0 mx-auto"},Tt={class:"w-full flex gap-10"},Lt={class:"w-full"},Ot={class:"w-full"},Vt=t("hr",{class:"block mt-6 my-2 opacity-10"},null,-1),Et={class:"bg-gray-200 shadow-md mb-10 rounded-xl"},Nt={class:"card-header border-0 pt-9"},jt={key:0,class:"card-title m-0 flex gap-4"},At={class:"symbol symbol-50px w-50px bg-light"},Mt=["src"],zt={class:"w-full"},Bt=["textContent"],Ut=["textContent"],Wt={key:0,class:"card-body p-9"},qt={class:"timeline timeline-border-dashed"},Jt={class:"timeline-item"},Rt=t("div",{class:"timeline-line"},null,-1),Gt={class:"timeline-icon me-4"},Kt={class:"timeline-content mb-10 mt-n2"},Ft={class:"overflow-auto pe-3"},Ht=["textContent"],Qt={class:"d-flex align-items-center mt-1 fs-6"},Xt=["textContent"],Yt={class:"timeline-item"},Zt=t("div",{class:"timeline-line"},null,-1),$t={class:"timeline-icon me-4"},te={class:"timeline-content mb-10 mt-n2"},ee={class:"overflow-auto pe-3"},se=["textContent"],le={class:"d-flex align-items-center mt-1 fs-6"},ae=["textContent"],ne={class:"h-4px w-100 bg-light mb-5"},oe={key:0,class:"w-full flex gap-4"},ie={key:0,class:"flex gap-4 w-full"},ce=["src"],de={class:"block gap-4 w-full"},re=["textContent"],_e=["textContent"],ue={key:1,class:"w-full flex gap-4"},ve={class:"block gap-4"},me=["textContent"],he=["textContent"],fe={key:2,class:"w-full flex-end"},ge=["textContent"],pe={class:"w-full flex gap-4"},xe=["textContent"],be=["textContent"],ke={class:"flex gap-6 pb-4 font-semibold text-lg"},we={class:"flex gap-6 w-full"},ye=["textContent"],Ce=["textContent"],Ie={class:"flex gap-6 w-full"},Se=["textContent"],Pe=["textContent"],De={class:"flex gap-6 w-full"},Te=["textContent"],Le=["textContent"],Oe={class:"notice d-flex bg-light-warning rounded border-warning border border-dashed mb-12 p-6 gap-4"},Ve=ut('<i class="vue-feather vue-feather--alert-octagon ki-duotone ki-information fs-2tx text-warning me-4" data-name="alert-octagon" data-tags="warning,alert,danger" data-type="alert-octagon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-octagon vue-feather__content"><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></i>',1),Ee={class:"d-flex flex-stack flex-grow-1"},Ne={class:"fw-semibold"},je=["textContent"],Ae={class:"fs-6 text-gray-700"},Me=["textContent"],ze={class:"text-center mt-10"},Be=["textContent"];function Ue(o,b,_,s,L,l){const k=I("close_icon"),S=I("trip_map"),w=I("vue-feather"),u=I("car_icon");return d(),r("div",xt,[s.loader?(d(),r("div",{key:s.loader,class:"bg-white fixed w-full h-full top-0 left-0",style:{"z-index":"99999",opacity:".9"}},kt)):m("",!0),t("div",wt,[t("div",yt,[x(k,{class:"absolute top-4 right-4 z-10 cursor-pointer",onClick:s.back},null,8,["onClick"]),t("div",Ct,[t("div",It,[t("div",St,[t("div",Pt,[t("div",Dt,[t("div",Tt,[t("div",Lt,[x(S,{onMarkerclicked:o.markerClicked,class:"w-full rounded-xl shadow-md mx-4",system_setting:_.system_setting,conf:_.conf,trip:s.activeItem},null,8,["onMarkerclicked","system_setting","conf","trip"])]),t("div",Ot,[Vt,t("div",Et,[t("div",Nt,[s.activeItem.model?(d(),r("div",jt,[t("div",At,[t("img",{src:s.activeItem.model.picture,alt:"image",class:"p-3"},null,8,Mt)]),t("div",zt,[t("div",{class:"font-semibold",textContent:a(s.activeItem.model.name)},null,8,Bt),t("div",{class:"",textContent:a(s.activeItem.model.mobile)},null,8,Ut)])])):m("",!0)]),s.activeItem?(d(),r("div",Wt,[t("div",qt,[t("div",Jt,[Rt,t("div",Gt,[x(w,{type:"circle",class:"fs-2 text-success"})]),t("div",Kt,[t("div",Ft,[s.activeItem?(d(),r("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:a(s.activeItem.pickup_address)},null,8,Ht)):m("",!0),t("div",Qt,[t("div",{class:"text-muted me-2 fs-7",textContent:a(s.translate("Pickup"))},null,8,Xt)])])])]),t("div",Yt,[Zt,t("div",$t,[x(w,{type:"map-pin",class:"fs-2 text-danger"})]),t("div",te,[t("div",ee,[s.activeItem?(d(),r("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:a(s.activeItem.destination_address)},null,8,se)):m("",!0),t("div",le,[t("div",{class:"text-muted me-2 fs-7",textContent:a(s.translate("Destination"))},null,8,ae)])])])])]),t("div",ne,[t("div",{class:at(["rounded h-4px transition transition-all",s.progressWidth()<100?"bg-info":"bg-success"]),role:"progressbar",style:nt({width:s.progressWidth()+"%"})},null,6)]),s.activeItem?(d(),r("div",oe,[s.activeItem.driver?(d(),r("div",ie,[t("img",{src:s.activeItem.driver.picture,class:"rounded-full bg-white border-1 border border-gray-600 p-1 w-12 h-12"},null,8,ce),t("div",de,[t("span",{class:"w-full block font-semibold",textContent:a(s.translate("Driver"))},null,8,re),t("span",{class:"w-full block",textContent:a(s.activeItem.driver.name)},null,8,_e)])])):m("",!0),s.activeItem.vehicle?(d(),r("div",ue,[x(u),t("div",ve,[t("span",{class:"w-full block font-semibold",textContent:a(s.translate("Vehicle"))},null,8,me),t("span",{class:"w-full block",textContent:a(s.activeItem.vehicle.plate_number)},null,8,he)])])):m("",!0),s.activeItem.date?(d(),r("div",fe,[t("span",{class:"w-full block font-semibold",textContent:a(s.translate("Trip date"))},null,8,ge),t("div",pe,[t("span",{class:"",textContent:a(s.activeItem.date)},null,8,xe),t("span",{class:"",textContent:a(s.activeItem.start_time)},null,8,be)])])):m("",!0)])):m("",!0)])):m("",!0)]),t("div",ke,[t("div",we,[t("div",{textContent:a(s.translate("Subtotal"))},null,8,ye),t("div",{textContent:a(_.currency.symbol+""+s.activeItem.subtotal)},null,8,Ce)]),t("div",Ie,[t("div",{textContent:a(s.translate("Discount"))},null,8,Se),t("div",{textContent:a(_.currency.symbol+""+s.activeItem.discount_amount)},null,8,Pe)]),t("div",De,[t("div",{textContent:a(s.translate("Total cost"))},null,8,Te),t("div",{textContent:a(_.currency.symbol+""+s.activeItem.total_cost)},null,8,Le)])]),t("div",Oe,[Ve,t("div",Ee,[t("div",Ne,[t("h4",{class:"text-gray-900 fw-bold",textContent:a(s.translate(s.activeItem.payment_status))},null,8,je),t("div",Ae,[t("div",{textContent:a(s.translate("Payment status"))},null,8,Me)])])])])])]),t("p",ze,[t("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:b[0]||(b[0]=(...P)=>s.back&&s.back(...P)),textContent:a(s.translate("Back"))},null,8,Be)])])])])])])])])])}const He=tt(pt,[["render",Ue]]);export{He as default};
