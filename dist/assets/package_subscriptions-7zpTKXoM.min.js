import{_ as O,D as V,G as Q,e as R,y as N,z as F,f,t as J,r as v,o as l,c as i,i as e,a as h,F as z,k as I,x as Y,j as a,H as P,I as L,h as r,d as g,b as y,n as X,J as Z,K as $,P as tt,g as A,A as E,m as et,p as st}from"./index.min.js";import{e as U}from"./editable_map_location-V2kNDwZy.min.js";import{r as nt}from"./route_map-_lbnF5M5.min.js";import{e as at}from"./routeLocationWizard-Ak0pkAec.min.js";import"./index.es-08gBEiIi.min.js";import"./tooltip-s9Xa9pgY.min.js";const ot=g(()=>y(()=>import("./map-XRH7L8ya.min.js"),__vite__mapDeps([0,1,2,3]))),lt=g(()=>y(()=>import("./side-form-create-H9wI8WKg.min.js"),__vite__mapDeps([4,2,3,5,6]))),it=g(()=>y(()=>import("./side-form-update-04MNAfTa.min.js"),__vite__mapDeps([7,2,3,5,6,8,9,1]))),ct=g(()=>y(()=>import("./form_field-67i-FqgB.min.js"),__vite__mapDeps([8,2,3,5,6,9,1]))),dt={components:{datatabble:V,SideFormCreate:lt,SideFormUpdate:it,maps:ot,close_icon:Q,delete_icon:R,car_icon:N,route_icon:F,form_field:ct,editable_map_location:U,route_map:nt},name:"PackageSubscriptions",emits:["callback"],setup(m,{emit:n}){const _=f(!1),t=f({}),b=f("Student"),k=f({}),p=f(["Student","Package","Subscription","Confirm"]),c=f("");m.item&&(t.value=m.item);const s=()=>{var o=new URLSearchParams;let u=JSON.parse(JSON.stringify(t.value)),C=Object.keys(u),w,D;for(let S=0;S<C.length;S++)w=C[S],D=typeof u[w]=="object"?JSON.stringify(u[w]):u[w],o.append("params["+w+"]",D);let W=u.subscription_id>0?"update":"create";o.append("type","PackageSubscription."+W),X(o,"/api/"+W).then(S=>{Z(S)})},x=()=>{n("callback")},d=()=>$(["name","description","single_cost_month","single_cost_querter","single_cost_year","double_cost_month","double_cost_quarter","double_cost_year","status"],t),T=o=>{let u=!!o.name.toLowerCase().includes(c.value.toLowerCase()),C=u||!!o.mobile.toLowerCase().includes(c.value.toLowerCase());return C||!!o.parent.name.toLowerCase().includes(c.value.toLowerCase())},B=o=>{t.value.model_id=o.student_id,t.value.model=o,t.value.user_type="student",b.value="Package",c.value=null},M=()=>{for(let o=0;o<m.allstudents.length;o++)m.allstudents[o].show=c.value.trim()?T(m.allstudents[o]):1},j=o=>{let u=!!o.name.toLowerCase().includes(c.value.toLowerCase());return u||!!o.description.toLowerCase().includes(c.value.toLowerCase())},G=o=>{t.value.package_id=o.package_id,t.value.package=o,b.value="Confirm",c.value=null},K=()=>{if(m.packages)for(let o=0;o<m.packages.length;o++)m.packages[o].show=c.value.trim()?j(m.packages[o]):1},H=o=>{t.value.payment_type=o,q()},q=()=>{if(!t.value.start_date)return null;let o=0;t.value.payment_type=="month"&&(o=1),t.value.payment_type=="quarter"&&(o=3),t.value.payment_type=="year"&&(o=12),t.value.end_date=tt(t.value.start_date,o)};return{dateChanged:q,setType:H,findPackage:K,checkSimilarPackage:j,setPackage:G,findStudent:M,setStudent:B,checkSimilarStudent:T,progressWidth:d,showEditSide:_,content:k,fillable:p,activeItem:t,activeTab:b,translate:J,savePackageSubscription:s,searchText:c,back:x}},props:["conf","path","system_setting","business_setting","setting","item","allstudents","packages"]},rt={class:"w-full flex overflow-auto"},_t={class:"w-full relative"},mt={class:"card w-full py-10"},ut={class:"w-full stepper stepper-links"},ht={class:"stepper-nav justify-content-center py-2 mb-10"},bt=["onClick"],xt=["textContent"],ft={class:"w-full"},pt={class:"text-center mb-13"},vt=["textContent"],gt=["textContent"],yt={class:"w-100 relative mb-5",autocomplete:"off"},kt=["placeholder"],Ct={class:"w-full students"},wt={class:"symbol symbol-35px symbol-circle me-5"},St=["src"],Tt={class:"fw-semibold w-full"},Pt=["textContent"],Lt=["textContent"],zt=["onClick","textContent"],It={class:"symbol symbol-35px symbol-circle me-5"},Et=["src"],jt={class:"fw-semibold w-full"},qt=["textContent"],Dt=["textContent"],Wt={class:"text-center"},At=["textContent"],Ot={class:"card-body pt-0"},Vt={class:"settings-form"},Rt={class:"max-w-xl mb-6 mx-auto row"},Nt={class:"text-center mb-13"},Ft=["textContent"],Jt=["textContent"],Ut={class:"w-100 relative mb-5",autocomplete:"off"},Bt=["placeholder"],Mt={class:"w-full"},Gt={class:"fw-semibold w-full"},Kt=["textContent"],Ht=["textContent"],Qt=["onClick","textContent"],Yt={class:"fw-semibold w-full"},Xt=["textContent"],Zt=["textContent"],$t={class:"text-center"},te=["textContent"],ee={class:"relative py-4 max-w-xl mx-auto"},se=["textContent"],ne={class:"fv-row fv-plugins-icon-container fv-plugins-bootstrap5-row-valid"},ae={class:"d-flex flex-stack mb-5 cursor-pointer"},oe={class:"d-flex align-items-center me-2"},le={class:"symbol symbol-50px me-6"},ie={class:"symbol-label bg-light-danger"},ce={class:"d-flex flex-column"},de=e("span",{class:"fw-bold fs-6"},"Double trips",-1),re=["textContent"],_e=e("span",{class:"form-check form-check-custom form-check-solid"},[e("input",{class:"form-check-input",type:"radio",name:"daily_trips",value:"2"})],-1),me={class:"d-flex flex-stack mb-5 cursor-pointer"},ue={class:"d-flex align-items-center me-2"},he={class:"symbol symbol-50px me-6"},be={class:"symbol-label bg-light-danger"},xe={class:"d-flex flex-column"},fe=e("span",{class:"fw-bold fs-6"},"Single trip",-1),pe=["textContent"],ve=e("span",{class:"form-check form-check-custom form-check-solid"},[e("input",{class:"form-check-input",type:"radio",name:"daily_trips",value:"1"})],-1),ge=e("div",{class:"fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback"},null,-1),ye={class:"card-body pt-0"},ke={class:"settings-form"},Ce={class:"max-w-xl mb-6 mx-auto row"},we=["textContent"],Se=["placeholder"],Te=e("hr",{class:"block my-2 opacity-10"},null,-1),Pe=["textContent"],Le=["placeholder"],ze=e("div",null,null,-1),Ie={class:"relative py-4"},Ee=["textContent"],je={class:"row"},qe=["checked"],De={class:"gap-6 btn btn-outline btn-outline-dashed btn-active-light-primary p-7 d-flex align-items-center mb-10"},We={class:"d-block fw-semibold text-start"},Ae=["textContent"],Oe=["textContent"],Ve=["checked"],Re={class:"gap-6 btn btn-outline btn-outline-dashed btn-active-light-primary p-7 d-flex align-items-center mb-10"},Ne={class:"d-block fw-semibold text-start"},Fe=["textContent"],Je=["textContent"],Ue=["checked"],Be={class:"gap-6 btn btn-outline btn-outline-dashed btn-active-light-primary p-7 d-flex align-items-center mb-10"},Me={class:"d-block fw-semibold text-start"},Ge=["textContent"],Ke=["textContent"],He={class:"relative py-4"},Qe=["textContent"],Ye=e("div",{class:"max-w-xl mx-auto"},null,-1),Xe={class:"text-center mt-10"},Ze=["textContent"],$e={class:"text-center mt-10"},ts=["textContent"];function es(m,n,_,t,b,k){const p=v("close_icon"),c=v("vue-feather");return l(),i("div",rt,[e("div",_t,[h(p,{class:"absolute top-4 right-4 z-10 cursor-pointer",onClick:t.back},null,8,["onClick"]),e("div",mt,[e("div",ut,[e("div",ht,[(l(!0),i(z,null,I(t.fillable,s=>(l(),i("div",{class:"stepper-item",onClick:x=>t.activeTab=s},[e("h3",{class:Y([t.activeTab==s?"text-danger border-danger":"text-gray-400 border-transparent","cursor-pointer pb-3 px-2 stepper-title text-md border-b"]),textContent:a(s)},null,10,xt)],8,bt))),256))]),e("div",ft,[t.activeTab=="Student"?(l(),i("div",{class:"",key:t.activeTab},[(l(),i("div",{class:"card-body pt-0 mx-auto max-w-xl",key:m.students},[e("div",pt,[e("h1",{class:"mb-3",textContent:a(t.translate("Find student"))},null,8,vt),e("div",{class:"text-gray-400 font-semibold",textContent:a(t.translate("Search by name, parent name or contact number"))},null,8,gt)]),e("div",yt,[h(c,{type:"search",class:"text-gray-500 position-absolute top-50 ms-5 translate-middle-y"}),P(e("input",{type:"text",onChange:n[0]||(n[0]=(...s)=>t.findStudent&&t.findStudent(...s)),"onUpdate:modelValue":n[1]||(n[1]=s=>t.searchText=s),class:"form-control form-control-lg form-control-solid px-15",placeholder:t.translate("Search by name, parent name")},null,40,kt),[[L,t.searchText]])]),t.searchText?(l(!0),i(z,{key:0},I(_.allstudents,s=>(l(),i("div",Ct,[s.show?(l(),i("a",{href:"javascript:;",key:s.show,class:"d-flex align-items-center p-3 bg-gray-100 rounded-lg shadow-md mb-1"},[e("div",wt,[e("img",{alt:"Pic",src:s.picture},null,8,St)]),e("div",Tt,[e("span",{class:"text-lg text-danger font-semibold me-2",textContent:a(s.name)},null,8,Pt),e("span",{class:"block text-gray-500 text-sm",textContent:a(s.mobile)},null,8,Lt)]),e("span",{onClick:x=>t.setStudent(s),class:"btn btn-danger btn-sm text-white",textContent:a(t.translate("Choose"))},null,8,zt)])):r("",!0)]))),256)):r("",!0),t.activeItem.model?(l(),i("a",{href:"javascript:;",key:t.activeItem.model,class:"d-flex align-items-center p-3 bg-gray-100 rounded-lg shadow-md mb-1"},[e("div",It,[e("img",{alt:"Pic",src:t.activeItem.model.picture},null,8,Et)]),e("div",jt,[e("span",{class:"text-lg text-danger font-semibold me-2",textContent:a(t.activeItem.model.name)},null,8,qt),e("span",{class:"block text-gray-500 text-sm",textContent:a(t.activeItem.model.mobile)},null,8,Dt)])])):r("",!0)])),e("p",Wt,[e("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:n[2]||(n[2]=s=>t.activeTab="Pickup location"),textContent:a(t.translate("Pickup location"))},null,8,At)])])):r("",!0),t.activeTab=="Package"?(l(),i("div",{class:"",key:t.activeTab},[e("div",Ot,[e("div",Vt,[e("div",Rt,[(l(),i("div",{class:"card-body pt-0 mx-auto max-w-xl",key:_.packages},[e("div",Nt,[e("h1",{class:"mb-3",textContent:a(t.translate("Find Package"))},null,8,Ft),e("div",{class:"text-gray-400 font-semibold",textContent:a(t.translate("Search by name or description"))},null,8,Jt)]),e("div",Ut,[h(c,{type:"search",class:"text-gray-500 position-absolute top-50 ms-5 translate-middle-y"}),P(e("input",{type:"text",onChange:n[3]||(n[3]=(...s)=>t.findPackage&&t.findPackage(...s)),"onUpdate:modelValue":n[4]||(n[4]=s=>t.searchText=s),class:"form-control form-control-lg form-control-solid px-15",placeholder:t.translate("Search by name, parent name")},null,40,Bt),[[L,t.searchText]])]),t.searchText?(l(!0),i(z,{key:0},I(_.packages,s=>(l(),i("div",Mt,[s&&s.show?(l(),i("a",{href:"javascript:;",key:s.show,class:"d-flex align-items-center p-3 bg-gray-100 rounded-lg shadow-md mb-1"},[e("div",Gt,[e("span",{class:"text-lg text-danger font-semibold me-2",textContent:a(s.name)},null,8,Kt),e("span",{class:"block text-gray-500 text-sm",textContent:a(s.description)},null,8,Ht)]),e("span",{onClick:x=>t.setPackage(s),class:"btn btn-danger btn-sm text-white",textContent:a(t.translate("Choose"))},null,8,Qt)])):r("",!0)]))),256)):r("",!0),t.activeItem.package?(l(),i("a",{href:"javascript:;",key:t.activeItem.package,class:"d-flex align-items-center p-3 bg-gray-100 rounded-lg shadow-md mb-1 gap-4"},[h(c,{type:"map",class:"w-3"}),e("div",Yt,[e("span",{class:"text-lg text-danger font-semibold me-2",textContent:a(t.activeItem.package.name)},null,8,Xt),e("span",{class:"block text-gray-500 text-sm truncate",textContent:a(t.activeItem.package.description)},null,8,Zt)])])):r("",!0)]))])])]),e("p",$t,[e("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:n[5]||(n[5]=s=>t.activeTab="Subscription"),textContent:a(t.translate("Subscription"))},null,8,te)])])):r("",!0),t.activeTab=="Subscription"?(l(),i("div",{class:"mx-auto max-w-4xl",key:t.activeTab},[e("div",ee,[e("label",{class:"nui-label w-full pb-2 block font-semibold text-lg",textContent:a(t.translate("Route type"))},null,8,se),e("div",ne,[e("label",ae,[e("span",oe,[e("span",le,[e("span",ie,[h(c,{type:"map-pin"})])]),e("span",ce,[de,e("span",{class:"fs-7 text-muted",textContent:a(t.translate("Two trips per day going & back"))},null,8,re)])]),_e]),e("label",me,[e("span",ue,[e("span",he,[e("span",be,[h(c,{type:"map-pin"})])]),e("span",xe,[fe,e("span",{class:"fs-7 text-muted",textContent:a(t.translate("One trip per day going"))},null,8,pe)])]),ve]),ge,e("div",ye,[e("div",ke,[e("div",Ce,[e("label",{class:"col-lg-4 col-form-label required font-semibold fs-6",textContent:a(t.translate("Start date"))},null,8,we),P(e("input",{onChange:n[6]||(n[6]=(...s)=>t.dateChanged&&t.dateChanged(...s)),required:!0,autocomplete:"off",name:"params[start_date]",class:"form-control form-control-solid",placeholder:t.translate("Start date"),type:"date","onUpdate:modelValue":n[7]||(n[7]=s=>t.activeItem.start_date=s)},null,40,Se),[[L,t.activeItem.start_date]]),Te,e("label",{class:"col-lg-4 col-form-label required font-semibold fs-6",textContent:a(t.translate("End date"))},null,8,Pe),P(e("input",{required:!0,autocomplete:"off",disabled:!0,name:"params[end_date]",class:"form-control form-control-solid",placeholder:t.translate("End date"),type:"date","onUpdate:modelValue":n[8]||(n[8]=s=>t.activeItem.end_date=s)},null,8,Le),[[L,t.activeItem.end_date]])])])]),ze])]),e("div",Ie,[e("label",{class:"nui-label w-full pb-2 block font-semibold text-lg",textContent:a(t.translate("Subscription duration"))},null,8,Ee),e("div",je,[e("div",{class:"col-lg-4",onClick:n[9]||(n[9]=s=>t.setType("month"))},[e("input",{type:"radio",class:"btn-check",value:"month",checked:t.activeItem.payment_type=="month",name:"payment_type"},null,8,qe),e("label",De,[h(c,{type:"server"}),e("span",We,[e("span",{class:"text-gray-900 fw-bold d-block fs-4 mb-2",textContent:a(t.translate("Month"))},null,8,Ae),e("span",{class:"text-muted fw-semibold fs-6",textContent:a(t.translate("Subscribe for month"))},null,8,Oe)])])]),e("div",{class:"col-lg-4",onClick:n[10]||(n[10]=s=>t.setType("quarter"))},[e("input",{type:"radio",class:"btn-check",value:"quarter",checked:t.activeItem.payment_type=="quarter",name:"payment_type"},null,8,Ve),e("label",Re,[h(c,{type:"server"}),e("span",Ne,[e("span",{class:"text-gray-900 fw-bold d-block fs-4 mb-2",textContent:a(t.translate("Quarter"))},null,8,Fe),e("span",{class:"text-muted fw-semibold fs-6",textContent:a(t.translate("Subscribe for quarter"))},null,8,Je)])])]),e("div",{class:"col-lg-4",onClick:n[11]||(n[11]=s=>t.setType("year"))},[e("input",{type:"radio",class:"btn-check",value:"year",checked:t.activeItem.payment_type=="year",name:"payment_type"},null,8,Ue),e("label",Be,[h(c,{type:"server"}),e("span",Me,[e("span",{class:"text-gray-900 fw-bold d-block fs-4 mb-2",textContent:a(t.translate("Year"))},null,8,Ge),e("span",{class:"text-muted fw-semibold fs-6",textContent:a(t.translate("Subscribe for year"))},null,8,Ke)])])])])]),e("div",He,[e("label",{class:"nui-label w-full pb-2 block font-semibold text-lg",textContent:a(t.translate("Start Date"))},null,8,Qe),Ye]),e("p",Xe,[e("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:n[12]||(n[12]=s=>t.activeTab="Confirm"),textContent:a(t.translate("Next"))},null,8,Ze)])])):r("",!0),t.activeTab=="Confirm"?(l(),i("div",{class:"w-full mx-auto",key:t.activeTab},[e("p",$e,[e("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:n[13]||(n[13]=(...s)=>t.savePackageSubscription&&t.savePackageSubscription(...s)),textContent:a(t.translate("Submit"))},null,8,ts)])])):r("",!0)])])])])])}const ss=O(dt,[["render",es]]),ns=g(()=>y(()=>import("./map-XRH7L8ya.min.js"),__vite__mapDeps([0,1,2,3]))),as=g(()=>y(()=>import("./form_field-67i-FqgB.min.js"),__vite__mapDeps([8,2,3,5,6,9,1]))),os={components:{datatabble:V,maps:ns,delete_icon:R,car_icon:N,route_icon:F,form_field:as,editable_map_location:U,student_subscription_wizard:ss,employee_location_wizard:at},name:"Routes",setup(m){const n=m.conf.url+m.path+"?load=json",_=f({}),t=f({}),b=f(!1),k=()=>{b.value=!1};return(()=>{et(n).then(x=>{t.value=JSON.parse(JSON.stringify(x))})})(),{url:n,content:t,activeItem:_,translate:J,showWizard:b,closeSide:k,addLocationWizard:()=>{_.value={},b.value=!0},handleAction:(x,d)=>{switch(x){case"view":break;case"edit":_.value=d,b.value=!0;break;case"delete":st("location_id",d,"RouteLocation.delete");break;case"close":showEditSide.value=!1,_.value={};break}}}},props:["path","lang","system_setting","business_setting","setting","conf","auth"]},ls={class:"w-full flex overflow-auto"},is={key:0,class:"w-full relative"},cs={key:1,class:""},ds={class:"card"},rs={class:"card-body"},_s={class:"card-px text-center pt-15 pb-15"},ms=["textContent"],us=["textContent"],hs=["textContent"],bs={class:"text-center pb-15 px-5"},xs=["src"],fs={key:2,class:"flex-1 overflow-x-hidden overflow-y-auto w-full relative"},ps={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},vs=["textContent"],gs=["textContent"],ys=e("hr",{class:"mt-2"},null,-1),ks={class:"w-full bg-white"},Cs={key:0,class:"w-full flex gap-4"},ws=["src"],Ss=["textContent"],Ts=["onClick"],Ps=["onClick"];function Ls(m,n,_,t,b,k){const p=v("student_subscription_wizard"),c=v("vue-feather"),s=v("delete_icon"),x=v("datatabble");return l(),i("div",ls,[t.content&&_.auth?(l(),i("div",is,[t.showWizard&&_.auth.business&&_.auth.business.type=="school"?(l(),A(p,{onCallback:n[0]||(n[0]=d=>t.showWizard=!1),packages:t.content.packages,allstudents:t.content.students,key:t.showWizard,system_setting:_.system_setting,item:t.activeItem,business_setting:_.business_setting},null,8,["packages","allstudents","system_setting","item","business_setting"])):r("",!0),!t.showWizard&&t.content.items&&!t.content.items.length?(l(),i("div",cs,[e("div",ds,[e("div",rs,[e("div",_s,[e("h2",{class:"fs-2x fw-bold mb-0",textContent:a(t.content.title)},null,8,ms),e("p",{class:"text-gray-400 fs-4 font-semibold py-7",textContent:a(t.translate("Add your first pickup using this below wizard"))},null,8,us),e("a",{textContent:a(t.translate("add_new")),onClick:n[1]||(n[1]=(...d)=>t.addLocationWizard&&t.addLocationWizard(...d)),href:"javascript:;",class:"text-white btn btn-primary er fs-6 px-8 py-4"},null,8,hs)]),e("div",bs,[e("img",{src:"/src/asset/img/1.png",alt:"",class:"mx-auto mw-100 h-200px h-sm-325px"},null,8,xs)])])])])):r("",!0),t.content.items&&t.content.items.length&&!t.showWizard?(l(),i("main",fs,[e("div",ps,[e("h1",{class:"font-bold text-lg w-full",textContent:a(t.content.title)},null,8,vs),t.showWizard?r("",!0):(l(),i("a",{key:0,href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg bg-danger",onClick:n[2]||(n[2]=(...d)=>t.addLocationWizard&&t.addLocationWizard(...d)),textContent:a(t.translate("add_new"))},null,8,gs))]),ys,e("div",ks,[t.content.columns?(l(),A(x,{key:0,class:"align-middle fs-6 gy-5 table table-row-dashed px-6","body-text-direction":t.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:t.content.columns,items:t.content.items},{"item-name":E(d=>[d.model?(l(),i("div",Cs,[e("img",{src:d.model.picture,class:"w-8 h-8 rounded-full"},null,8,ws),e("span",{textContent:a(d.model.name)},null,8,Ss)])):r("",!0)]),"item-edit":E(d=>[d.not_editable?r("",!0):(l(),i("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:T=>t.handleAction("edit",d)},[h(c,{class:"w-5",type:"edit"})],8,Ts))]),"item-delete":E(d=>[d.not_removeable?r("",!0):(l(),i("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:T=>t.handleAction("delete",d)},[h(s,{class:"w-5"})],8,Ps))]),_:1},8,["body-text-direction","headers","items"])):r("",!0)])])):r("",!0)])):r("",!0)])}const Ws=O(os,[["render",Ls]]);export{Ws as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-XRH7L8ya.min.js","index.es-08gBEiIi.min.js","index.min.js","index.min.css","side-form-create-H9wI8WKg.min.js","Field-I8Ovvng_.min.js","Field.min.css","side-form-update-04MNAfTa.min.js","form_field-67i-FqgB.min.js","editable_map_location-V2kNDwZy.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
