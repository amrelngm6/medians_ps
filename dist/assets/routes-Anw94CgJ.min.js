import{_ as U,D as q,e as K,y as H,z as Q,f as n,t as W,r as v,o as s,c as d,i,j as F,g as A,A as w,F as X,B,h as u,k as Y,a as I,d as L,b as E,m as Z,s as $,p as ee}from"./index.min.js";const te=L(()=>E(()=>import("./map-HM6As7_u.min.js"),__vite__mapDeps([0,1,2,3]))),oe=L(()=>E(()=>import("./side-form-create-NIS6SyYA.min.js"),__vite__mapDeps([4,2,3,5,6]))),le=L(()=>E(()=>import("./side-form-update-48PDxxs4.min.js"),__vite__mapDeps([7,2,3,5,6,8]))),ae={components:{datatabble:q,SideFormCreate:oe,SideFormUpdate:le,maps:te,delete_icon:K,car_icon:H,route_icon:Q},name:"Routes",setup(f){const g=f.conf.url+f.path+"?load=json",_=n(!1),t=n(!1),x=n(null),p=n({}),c=n({}),k=n({});n([]),n(!0);const m=n(""),y=n(null),C=n(!1),S=()=>{_.value=!1,t.value=!1};(()=>{Z(g).then(e=>{c.value=JSON.parse(JSON.stringify(e)),h()})})();const r=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{k.value={lat:e.coords.latitude,lng:e.coords.longitude}},e=>{$(e.message,5e3)}):y.value="Geolocation is not supported by this browser."};r();const h=()=>{for(let e=0;e<c.value.items.length;e++)c.value.items[e].active=m.value.trim()?D(c.value.items[e]):1},D=e=>{let o=!!e.route_name.toLowerCase().includes(m.value.toLowerCase());return o||!!e.description.toLowerCase().includes(m.toLowerCase())},T=(e,o)=>{p.value=e;for(let a=0;a<c.value.items.length;a++)c.value.items[a].selected=!1;c.value.items[o].selected=!0,R.value=P(e)},M=(e,o,a)=>{},N=(e,o,a)=>{},P=e=>{let o,a=[],j=f.conf.url+"uploads/images/blue_pin.gif",z=f.conf.url+"uploads/images/car.svg",G=f.conf.url+"uploads/images/destination.svg";for(let b=0;b<e.pickup_locations.length;b++)o=e.pickup_locations[b],a[b]={title:o.student_name,icon:j,origin:{lat:parseFloat(o.latitude),lng:parseFloat(o.longitude)},destination:{lat:parseFloat(o.latitude),lng:parseFloat(o.longitude)}};let V={icon:z,origin:{lat:parseFloat(e.vehicle.last_latitude),lng:parseFloat(e.vehicle.last_longitude)},destination:{lat:parseFloat(e.vehicle.last_latitude),lng:parseFloat(e.vehicle.last_longitude)}};a[a.length]=V;let J={drag:!0,icon:G,origin:V.origin,destination:{lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)}};return a[a.length]=J,k.value=a[0].destination,a},O=(e,o)=>{switch(e){case"view":break;case"edit":p.value=o,_.value=!1,t.value=!0,x.value=!0;break;case"delete":ee("driver_id",o,"Driver.delete");break;case"close":t.value=!1,_.value=!1,x.value=!1,p.value={};break}},R=n([]);return{showAddSide:_,waypoints:R,showEditSide:t,url:g,content:c,center:k,activeItem:p,translate:W,setLocationsPickups:P,clickMarker:N,updateMarker:M,setLocationsMarkers:T,checkSimilar:D,searchTextChanged:h,searchText:m,getUserLocation:r,collapsed:C,closeSide:S,handleAction:O}},props:["path","lang","setting","conf","auth"]},ne={class:"w-full flex overflow-auto"},se={key:0,class:"w-full relative"},ce={class:"flex-1 overflow-x-hidden overflow-y-auto w-full relative"},ie={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},re=["textContent"],de=i("hr",{class:"mt-2"},null,-1),ue={class:"w-full"},_e=["src"],fe={class:"w-full h-8 relative flex"},me=["src"],he=["textContent"],ve=["onClick"],ge=["onClick"];function pe(f,g,_,t,x,p){const c=v("route_icon"),k=v("vue-feather"),m=v("delete_icon"),y=v("datatabble"),C=v("side-form-create"),S=v("side-form-update");return s(),d("div",ne,[t.content?(s(),d("div",se,[i("main",ce,[i("div",ie,[i("h1",{class:"font-bold text-lg w-full",textContent:F(t.content.title)},null,8,re),i("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg bg-danger",onClick:g[0]||(g[0]=l=>{t.showAddSide=!0,t.activeItem={}})},F(t.translate("add_new")),1)]),de,i("div",ue,[t.content.columns?(s(),A(y,{key:0,class:"align-middle fs-6 gy-5 table table-row-dashed px-6","body-text-direction":t.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:t.content.columns,items:t.content.items},{"item-picture":w(l=>[i("img",{src:l.picture,class:"w-8 h-8 rounded-full"},null,8,_e)]),"item-pickup_locations":w(l=>[i("div",fe,[(s(!0),d(X,null,Y(l.pickup_locations,(r,h)=>(s(),d("div",{style:B("left: "+20*h+"px"),class:"rounded-full w-8 h-8 left-0 top-0 absolute"},[h<3?(s(),d("img",{key:h,class:"rounded-full w-8 h-8 rounded-[50px] border-2 border-purple-800",src:r.student&&r.student.picture?r.student.picture:"https://via.placeholder.com/37x37"},null,8,me)):u("",!0)],4))),256)),i("span",{class:"flex absolute pt-2",style:B("left: "+(20*(l.pickup_locations.length<3?l.pickup_locations.length:3)+20)+"px")},[I(c),l.pickup_locations?(s(),d("span",{key:0,class:"font-semibold px-1",textContent:F(l.pickup_locations.length)},null,8,he)):u("",!0)],4)])]),"item-edit":w(l=>[l.not_editable?u("",!0):(s(),d("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:r=>t.handleAction("edit",l)},[I(k,{class:"w-5",type:"edit"})],8,ve))]),"item-delete":w(l=>[l.not_removeable?u("",!0):(s(),d("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:r=>t.handleAction("delete",l)},[I(m,{class:"w-5"})],8,ge))]),_:1},8,["body-text-direction","headers","items"])):u("",!0),t.showAddSide&&t.content&&t.content.fillable?(s(),A(C,{key:1,onCallback:t.closeSide,conf:_.conf,model:"Routes.create",columns:t.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","columns"])):u("",!0),t.showEditSide&&!t.showAddSide?(s(),A(S,{onCallback:t.closeSide,key:t.activeItem,conf:_.conf,model:"Routes.update",item:t.activeItem,model_id:t.activeItem.route_id,index:"route_id",columns:t.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","item","model_id","columns"])):u("",!0)])])])):u("",!0)])}const be=U(ae,[["render",pe]]);export{be as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-HM6As7_u.min.js","index.es-WpGh2aN7.min.js","index.min.js","index.min.css","side-form-create-NIS6SyYA.min.js","Field-jfbwrnKR.min.js","Field.min.css","side-form-update-48PDxxs4.min.js","form_field-QYJuJC7Z.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}