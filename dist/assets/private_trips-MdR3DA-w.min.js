import{_ as K,D as U,e as H,y as Q,z as X,f as d,t as Y,r as f,o as c,c as y,g as w,h as u,i as h,j as V,A as F,a as B,d as W,b as x,m as Z,s as $,p as ee}from"./index.min.js";const te=W(()=>x(()=>import("./map-OGlwx9xa.min.js"),__vite__mapDeps([0,1,2,3]))),se=W(()=>x(()=>import("./trip_page-o4OZqEmS.min.js"),__vite__mapDeps([4,2,3,5,1]))),ne=W(()=>x(()=>import("./usertype_picker-iazfrFKo.min.js"),__vite__mapDeps([6,2,3]))),ae={components:{datatabble:U,maps:te,delete_icon:H,car_icon:Q,route_icon:X,trip_page:se,usertype_picker:ne},name:"Destinations",setup(s){const l=s.conf.url+s.path+"?load=json",b=d(null),t=d({}),i=d({}),k=d({}),_=d([]),v=d(""),C=d(!1),p=d(!1),I=()=>{};(()=>{Z(l).then(e=>{i.value=JSON.parse(JSON.stringify(e)),z(i.value.items),O()})})();const z=e=>{for(let n=0;n<e.length;n++)j(e[n])},N=(e,n)=>{t.value=e;for(let r=0;r<i.value.items.length;r++)i.value.items[r].selected=!1;i.value.items[n].selected=!0;let o,g,M=s.conf.url+"uploads/images/yellow_pin.gif",J=s.conf.url+"uploads/images/blue_pin.gif",q=s.conf.url+"uploads/images/car.svg",G=s.conf.url+"uploads/images/destination.svg",m=[],E={lat:parseFloat(e.vehicle.last_latitude),lng:parseFloat(e.vehicle.last_longitude)};m[0]={drag:!0,status:"waiting",icon:q,origin:E,destination:E};for(let r=0;r<e.pickup_locations.length;r++)o=e.pickup_locations[r],g=r?e.pickup_locations[r-1].location:o.location,m[r+1]={status:o.status,icon:o.status=="waiting"?J:M,origin:{lat:parseFloat(g.latitude),lng:parseFloat(g.longitude)},destination:{lat:parseFloat(o.location.latitude),lng:parseFloat(o.location.longitude)}};return m[m.length]={drag:!0,icon:G,origin:{lat:0,lng:0},destination:{lat:parseFloat(e.route.latitude),lng:parseFloat(e.route.longitude)}},k.value=m[0].destination,_.value=m,m},A=async()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{k.value={lat:e.coords.latitude,lng:e.coords.longitude}},e=>{$(e.message,5e3)})};A();const O=()=>{for(let e=0;e<i.value.items.length;e++)i.value.items[e].active=v.value.trim()?D(i.value.items[e]):1},D=e=>{let n=!!e.student_name.toLowerCase().includes(v.value.toLowerCase());return n||!!e.location_name.toLowerCase().includes(v.toLowerCase())},P=e=>{t.value=e,L("edit",e)},S=(e,n,o)=>{t.value=o,t.value.latitude=o.destination.lat,t.value.longitude=o.destination.lng,L("edit",t.value)},j=e=>(e.icon=s.conf.url+"uploads/images/blue_pin.gif",e.origin=e.destination={lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)},e.drag=!0,e),L=(e,n)=>{switch(e){case"view":break;case"edit":T(n,!0);break;case"delete":ee("destination_id",n,"Destination.delete");break}},R=(e,n)=>{let o=[];for(let g=0;g<e.length;g++)e[g].status==n;return o},T=(e,n=!0)=>{p.value=n,t.value=e};return{setType:e=>{t.value.usertype=e,showOptions.value=!1,showWizard.value=!0},editFields:T,showTrip:p,activeTrip:b,locations:_,url:l,content:i,center:k,activeItem:t,callback:()=>{T(null,!1),p.value=!1},filterLocations:R,translate:Y,clickMarker:S,updateMarker:P,setLocationsMarkers:N,checkSimilar:D,searchTextChanged:O,searchText:v,getUserLocation:A,collapsed:C,closeSide:I,handleAction:L}},props:["path","lang","setting","conf","auth"]},oe={class:"w-full flex overflow-auto"},le={key:4,class:"w-full relative"},ie={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},re=["textContent"],ce=["textContent"],ue=h("hr",{class:"mt-2"},null,-1),de={class:"w-full bg-white"},ge=["src"],me=["onClick"],_e=["onClick"];function ve(s,l,b,t,i,k){const _=f("subscription_wizard"),v=f("usertype_picker"),C=f("vue-feather"),p=f("delete_icon"),I=f("datatabble");return c(),y("div",oe,[s.showWizard&&t.activeItem.usertype=="employee"?(c(),w(_,{onCallback:l[0]||(l[0]=a=>s.showWizard=!1),usertype:t.activeItem.usertype,userslist:t.content.employees,key:s.showWizard,packages:t.content.packages,system_setting:s.system_setting,item:t.activeItem,business_setting:s.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):u("",!0),s.showWizard&&t.activeItem.usertype=="supervisor"?(c(),w(_,{onCallback:l[1]||(l[1]=a=>s.showWizard=!1),usertype:t.activeItem.usertype,userslist:t.content.supervisors,key:s.showWizard,packages:t.content.packages,system_setting:s.system_setting,item:t.activeItem,business_setting:s.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):u("",!0),s.showWizard&&t.activeItem.usertype=="student"?(c(),w(_,{onCallback:l[2]||(l[2]=a=>s.showWizard=!1),usertype:t.activeItem.usertype,userslist:t.content.students,key:s.showWizard,packages:t.content.packages,system_setting:s.system_setting,item:t.activeItem,business_setting:s.business_setting},null,8,["usertype","userslist","packages","system_setting","item","business_setting"])):u("",!0),!s.showWizard&&s.showOptions?(c(),w(v,{key:s.showOptions,auth:b.auth,item:t.activeItem,onCallback:t.setType},null,8,["auth","item","onCallback"])):u("",!0),t.content&&!t.showTrip?(c(),y("div",le,[t.content?(c(),y("main",{key:t.content.items,class:"flex-1 overflow-x-hidden overflow-y-auto w-full"},[h("div",ie,[h("h1",{class:"font-bold text-lg w-full",textContent:V(t.content.title)},null,8,re),h("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg bg-danger",onClick:l[3]||(l[3]=a=>s.showOptions=!0),textContent:V(t.translate("add_new"))},null,8,ce)]),ue,h("div",de,[t.content.columns?(c(),w(I,{key:0,class:"align-middle fs-6 gy-5 table table-row-dashed px-6","body-text-direction":t.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:t.content.columns,items:t.content.items},{"item-picture":F(a=>[h("img",{src:a.picture,class:"w-8 h-8 rounded-full"},null,8,ge)]),"item-details":F(a=>[a.not_editable?u("",!0):(c(),y("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:z=>t.handleAction("edit",a)},[B(C,{class:"w-5",type:"edit"})],8,me))]),"item-delete":F(a=>[a.not_removeable?u("",!0):(c(),y("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:z=>t.handleAction("delete",a)},[B(p,{class:"w-5"})],8,_e))]),_:1},8,["body-text-direction","headers","items"])):u("",!0)])])):u("",!0)])):u("",!0)])}const ye=K(ae,[["render",ve]]);export{ye as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-OGlwx9xa.min.js","index.es-4z_hVD90.min.js","index.min.js","index.min.css","trip_page-o4OZqEmS.min.js","help-QMf3rqBc.min.js","usertype_picker-iazfrFKo.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
