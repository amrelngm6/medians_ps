import{_ as F,r as o,U as N,a as h,o as d,c as C,y as x,O as w,g as B,F as $,f as z,d as O,b as G,ai as L,m as R}from"./index.min.js";import{O as U,L as j,j as D}from"./index.es-BqyRJkQ3.min.js";const E={components:{GoogleMap:U,Polyline:j,CustomMarker:D},emits:["markerclicked"],setup(r,{emit:y}){const c=o(null),e=o(null),f=o(12),i=o([]),p=o([]),u=o([]),g=o({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),t=o(r.trip),_=(a,n="lat",s="lng",v)=>{let l=JSON.parse(JSON.stringify(a));return l.icon=r.conf.url+"uploads/images/"+v,l.marker_position={lat:parseFloat(a[n]),lng:parseFloat(a[s])},l.drag=!1,l};(()=>{i.value=[_(t.value,"pickup_latitude","pickup_longitude","car.svg")],i.value[i.value.length]=_(t.value,"destination_latitude","destination_longitude","destination.svg")})();const m=o({lat:0,lng:0}),k=o({lat:0,lng:0}),P=a=>{console.log(c.value),R.get(a,{params:{origin:"30.059211362739,31.221850700676",destination:"30.033575780575,31.474631465971",key:r.system_setting.google_map_api}}).then(n=>{console.log(n)}).catch(n=>{console.log(n)})},V=async()=>{const n=`https://maps.googleapis.com/maps/api/directions/json?origin=${m.value.lat},${m.value.lng}&destination=${k.value.lat},${k.value.lng}&key=${r.system_setting.google_map_api}`;P(n);try{const s=await fetch(n);if(s.ok){const v=await s.json(),l=L(v.routes[0].overview_polyline.points);u.value=l,p.value={path:l,geodesic:!0,strokeColor:"#000",strokeOpacity:.9,strokeWeight:2}}else console.error("Failed to fetch route:",s.statusText)}catch(s){console.error("Error fetching route:",s)}};return N(()=>{m.value={lat:t.value.pickup_latitude,lng:t.value.pickup_longitude},e.value=m.value,k.value={lat:t.value.destination_latitude,lng:t.value.destination_longitude},V()}),{mapRef:c,markerClicked:a=>{y("markerclicked",a)},markers:i,mapCenter:e,mapZoom:f,polylinePath:p,routeCoordinates:u,polylineOptions:g}},props:["system_setting","trip","conf"]},J={class:"w-full overflow-auto"},S={style:{"text-align":"center"}},T=["src"];function W(r,y,c,e,f,i){const p=h("Polyline"),u=h("CustomMarker"),g=h("GoogleMap");return d(),C("div",J,[e.mapCenter?(d(),x(g,{"api-key":c.system_setting.google_map_api,ref:"mapRef",center:e.mapCenter,key:`${e.mapCenter.lat},${e.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:e.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:w(()=>[B(p,{options:e.polylinePath},null,8,["options"]),(d(!0),C($,null,z(e.markers,(t,_)=>(d(),x(u,{options:{position:t.marker_position},onClick:M=>e.markerClicked(t)},{default:w(()=>[O("div",S,[O("img",{src:t.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,T)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):G("",!0)])}const q=F(E,[["render",W]]);export{q as t};
