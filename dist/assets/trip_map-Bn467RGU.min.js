import{_ as F,r as a,U as N,a as h,o as m,c as C,y as x,O as w,g as B,F as $,f as j,d as O,b as z,ai as G,m as L}from"./index.min.js";import{O as R,L as U,j as D}from"./index.es-BqyRJkQ3.min.js";const E={components:{GoogleMap:R,Polyline:U,CustomMarker:D},emits:["markerclicked"],setup(l,{emit:y}){const i=a(null),e=a(null),f=a(12),r=a([]),c=a([]),p=a([]),d=a({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),t=a(l.trip),g=(o,k="lat",n="lng",v)=>{let s=JSON.parse(JSON.stringify(o));return s.icon=l.conf.url+"uploads/images/"+v,s.marker_position={lat:parseFloat(o[k]),lng:parseFloat(o[n])},s.drag=!1,s};(()=>{r.value=[g(t.value,"pickup_latitude","pickup_longitude","car.svg")],r.value[r.value.length]=g(t.value,"destination_latitude","destination_longitude","destination.svg")})();const u=a({lat:0,lng:0}),_=a({lat:0,lng:0}),P=()=>{console.log(i.value),L.get("/maps/api/directions/json",{params:{origin:"30.059211362739,31.221850700676",destination:"30.033575780575,31.474631465971",key:l.system_setting.google_map_api}}).then(o=>{console.log(o)}).catch(o=>{console.log(o)})},V=async()=>{P();const k=`https://maps.googleapis.com/maps/api/directions/json?origin=${u.value.lat},${u.value.lng}&destination=${_.value.lat},${_.value.lng}&key=${l.system_setting.google_map_api}`;try{const n=await fetch(k);if(n.ok){const v=await n.json(),s=G(v.routes[0].overview_polyline.points);p.value=s,c.value={path:s,geodesic:!0,strokeColor:"#000",strokeOpacity:.9,strokeWeight:2}}else console.error("Failed to fetch route:",n.statusText)}catch(n){console.error("Error fetching route:",n)}};return N(()=>{u.value={lat:t.value.pickup_latitude,lng:t.value.pickup_longitude},e.value=u.value,_.value={lat:t.value.destination_latitude,lng:t.value.destination_longitude},V()}),{mapRef:i,markerClicked:o=>{y("markerclicked",o)},markers:r,mapCenter:e,mapZoom:f,polylinePath:c,routeCoordinates:p,polylineOptions:d}},props:["system_setting","trip","conf"]},J={class:"w-full overflow-auto"},S={style:{"text-align":"center"}},T=["src"];function W(l,y,i,e,f,r){const c=h("Polyline"),p=h("CustomMarker"),d=h("GoogleMap");return m(),C("div",J,[e.mapCenter?(m(),x(d,{"api-key":i.system_setting.google_map_api,ref:"mapRef",center:e.mapCenter,key:`${e.mapCenter.lat},${e.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:e.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:w(()=>[B(c,{options:e.polylinePath},null,8,["options"]),(m(!0),C($,null,j(e.markers,(t,g)=>(m(),x(p,{options:{position:t.marker_position},onClick:M=>e.markerClicked(t)},{default:w(()=>[O("div",S,[O("img",{src:t.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,T)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):z("",!0)])}const q=F(E,[["render",W]]);export{q as t};
