import{_ as F,r as o,U as G,a as y,o as m,c as x,y as M,O,g as L,F as S,f as T,d as V,b as z}from"./index.min.js";import{O as I,L as E,j as J}from"./index.es-BqyRJkQ3.min.js";const W={components:{GoogleMap:I,Polyline:E,CustomMarker:J},emits:["markerclicked"],setup(_,{emit:k}){const i=o(null),t=o(null),h=o(12),s=o([]),c=o([]),u=o([]),v=o({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),n=o(_.route),d=(e,l="lat",g="lng",r)=>{let a=JSON.parse(JSON.stringify(e));return a.icon=_.conf.url+"uploads/images/"+r,a.marker_position={lat:parseFloat(e[l]),lng:parseFloat(e[g])},a.drag=!1,a};(()=>{s.value=[d(n.value.position,"start_latitude","start_longitude","car.svg")];let e=n.value.route_locations;if(e&&e.length)for(let l=0;l<e.length;l++)s.value[l+1]=d(e[l],"start_latitude","start_longitude","yellow_pin.gif");s.value[s.value.length]=d(n.value.position,"end_latitude","end_longitude","destination.svg")})();const C=o({lat:0,lng:0}),f=o({lat:0,lng:0}),w=o(null),p=o(null),B=()=>{setTimeout(function(){w.value=new window.google.maps.DirectionsService,p.value=new window.google.maps.DirectionsRenderer({draggable:!0,map:i,panel:document.getElementById("panel")}),p.value.addListener("directions_changed",()=>{p.value.getDirections()}),D(C.value,f.value,w.value,p.value)},1e3)},D=(e,l,g,r)=>{g.route({origin:e,destination:l,travelMode:window.google.maps.TravelMode.DRIVING,avoidTolls:!0}).then(a=>{console.log(a);const P=R(a);u.value=P,c.value={path:P,geodesic:!0,strokeColor:"#000",strokeOpacity:.9,strokeWeight:2}}).catch(a=>{alert("Could not display directions due to: "+a)})},R=e=>{const l=e.routes[0].overview_polyline;return window.google.maps.geometry.encoding.decodePath(l).map(r=>({lat:r.lat(),lng:r.lng()}))};return G(()=>{t.value={lat:n.value.position.start_latitude,lng:n.value.position.start_longitude},C.value=t.value,f.value={lat:n.value.position.end_latitude,lng:n.value.position.end_longitude},B()}),{markerClicked:e=>{k("markerclicked",e)},map:i,markers:s,mapCenter:t,mapZoom:h,polylinePath:c,routeCoordinates:u,polylineOptions:v}},props:["system_setting","route","conf"]},Z={class:"w-full overflow-auto"},U={style:{"text-align":"center"}},b=["src"];function j(_,k,i,t,h,s){const c=y("Polyline"),u=y("CustomMarker"),v=y("GoogleMap");return m(),x("div",Z,[t.mapCenter?(m(),M(v,{"api-key":i.system_setting.google_map_api,ref:"map",center:t.mapCenter,key:`${t.mapCenter.lat},${t.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:t.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:O(()=>[L(c,{options:t.polylinePath},null,8,["options"]),(m(!0),x(S,null,T(t.markers,(n,d)=>(m(),M(u,{options:{position:n.marker_position},onClick:N=>t.markerClicked(n)},{default:O(()=>[V("div",U,[V("img",{src:n.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,b)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):z("",!0)])}const K=F(W,[["render",j]]);export{K as r};
