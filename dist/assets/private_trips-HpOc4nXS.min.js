import{_ as Y,D as Z,e as $,y as tt,z as et,f as x,t as lt,r as p,o as s,c as o,h as a,g as P,i as n,j as h,H as nt,I as st,F as D,k as S,x as V,a as C,B as T,l as z,A as B,d as U,b as R,m as ot,s as at,p as it}from"./index.min.js";const ct=U(()=>R(()=>import("./map-GtxasIM0.min.js"),__vite__mapDeps([0,1,2,3]))),rt=U(()=>R(()=>import("./trip_page-o5CeGaL7.min.js"),__vite__mapDeps([4,2,3,5,1]))),dt={components:{datatabble:Z,maps:ct,delete_icon:$,car_icon:tt,route_icon:et,trip_page:rt},name:"Destinations",setup(d){const r=d.conf.url+d.path+"?load=json",g=x(null),t=x({}),_=x({}),j=x({}),F=x([]),k=x(""),L=x(!1),y=x(!1),A=()=>{};(()=>{ot(r).then(e=>{_.value=JSON.parse(JSON.stringify(e)),l(_.value.items),b()})})();const l=e=>{for(let i=0;i<e.length;i++)q(e[i])},w=(e,i)=>{t.value=e;for(let f=0;f<_.value.items.length;f++)_.value.items[f].selected=!1;_.value.items[i].selected=!0;let u,m,H=d.conf.url+"uploads/images/yellow_pin.gif",W=d.conf.url+"uploads/images/blue_pin.gif",Q=d.conf.url+"uploads/images/car.svg",X=d.conf.url+"uploads/images/destination.svg",v=[],O={lat:parseFloat(e.vehicle.last_latitude),lng:parseFloat(e.vehicle.last_longitude)};v[0]={drag:!0,status:"waiting",icon:Q,origin:O,destination:O};for(let f=0;f<e.pickup_locations.length;f++)u=e.pickup_locations[f],m=f?e.pickup_locations[f-1].location:u.location,v[f+1]={status:u.status,icon:u.status=="waiting"?W:H,origin:{lat:parseFloat(m.latitude),lng:parseFloat(m.longitude)},destination:{lat:parseFloat(u.location.latitude),lng:parseFloat(u.location.longitude)}};return v[v.length]={drag:!0,icon:X,origin:{lat:0,lng:0},destination:{lat:parseFloat(e.route.latitude),lng:parseFloat(e.route.longitude)}},j.value=v[0].destination,F.value=v,v},c=async()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{j.value={lat:e.coords.latitude,lng:e.coords.longitude}},e=>{at(e.message,5e3)})};c();const b=()=>{for(let e=0;e<_.value.items.length;e++)_.value.items[e].active=k.value.trim()?N(_.value.items[e]):1},N=e=>{let i=!!e.student_name.toLowerCase().includes(k.value.toLowerCase());return i||!!e.location_name.toLowerCase().includes(k.toLowerCase())},J=e=>{t.value=e,I("edit",e)},K=(e,i,u)=>{t.value=u,t.value.latitude=u.destination.lat,t.value.longitude=u.destination.lng,I("edit",t.value)},q=e=>(e.icon=d.conf.url+"uploads/images/blue_pin.gif",e.origin=e.destination={lat:parseFloat(e.latitude),lng:parseFloat(e.longitude)},e.drag=!0,e),I=(e,i)=>{switch(e){case"view":break;case"edit":M(i,!0);break;case"delete":it("destination_id",i,"Destination.delete");break}},G=(e,i)=>{let u=[];for(let m=0;m<e.length;m++)e[m].status==i;return u},M=(e,i=!0)=>{y.value=i,t.value=e};return{editFields:M,showTrip:y,activeTrip:g,locations:F,url:r,content:_,center:j,activeItem:t,callback:()=>{M(null,!1),y.value=!1},filterLocations:G,translate:lt,clickMarker:K,updateMarker:J,setLocationsMarkers:w,checkSimilar:N,searchTextChanged:b,searchText:k,getUserLocation:c,collapsed:L,closeSide:A,handleAction:I}},props:["path","lang","setting","conf","auth"]},ut={class:"w-full flex overflow-auto"},ht={key:1,class:"w-full relative"},_t={class:"self-stretch py-4 flex-col justify-center items-start flex"},ft=["textContent"],gt=["textContent"],xt={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},mt=["placeholder"],vt={key:0,class:"w-full grow shrink basis-0 px-6 py-4 flex-col justify-center items-start gap-4 inline-flex"},kt={class:"w-full self-stretch justify-start items-start inline-flex cursor-pointer"},yt=["onClick"],bt=["src"],pt=["textContent"],wt={class:"self-stretch text-slate-500 text-base font-normal flex"},Ct=["textContent"],Tt={class:"self-stretch text-slate-500 text-sm text-muted flex"},jt=["textContent"],Ft={class:"gap-2 py-2 justify-start items-start gap-2.5 inline-flex"},Lt=["onClick"],At={class:"text-center text-xs text-white uppercase tracking-tight"},It=n("hr",{class:"w-full"},null,-1),Mt={class:"w-full relative flex"},Dt={class:"w-full relative"},St=["textContent"],Vt=["src"],Bt=n("i",{class:"fa fa-location-dot text-sm"},null,-1),Et=["textContent"],Nt={class:"w-full relative"},Ot=["textContent"],Pt=["src"],zt=n("i",{class:"fa fa-location-dot text-sm"},null,-1),Ut=["textContent"],Rt={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},Jt=["textContent"],Kt=n("hr",{class:"mt-2"},null,-1),qt={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},Gt=["textContent"],Ht=n("hr",{class:"mt-2"},null,-1),Wt={class:"w-full"},Qt=["src"],Xt=["onClick"],Yt=["onClick"];function Zt(d,r,g,t,_,j){const F=p("maps"),k=p("car_icon"),L=p("route_icon"),y=p("vue-feather"),A=p("delete_icon"),E=p("datatabble");return s(),o("div",ut,[t.showTrip?(s(),o("div",{key:t.showTrip,class:"w-full relative"})):a("",!0),t.content&&!t.showTrip?(s(),o("div",ht,[t.center?(s(),P(F,{conf:g.conf,key:t.center,setting:g.setting,center:t.center,onClickMarker:t.clickMarker,onUpdateMarker:t.updateMarker,showroute:!1,waypoints:t.locations,onIntervalCallback:t.callback},null,8,["conf","setting","center","onClickMarker","onUpdateMarker","waypoints","onIntervalCallback"])):a("",!0),n("div",{style:T(t.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-14 h-full absolute top-4 rounded-lg p-4 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[n("div",_t,[n("div",{class:"text-black text-lg font-semibold",textContent:h(t.content.title)},null,8,ft),n("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:h(t.translate("Private Trips description"))},null,8,gt)]),t.collapsed?a("",!0):(s(),o("div",xt,[nt(n("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:t.translate("find by name and address"),"onUpdate:modelValue":r[0]||(r[0]=l=>t.searchText=l),onChange:r[1]||(r[1]=(...l)=>t.searchTextChanged&&t.searchTextChanged(...l)),onInput:r[2]||(r[2]=(...l)=>t.searchTextChanged&&t.searchTextChanged(...l)),onKeydown:r[3]||(r[3]=(...l)=>t.searchTextChanged&&t.searchTextChanged(...l))},null,40,mt),[[st,t.searchText]])])),t.content.items?(s(),o("div",{key:t.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[t.collapsed?a("",!0):(s(!0),o(D,{key:0},S(t.content.items,(l,w)=>(s(),o("div",{key:l.active,class:"w-full"},[l.active&&l.trip_status=="Scheduled"?(s(),o("div",{key:0,class:V([l.selected?"text-gray-600":"bg-gray-50","mb-4 w-full rounded-lg justify-start items-center inline-flex"])},[l.vehicle?(s(),o("div",vt,[n("div",kt,[n("div",{onClick:c=>t.setLocationsMarkers(l,w),class:"w-full grow shrink basis-0 justify-start items-start flex gap-4"},[n("img",{src:l.driver.picture,class:"w-10 h-10"},null,8,bt),l.driver.name?(s(),o("div",{key:0,class:V([l.selected?"text-purple-600":"text-gray-800","self-stretch text-base font-semibold tracking-tight"])},[n("span",{textContent:h(l.driver.name)},null,8,pt),n("div",wt,[C(k,{class:"w-8"}),l.vehicle?(s(),o("span",{key:0,class:"font-semibold text-sm p-2",textContent:h(l.vehicle.plate_number)},null,8,Ct)):a("",!0)]),n("div",Tt,[C(L,{class:"w-8"}),l.route?(s(),o("span",{key:0,class:"font-semibold text-sm p-2",textContent:h(l.route.route_name)},null,8,jt)):a("",!0)])],2)):a("",!0)],8,yt),n("div",Ft,[n("div",{class:"mb-2 w-10 h-10 p-2 bg-primary rounded-full justify-center items-center flex cursor-pointer",onClick:c=>t.handleAction("edit",l)},[n("div",At,[C(y,{class:"w-5",type:"edit"})])],8,Lt)])]),It,n("div",Mt,[n("div",Dt,[n("h3",{class:"py-2 text-sm mb-10",textContent:h(t.translate("Waiting pickups"))},null,8,St),d.tripLocation&&d.tripLocation.status=="waiting"?(s(!0),o(D,{key:0},S(t.filterLocations(l.pickup_locations,"waiting"),(c,b)=>(s(),o("img",{style:T((g.lang.lang=="en"?"left: ":"right: ")+20*b+"px"),class:"rounded-full w-8 h-8 left-0 bottom-1 absolute rounded-[50px] border-2 border-purple-800",src:c&&c.location&&c.location.picture?c.location.picture:"https://via.placeholder.com/37x37"},null,12,Vt))),256)):a("",!0),n("span",{class:"bottom-2 absolute pt-2",style:T((g.lang.lang=="en"?"left: ":"right: ")+(20*l.waiting_locations.length+20)+"px")},[Bt,z(),l.pickup_locations?(s(),o("span",{key:0,class:"font-semibold px-1",textContent:h(l.waiting_locations.length)},null,8,Et)):a("",!0)],4)]),n("div",Nt,[n("h3",{class:"py-2 text-sm mb-10",textContent:h(t.translate("Active pickups"))},null,8,Ot),d.tripLocation&&d.tripLocation.status=="moving"?(s(!0),o(D,{key:0},S(t.filterLocations(l.pickup_locations,"moving"),(c,b)=>(s(),o("img",{style:T((g.lang.lang=="en"?"left: ":"right: ")+20*b+"px"),class:"rounded-full w-8 h-8 left-0 bottom-1 absolute rounded-[50px] border-2 border-purple-800",src:c&&c.location&&c.location.picture?c.location.picture:"https://via.placeholder.com/37x37"},null,12,Pt))),256)):a("",!0),n("span",{class:"bottom-2 absolute pt-2",style:T((g.lang.lang=="en"?"left: ":"right: ")+(20*l.moving_locations_count+20)+"px")},[zt,z(),l.pickup_locations?(s(),o("span",{key:0,class:"font-semibold px-1",textContent:h(l.moving_locations_count)},null,8,Ut)):a("",!0)],4)])])])):a("",!0)],2)):a("",!0)]))),128))])):a("",!0),n("div",Rt,[n("div",{onClick:r[4]||(r[4]=l=>t.collapsed=!t.collapsed),class:"cursor-pointer p-2 block text-center"},[n("i",{class:V(["fa",t.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),n("p",{class:"font-semibold",textContent:h(t.collapsed?t.translate("Expand"):t.translate("Collapse"))},null,8,Jt)])])],4),Kt,t.content?(s(),o("main",{key:t.content.items,class:"flex-1 overflow-x-hidden overflow-y-auto w-full"},[n("div",qt,[n("h1",{class:"font-bold text-lg w-full",textContent:h(t.content.title)},null,8,Gt)]),Ht,n("div",Wt,[t.content.columns?(s(),P(E,{key:0,class:"align-middle fs-6 gy-5 table table-row-dashed px-6","body-text-direction":t.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:t.content.columns,items:t.content.items},{"item-picture":B(l=>[n("img",{src:l.picture,class:"w-8 h-8 rounded-full"},null,8,Qt)]),"item-details":B(l=>[l.not_editable?a("",!0):(s(),o("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:w=>t.handleAction("edit",l)},[C(y,{class:"w-5",type:"edit"})],8,Xt))]),"item-delete":B(l=>[l.not_removeable?a("",!0):(s(),o("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:w=>t.handleAction("delete",l)},[C(A,{class:"w-5"})],8,Yt))]),_:1},8,["body-text-direction","headers","items"])):a("",!0)])])):a("",!0)])):a("",!0)])}const ee=Y(dt,[["render",Zt]]);export{ee as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-GtxasIM0.min.js","index.es-sRIzCSW1.min.js","index.min.js","index.min.css","trip_page-o5CeGaL7.min.js","help-gTc-Tbd6.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
