import{_ as G,r as n,U as L,a as y,o as g,c as x,y as M,O,g as S,F as T,f as z,d as V,b as I}from"./index.min.js";import{O as W,L as E,j as J}from"./index.es-BqyRJkQ3.min.js";const Z={components:{GoogleMap:W,Polyline:E,CustomMarker:J},emits:["markerclicked"],setup(_,{emit:k}){const c=n(null),o=n(null),h=n(12),s=n([]),u=n([]),d=n([]),v=n({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),l=n(_.route),p=(e,t="lat",r="lng",i)=>{let a=JSON.parse(JSON.stringify(e));return a.icon=_.conf.url+"uploads/images/"+i,a.marker_position={lat:parseFloat(e[t]),lng:parseFloat(e[r])},a.drag=!1,a};(()=>{s.value=[p(l.value.position,"start_latitude","start_longitude","car.svg")];let e=l.value.route_locations;if(e&&e.length)for(let t=0;t<e.length;t++)s.value[t+1]=p(e[t],"start_latitude","start_longitude","yellow_pin.gif");s.value[s.value.length]=p(l.value.position,"end_latitude","end_longitude","destination.svg")})();const C=n({lat:0,lng:0}),f=n({lat:0,lng:0}),w=n(null),m=n(null),B=()=>{setTimeout(function(){w.value=new window.google.maps.DirectionsService,m.value=new window.google.maps.DirectionsRenderer({draggable:!0,map:c,panel:document.getElementById("panel")}),m.value.addListener("directions_changed",()=>{m.value.getDirections()}),R(C.value,f.value,w.value,m.value)},1e3)},D=()=>{var e=[];for(let t=0;t<s.value.length;t++){const r=s.value[t];e[t]={location:r.marker_position}}return e},R=(e,t,r,i)=>{r.route({origin:e,destination:t,waypoints:D(),travelMode:window.google.maps.TravelMode.DRIVING,avoidTolls:!0}).then(a=>{console.log(a);const P=F(a);d.value=P,u.value={path:P,geodesic:!0,strokeColor:"#000",strokeOpacity:.9,strokeWeight:2}}).catch(a=>{alert("Could not display directions due to: "+a)})},F=e=>{const t=e.routes[0].overview_polyline;return window.google.maps.geometry.encoding.decodePath(t).map(i=>({lat:i.lat(),lng:i.lng()}))};return L(()=>{o.value={lat:l.value.position.start_latitude,lng:l.value.position.start_longitude},C.value=o.value,f.value={lat:l.value.position.end_latitude,lng:l.value.position.end_longitude},B()}),{markerClicked:e=>{k("markerclicked",e)},map:c,markers:s,mapCenter:o,mapZoom:h,polylinePath:u,routeCoordinates:d,polylineOptions:v}},props:["system_setting","route","conf"]},U={class:"w-full overflow-auto"},b={style:{"text-align":"center"}},j=["src"];function q(_,k,c,o,h,s){const u=y("Polyline"),d=y("CustomMarker"),v=y("GoogleMap");return g(),x("div",U,[o.mapCenter?(g(),M(v,{"api-key":c.system_setting.google_map_api,ref:"map",center:o.mapCenter,key:`${o.mapCenter.lat},${o.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:o.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:O(()=>[S(u,{options:o.polylinePath},null,8,["options"]),(g(!0),x(T,null,z(o.markers,(l,p)=>(g(),M(d,{options:{position:l.marker_position},onClick:N=>o.markerClicked(l)},{default:O(()=>[V("div",b,[V("img",{src:l.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,j)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):I("",!0)])}const Q=G(Z,[["render",q]]);export{Q as r};
