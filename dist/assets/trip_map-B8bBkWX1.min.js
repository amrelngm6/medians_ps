import{_ as G,r as t,U as L,a as h,o as p,c as x,y as M,O,g as S,F as z,f as I,d as m,b as E}from"./index.min.js";import{O as J,L as Z,j as A}from"./index.es-BqyRJkQ3.min.js";const U={components:{GoogleMap:J,Polyline:Z,CustomMarker:A},emits:["markerclicked"],setup(g,{emit:C}){const r=t(null),o=t(null),f=t(12),i=t([]),_=t([]),c=t([]),v=t({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),n=t(g.trip),k=(e,a="lat",d="lng",s)=>{let l=JSON.parse(JSON.stringify(e));return l.icon=g.conf.url+"uploads/images/"+s,l.marker_position={lat:parseFloat(e[a]),lng:parseFloat(e[d])},l.drag=!1,l};(()=>{i.value=[k(n.value,"pickup_latitude","pickup_longitude","car.svg")],i.value[i.value.length]=k(n.value,"destination_latitude","destination_longitude","destination.svg")})();const y=t({lat:0,lng:0}),w=t({lat:0,lng:0}),P=t(null),u=t(null),V=()=>{setTimeout(function(){P.value=new window.google.maps.DirectionsService,u.value=new window.google.maps.DirectionsRenderer({draggable:!0,map:r,panel:document.getElementById("panel")}),u.value.addListener("directions_changed",()=>{const e=u.value.getDirections();e&&R(e)}),N(y.value,w.value,P.value,u.value)},1e3)},N=(e,a,d,s)=>{d.route({origin:e,destination:a,travelMode:window.google.maps.TravelMode.DRIVING,avoidTolls:!0}).then(l=>{console.log(l);const F=B(l);c.value=F}).catch(l=>{alert("Could not display directions due to: "+l)})},B=e=>{const a=e.routes[0].overview_polyline;return window.google.maps.geometry.encoding.decodePath(a.points).map(s=>({lat:s.lat(),lng:s.lng()}))},R=e=>{const a=e.routes[0];!a||a.legs},T=async()=>V();return L(()=>{y.value={lat:n.value.pickup_latitude,lng:n.value.pickup_longitude},o.value=y.value,w.value={lat:n.value.destination_latitude,lng:n.value.destination_longitude},T()}),{map:r,markerClicked:e=>{C("markerclicked",e)},markers:i,mapCenter:o,mapZoom:f,polylinePath:_,routeCoordinates:c,polylineOptions:v}},props:["system_setting","trip","conf"]},W={class:"w-full overflow-auto"},b={style:{"text-align":"center"}},j=["src"],q=m("div",{id:"panel"},null,-1),H=m("div",{id:"total"},null,-1);function K(g,C,r,o,f,i){const _=h("Polyline"),c=h("CustomMarker"),v=h("GoogleMap");return p(),x("div",W,[o.mapCenter?(p(),M(v,{"api-key":r.system_setting.google_map_api,ref:"map",center:o.mapCenter,key:`${o.mapCenter.lat},${o.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:o.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:O(()=>[S(_,{options:o.polylinePath},null,8,["options"]),(p(!0),x(z,null,I(o.markers,(n,k)=>(p(),M(c,{options:{position:n.marker_position},onClick:D=>o.markerClicked(n)},{default:O(()=>[m("div",b,[m("img",{src:n.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,j)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):E("",!0),q,H])}const $=G(U,[["render",K]]);export{$ as t};
