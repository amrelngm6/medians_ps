const __vite__fileDeps=["form_field-CYYYuM7T.min.js","index.min.js","index.min.css","Field-BlTLUcd1.min.js","Field.min.css","editable_map_location-CxefW7uc.min.js","index.es-jn268Cag.min.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as tt,C as et,A as st,E as lt,J as at,r as n,t as x,U as E,a as I,o as d,c as r,b as m,d as t,g as p,e as a,n as nt,B as ot,q as it,u as ct,s as N,O as j,al as dt,l as rt,H as _t,P as B,I as ut,p as vt}from"./index.min.js";import{e as mt}from"./editable_map_location-CxefW7uc.min.js";import{d as ht}from"./drivers_locations_map-DXdS3iXX.min.js";import{t as ft}from"./taxi_trip_map-D5YKirA_.min.js";import"./index.es-jn268Cag.min.js";const gt=it(()=>ct(()=>import("./form_field-CYYYuM7T.min.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),xt={components:{taxt_trip_map:ft,close_icon:et,delete_icon:st,car_icon:lt,form_field:gt,editable_map_location:mt,drivers_locations_map:ht,tooltip:at},name:"Taxi trips",emits:["callback"],setup(o,{emit:w}){const _=n(!1),s=n(!1),L=n(!1);n(null);const l=n({}),b=n(o.usertype),S=n({}),k=n({});n([]),n(!0);const u=n(""),P=n(null),U=n(!1),z=n([o.usertype,"Pickup location","Destination","Driver","Time","Cost","Confirm"]),y=n([]),O=n(!1),D=n(""),T=n(""),M=n([{title:x("Scheduled"),status:"scheduled"},{title:x("Started"),status:"started"},{title:x("Completed"),status:"completed"},{title:x("Cancelled"),status:"cancelled"}]);console.log(o.item),o.item?(l.value=o.item,l.value.date=o.item.date??E()):l.value.date=E();const W=o.userslist?n(o.userslist):n([]),V=async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{l.value.trip_id||(l.value.pickup_latitude=e.coords.latitude,l.value.pickup_longitude=e.coords.longitude,l.value.destination_latitude=e.coords.latitude,l.value.destination_longitude=e.coords.longitude)},e=>{l.value.trip_id||(l.value.pickup_latitude=l.value.pickup_latitude??30.06,l.value.pickup_longitude=l.value.pickup_longitude??31.21,l.value.destination_latitude=l.value.destination_latitude??30.06,l.value.destination_longitude=l.value.destination_longitude??31.21),N(e.message)}):(N("location error"),P.value="Geolocation is not supported by this browser.")};V();const q=async()=>{let e=D.value.length>3?await j(o.system_setting.google_map_api,D.value,o.setting.country):"";y.value=e.predictions},J=async()=>{let e=T.value.length>3?await j(o.system_setting.google_map_api,T.value,o.setting.country):"";y.value=e.predictions},R=()=>{_.value=!0;var e=new URLSearchParams;let i=JSON.parse(JSON.stringify(l.value)),v=Object.keys(i),c,f;for(let g=0;g<v.length;g++)c=v[g],f=typeof i[c]=="object"?JSON.stringify(i[c]):i[c],e.append("params["+c+"]",f);let C=i.trip_id>0?"update":"create";e.append("type","TaxiTrip."+C);const h=dt();h&&(h.root.data.loader=!0),rt(e,"/api/"+C).then(g=>{_t(g),_.value=!1})},F=async e=>{l.value.pickup_latitude=e.lat(),l.value.pickup_longitude=e.lng(),l.value.pickup_address=await B(e.lat(),e.lng())},G=async e=>{l.value.destination_latitude=e.lat(),l.value.destination_longitude=e.lng(),l.value.destination_address=await B(e.lat(),e.lng())},H=async(e,i)=>{const v=new google.maps.places.PlacesService(document.createElement("div"));let c=e.place_id;v.getDetails({placeId:c},(f,C)=>{if(C===google.maps.places.PlacesServiceStatus.OK&&f){const h=f.geometry.location;i=="pickup"&&(l.value.pickup_address=e.description,l.value.pickup_latitude=h.lat(),l.value.pickup_longitude=h.lng()),i=="destination"&&(l.value.destination_address=e.description,l.value.destination_latitude=h.lat(),l.value.destination_longitude=h.lng()),y.value=[],O.value=!1}else console.error("Failed to fetch place details")})},K=()=>{w("callback")},Q=()=>ut(["model_id","driver_id","pickup_address","destination_address","status"],l),X=e=>{l.value.model_id=o.usertype=="student"?e.student_id:e.customer_id,l.value.model=e,b.value="Pickup location",u.value=null},Y=e=>{l.value.driver_id=e.driver_id,l.value.driver=e,A(e.vehicle)},A=e=>{l.value.vehicle_id=e.vehicle_id,l.value.vehicle=e,u.value=null},Z=()=>{if(o.userslist)for(let e=0;e<o.userslist.length;e++)o.userslist[e].show=u.value.trim()?$(o.userslist[e]):1},$=e=>{let i=!!e.name.toLowerCase().includes(u.value.toLowerCase()),v=i||!!e.email.toLowerCase().includes(u.value.toLowerCase());return v||!!e.mobile.toLowerCase().includes(u.value.toLowerCase())};return{loader:_,tripsStatusList:M,selectedObject:(e,i)=>{const v=l.value[i];for(let c=0;c<e.length;c++)if(e[c][i]==v)return e[c];return{}},setDriver:Y,setVehicle:A,users:W,progressWidth:Q,setUser:X,findUser:Z,setPlaceMarker:H,showPlaceSearch:O,pickupPlaceChanged:q,destinationPlaceChanged:J,pickup_placeSearch:D,destination_placeSearch:T,places:y,showAddSide:s,showEditSide:L,content:S,fillable:z,center:k,activeItem:l,activeTab:b,translate:x,updatePickupMarker:F,updateDestinationMarker:G,searchText:u,getUserLocation:V,collapsed:U,saveTrip:R,back:K}},props:["conf","path","system_setting","setting","item","userslist","usertype","drivers","vehicles","currency"]},pt={class:"w-full"},wt=t("img",{class:"m-auto w-500px",src:"/uploads/loader.gif"},null,-1),bt=[wt],kt={class:"w-full flex overflow-auto"},yt={class:"w-full relative"},Ct={class:"card w-full py-10"},It={class:"w-full stepper stepper-links"},St={class:"w-full"},Pt={class:""},Dt={class:"card-body pt-0 mx-auto"},Tt={class:"w-full flex gap-10"},Lt={class:"w-full"},Ot={class:"w-full"},Vt=t("hr",{class:"block mt-6 my-2 opacity-10"},null,-1),At={class:"bg-gray-200 shadow-md mb-10 rounded-xl"},Et={class:"card-header border-0 pt-9"},Nt={key:0,class:"card-title m-0 flex gap-4"},jt={class:"symbol symbol-50px w-50px bg-light"},Bt=["src"],Ut={class:"w-full"},zt=["textContent"],Mt=["textContent"],Wt={key:0,class:"card-body p-9"},qt={class:"timeline timeline-border-dashed"},Jt={class:"timeline-item"},Rt=t("div",{class:"timeline-line"},null,-1),Ft={class:"timeline-icon me-4"},Gt={class:"timeline-content mb-10 mt-n2"},Ht={class:"overflow-auto pe-3"},Kt=["textContent"],Qt={class:"d-flex align-items-center mt-1 fs-6"},Xt=["textContent"],Yt={class:"timeline-item"},Zt=t("div",{class:"timeline-line"},null,-1),$t={class:"timeline-icon me-4"},te={class:"timeline-content mb-10 mt-n2"},ee={class:"overflow-auto pe-3"},se=["textContent"],le={class:"d-flex align-items-center mt-1 fs-6"},ae=["textContent"],ne={class:"h-4px w-100 bg-light mb-5"},oe={key:0,class:"w-full flex gap-4"},ie={key:0,class:"flex gap-4 w-full"},ce=["src"],de={class:"block gap-4 w-full"},re=["textContent"],_e=["textContent"],ue={key:1,class:"w-full flex gap-4"},ve={class:"block gap-4"},me=["textContent"],he=["textContent"],fe={key:2,class:"w-full flex-end"},ge=["textContent"],xe={class:"w-full flex gap-4"},pe=["textContent"],we=["textContent"],be={class:"flex gap-6 pb-4 font-semibold text-lg"},ke={class:"flex gap-6 w-full"},ye=["textContent"],Ce=["textContent"],Ie={class:"flex gap-6 w-full"},Se=["textContent"],Pe=["textContent"],De={class:"flex gap-6 w-full"},Te=["textContent"],Le=["textContent"],Oe={class:"notice d-flex bg-light-warning rounded border-warning border border-dashed mb-12 p-6 gap-4"},Ve=vt('<i class="vue-feather vue-feather--alert-octagon ki-duotone ki-information fs-2tx text-warning me-4" data-name="alert-octagon" data-tags="warning,alert,danger" data-type="alert-octagon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-octagon vue-feather__content"><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></i>',1),Ae={class:"d-flex flex-stack flex-grow-1"},Ee={class:"fw-semibold"},Ne=["textContent"],je={class:"fs-6 text-gray-700"},Be=["textContent"],Ue={class:"text-center mt-10"},ze=["textContent"];function Me(o,w,_,s,L,l){const b=I("close_icon"),S=I("taxt_trip_map"),k=I("vue-feather"),u=I("car_icon");return d(),r("div",pt,[s.loader?(d(),r("div",{key:s.loader,class:"bg-white fixed w-full h-full top-0 left-0",style:{"z-index":"99999",opacity:".9"}},bt)):m("",!0),t("div",kt,[t("div",yt,[p(b,{class:"absolute top-4 right-4 z-10 cursor-pointer",onClick:s.back},null,8,["onClick"]),t("div",Ct,[t("div",It,[t("div",St,[t("div",Pt,[t("div",Dt,[t("div",Tt,[t("div",Lt,[p(S,{onMarkerclicked:o.markerClicked,class:"w-full rounded-xl shadow-md mx-4",system_setting:_.system_setting,conf:_.conf,trip:s.activeItem},null,8,["onMarkerclicked","system_setting","conf","trip"])]),t("div",Ot,[Vt,t("div",At,[t("div",Et,[s.activeItem.model?(d(),r("div",Nt,[t("div",jt,[t("img",{src:s.activeItem.model.picture,alt:"image",class:"p-3"},null,8,Bt)]),t("div",Ut,[t("div",{class:"font-semibold",textContent:a(s.activeItem.model.name)},null,8,zt),t("div",{class:"",textContent:a(s.activeItem.model.mobile)},null,8,Mt)])])):m("",!0)]),s.activeItem?(d(),r("div",Wt,[t("div",qt,[t("div",Jt,[Rt,t("div",Ft,[p(k,{type:"circle",class:"fs-2 text-success"})]),t("div",Gt,[t("div",Ht,[s.activeItem?(d(),r("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:a(s.activeItem.pickup_address)},null,8,Kt)):m("",!0),t("div",Qt,[t("div",{class:"text-muted me-2 fs-7",textContent:a(s.translate("Pickup"))},null,8,Xt)])])])]),t("div",Yt,[Zt,t("div",$t,[p(k,{type:"map-pin",class:"fs-2 text-danger"})]),t("div",te,[t("div",ee,[s.activeItem?(d(),r("div",{key:0,class:"fs-5 fw-semibold mb-2",textContent:a(s.activeItem.destination_address)},null,8,se)):m("",!0),t("div",le,[t("div",{class:"text-muted me-2 fs-7",textContent:a(s.translate("Destination"))},null,8,ae)])])])])]),t("div",ne,[t("div",{class:nt(["rounded h-4px transition transition-all",s.progressWidth()<100?"bg-info":"bg-success"]),role:"progressbar",style:ot({width:s.progressWidth()+"%"})},null,6)]),s.activeItem?(d(),r("div",oe,[s.activeItem.driver?(d(),r("div",ie,[t("img",{src:s.activeItem.driver.picture,class:"rounded-full bg-white border-1 border border-gray-600 p-1 w-12 h-12"},null,8,ce),t("div",de,[t("span",{class:"w-full block font-semibold",textContent:a(s.translate("Driver"))},null,8,re),t("span",{class:"w-full block",textContent:a(s.activeItem.driver.name)},null,8,_e)])])):m("",!0),s.activeItem.vehicle?(d(),r("div",ue,[p(u),t("div",ve,[t("span",{class:"w-full block font-semibold",textContent:a(s.translate("Vehicle"))},null,8,me),t("span",{class:"w-full block",textContent:a(s.activeItem.vehicle.plate_number)},null,8,he)])])):m("",!0),s.activeItem.date?(d(),r("div",fe,[t("span",{class:"w-full block font-semibold",textContent:a(s.translate("Trip date"))},null,8,ge),t("div",xe,[t("span",{class:"",textContent:a(s.activeItem.date)},null,8,pe),t("span",{class:"",textContent:a(s.activeItem.start_time)},null,8,we)])])):m("",!0)])):m("",!0)])):m("",!0)]),t("div",be,[t("div",ke,[t("div",{textContent:a(s.translate("Subtotal"))},null,8,ye),t("div",{textContent:a(_.currency.symbol+""+s.activeItem.subtotal)},null,8,Ce)]),t("div",Ie,[t("div",{textContent:a(s.translate("Discount"))},null,8,Se),t("div",{textContent:a(_.currency.symbol+""+s.activeItem.discount_amount)},null,8,Pe)]),t("div",De,[t("div",{textContent:a(s.translate("Total cost"))},null,8,Te),t("div",{textContent:a(_.currency.symbol+""+s.activeItem.total_cost)},null,8,Le)])]),t("div",Oe,[Ve,t("div",Ae,[t("div",Ee,[t("h4",{class:"text-gray-900 fw-bold",textContent:a(s.translate(s.activeItem.payment_status))},null,8,Ne),t("div",je,[t("div",{textContent:a(s.translate("Payment status"))},null,8,Be)])])])])])]),t("p",Ue,[t("a",{href:"javascript:;",class:"uppercase px-4 py-3 mx-2 text-center text-white rounded-lg bg-danger",onClick:w[0]||(w[0]=(...P)=>s.back&&s.back(...P)),textContent:a(s.translate("Back"))},null,8,ze)])])])])])])])])])}const He=tt(xt,[["render",Me]]);export{He as default};
