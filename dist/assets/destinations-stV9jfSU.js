import{_ as V,D as B,p as F,q as d,s as z,r as w,o as a,c as h,a as n,j as p,d as i,l as N,t as m,w as U,v as R,F as q,i as J,n as K,u as S,x as A,y as G,z as H,A as Q,b as W,B as j}from"./index-b-N3zmxy.js";import{c as X,r as Y}from"./car-2YrXyE90.js";const Z=A(()=>j(()=>import("./map-xbS0EGJ9.js"),__vite__mapDeps([0,1,2]))),$=A(()=>j(()=>import("./side-form-create-agHFnKY7.js"),__vite__mapDeps([3,1,2,4,5,6]))),ee=A(()=>j(()=>import("./side-form-update-RVt_MxwS.js"),__vite__mapDeps([7,1,2,4,5,6]))),te={components:{datatabble:B,SideFormCreate:$,SideFormUpdate:ee,maps:Z,delete_icon:F,car_icon:X,route_icon:Y},name:"Destinations",setup(l){const s=l.conf.url+l.path+"?load=json",_=d(!1),e=d(!1);d(null);const f=d({}),u=d({}),x=d({}),g=d([]);d(!0);const v=d("");d(null);const b=d(!1),y=()=>{_.value=!1,e.value=!1};(()=>{G(s).then(t=>{u.value=JSON.parse(JSON.stringify(t)),k(u.value.items),D()})})();const k=t=>{let c=[];for(let r=0;r<t.length;r++)c[r]=I(t[r]);g.value=c},M=(t,c)=>{f.value=t;for(let L=0;L<u.value.items.length;L++)u.value.items[L].selected=!1;u.value.items[c].selected=!0;let r=I(t);g.value=[r],x.value=r.destination},T=async()=>{navigator.geolocation&&(console.log("position 1"),navigator.geolocation.getCurrentPosition(t=>{x.value={lat:t.coords.latitude,lng:t.coords.longitude}},t=>{H(t.message,5e3)}))};T();const D=()=>{for(let t=0;t<u.value.items.length;t++)u.value.items[t].active=v.value.trim()?E(u.value.items[t]):1},E=t=>{let c=!!t.student_name.toLowerCase().includes(v.value.toLowerCase());return c||!!t.location_name.toLowerCase().includes(v.toLowerCase())},P=t=>{console.log("updated"),f.value=t,C("edit",t)},O=(t,c,r)=>{f.value=r,f.value.latitude=r.destination.lat,f.value.longitude=r.destination.lng,C("edit",f.value)},I=t=>(t.icon=l.conf.url+"uploads/images/blue_pin.gif",t.origin=t.destination={lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)},t.drag=!0,t),C=(t,c)=>{switch(t){case"view":break;case"edit":e.value=!0,_.value=!1,f.value=c;break;case"delete":Q("pickup_id",c,"PickupLocation.delete");break}};return{locations:g,showAddSide:_,showEditSide:e,url:s,content:u,center:x,activeItem:f,translate:z,clickMarker:O,updateMarker:P,setLocationsMarkers:M,checkSimilar:E,searchTextChanged:D,searchText:v,getUserLocation:T,collapsed:b,closeSide:y,handleAction:C}},props:["path","lang","setting","conf","auth"]},oe={class:"w-full flex overflow-auto",style:{height:"85vh","z-index":"9999"}},ne={class:"w-full"},se={key:0,class:"relative flex-1 overflow-x-hidden overflow-y-auto w-full"},le={class:"self-stretch py-4 flex-col justify-center items-start flex"},ae=["textContent"],ie=["textContent"],ce={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},re=["placeholder"],de={key:0,class:"grow shrink basis-0 gap-4 justify-start items-center flex"},ue={class:"justify-start items-center flex"},he=["src"],fe=["onClick"],me=["textContent"],_e=["textContent"],ve={class:"justify-center items-center flex"},xe=["onClick"],ge=n("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[n("i",{class:"fa fa-edit"})],-1),ke=[ge],we={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},pe=["textContent"],be=["textContent"],ye={class:"px-4 mb-6 py-4 rounded-lg shadow-lg bg-white dark:bg-gray-700 flex w-full"},Ce=["textContent"],Le=n("hr",{class:"mt-2"},null,-1),Se={class:"w-full"},Ae=["src"],je=["onClick"],Te=n("i",{class:"fa fa-edit"},null,-1),De=[Te],Ee=["onClick"];function Ie(l,s,_,e,f,u){const x=w("maps"),g=w("delete_icon"),v=w("datatabble"),b=w("side-form-create"),y=w("side-form-update");return a(),h("div",oe,[n("div",ne,[e.content&&!l.showLoader?(a(),h("main",se,[e.locations.length?(a(),p(x,{showroute:!1,onUpdateMarker:l.updatedDestination,onClickMarker:l.updatedDestination,setting:_.setting,key:e.center,center:e.center,waypoints:e.locations},null,8,["onUpdateMarker","onClickMarker","setting","center","waypoints"])):i("",!0),e.content.items?(a(),h("div",{key:e.content.items,style:N(e.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-16 h-full absolute top-4 rounded-lg p-4 w-96 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[n("div",le,[n("div",{class:"text-black text-lg font-semibold",textContent:m(e.translate("Destinations"))},null,8,ae),n("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:m(e.translate("Destinations description"))},null,8,ie)]),e.collapsed?i("",!0):(a(),h("div",ce,[U(n("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:e.translate("find by name and address"),"onUpdate:modelValue":s[0]||(s[0]=o=>e.searchText=o),onChange:s[1]||(s[1]=(...o)=>e.searchTextChanged&&e.searchTextChanged(...o)),onInput:s[2]||(s[2]=(...o)=>e.searchTextChanged&&e.searchTextChanged(...o)),onKeydown:s[3]||(s[3]=(...o)=>e.searchTextChanged&&e.searchTextChanged(...o))},null,40,re),[[R,e.searchText]])])),e.collapsed?i("",!0):(a(),h("div",{key:e.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[l.showList&&l.destination.active?(a(!0),h(q,{key:0},J(e.content.items,o=>(a(),h("div",{key:o.active,class:"pt-2 w-full self-stretch justify-start items-center inline-flex"},[o.active?(a(),h("div",de,[n("div",ue,[n("img",{class:"w-10 h-10 rounded-full shadow-inner border-2 border-black",src:o.student&&o.student.picture?o.student.picture:"https://via.placeholder.com/60x6"},null,8,he)]),n("div",{onClick:k=>l.setDestinationsMarkers(o),class:"grow shrink basis-0 flex-col justify-center items-start gap-[3px] inline-flex cursor-pointer"},[n("div",{class:"text-black font-semibold text-base",textContent:m(o.student_name)},null,8,me),n("div",{class:"self-stretch text-slate-500 text-sm font-normal",textContent:m(o.location_name+" - "+o.address)},null,8,_e)],8,fe)])):i("",!0),n("div",ve,[n("div",{class:"px-3 py-2 bg-purple-800 rounded justify-center items-center flex mr-2 cursor-pointer",onClick:k=>e.handleAction("edit",o)},ke,8,xe)])]))),128)):i("",!0)])),n("div",we,[n("div",{class:"menu-dark rounded-lg text-white text-xs font-medium px-4 py-3 uppercase cursor-pointer",onClick:s[4]||(s[4]=o=>{l.showLoader=!0,e.showAddSide=!0,e.activeItem={},l.showLoader=!1}),textContent:m(e.translate("add new"))},null,8,pe),n("div",{onClick:s[5]||(s[5]=o=>e.collapsed=!e.collapsed),class:"cursor-pointer p-2 block text-center"},[n("i",{class:K(["fa",e.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),n("p",{class:"font-semibold",textContent:m(e.collapsed?e.translate("Expand"):e.translate("Collapse"))},null,8,be)])])],4)):i("",!0),n("div",ye,[n("h1",{class:"font-bold text-lg w-full",textContent:m(e.content.title)},null,8,Ce),n("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg menu-dark hover:bg-purple-800",onClick:s[6]||(s[6]=o=>{l.showLoader=!0,e.showAddSide=!0,e.activeItem={},l.showLoader=!1})},m(e.translate("add_new")),1)]),Le,n("div",Se,[e.content.columns?(a(),p(v,{key:0,"body-text-direction":e.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:e.content.columns,items:e.content.items},{"item-picture":S(o=>[n("img",{src:o.picture,class:"w-8 h-8 rounded-full"},null,8,Ae)]),"item-edit":S(o=>[o.not_editable?i("",!0):(a(),h("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:k=>e.handleAction("edit",o)},De,8,je))]),"item-delete":S(o=>[o.not_removeable?i("",!0):(a(),h("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:k=>e.handleAction("delete",o)},[W(g,{class:"w-4"})],8,Ee))]),_:1},8,["body-text-direction","headers","items"])):i("",!0),e.showAddSide&&e.content&&e.content.fillable?(a(),p(b,{key:1,onCallback:e.closeSide,conf:_.conf,model:"PickupLocation.create",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","columns"])):i("",!0),e.showEditSide&&!e.showAddSide?(a(),p(y,{key:2,onCallback:e.closeSide,conf:_.conf,model:"PickupLocation.update",item:e.activeItem,model_id:e.activeItem.pickup_id,index:"pickup_id",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","item","model_id","columns"])):i("",!0)])])):i("",!0)])])}const Oe=V(te,[["render",Ie]]);export{Oe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/map-xbS0EGJ9.js","assets/index-b-N3zmxy.js","assets/index-OY3wY1QZ.css","assets/side-form-create-agHFnKY7.js","assets/Field-CVVPkjLe.js","assets/Manager-pyZP7ngj.js","assets/Manager-Cgf44v6b.css","assets/side-form-update-RVt_MxwS.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}