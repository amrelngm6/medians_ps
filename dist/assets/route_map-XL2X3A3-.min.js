import{_ as P,f as a,R as V,r as f,o as d,c as y,g as C,A as w,a as F,F as N,k as B,i as x,h as $,S as z}from"./index.min.js";import{O as G,L,j as R}from"./index.es-4z_hVD90.min.js";const S={components:{GoogleMap:G,Polyline:L,CustomMarker:R},emits:["markerclicked"],setup(c,{emit:h}){const u=a(null),e=a(12),i=a([]),g=a([]),p=a([]),_=a({strokeColor:"#000000",strokeOpacity:.8,strokeWeight:2}),o=a(c.route),s=(t,n="lat",l="lng",v)=>{let r=JSON.parse(JSON.stringify(t));return r.icon=c.conf.url+"uploads/images/"+v,r.marker_position={lat:parseFloat(t[n]),lng:parseFloat(t[l])},r.drag=!1,r};(()=>{i.value=[s(o.value.position,"start_latitude","start_longitude","car.svg")];let t=o.value.route_locations;if(t.length)for(let n=0;n<t.length;n++)i.value[n+1]=s(t[n],"start_latitude","start_longitude","yellow_pin.gif");i.value[i.value.length]=s(o.value.position,"end_latitude","end_longitude","destination.svg")})();const m=a({lat:0,lng:0}),k=a({lat:0,lng:0}),M=async()=>{const n=`https://maps.googleapis.com/maps/api/directions/json?origin=${m.value.lat},${m.value.lng}&destination=${k.value.lat},${k.value.lng}&key=${c.system_setting.google_map_api}`;try{const l=await fetch(n);if(l.ok){const v=await l.json(),r=z(v.routes[0].overview_polyline.points);p.value=r,g.value={path:r,geodesic:!0,strokeColor:"#000",strokeOpacity:.9,strokeWeight:2}}else console.error("Failed to fetch route:",l.statusText)}catch(l){console.error("Error fetching route:",l)}};return V(()=>{u.value={lat:30.0649,lng:31.21},m.value={lat:o.value.position.start_latitude,lng:o.value.position.start_longitude},k.value={lat:o.value.position.end_latitude,lng:o.value.position.end_longitude},M()}),{markerClicked:t=>{h("markerclicked",t)},markers:i,mapCenter:u,mapZoom:e,polylinePath:g,routeCoordinates:p,polylineOptions:_}},props:["system_setting","route","conf"]},j={class:"w-full overflow-auto"},E={style:{"text-align":"center"}},J=["src"];function T(c,h,u,e,i,g){const p=f("Polyline"),_=f("CustomMarker"),o=f("GoogleMap");return d(),y("div",j,[e.mapCenter?(d(),C(o,{"api-key":u.system_setting.google_map_api,ref:"mapRef",center:e.mapCenter,key:`${e.mapCenter.lat},${e.mapCenter.lng}`,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},zoom:e.mapZoom,style:{width:"100%",height:"calc(100vh - 100px)"}},{default:w(()=>[F(p,{options:e.polylinePath},null,8,["options"]),(d(!0),y(N,null,B(e.markers,(s,O)=>(d(),C(_,{options:{position:s.marker_position},onClick:m=>e.markerClicked(s)},{default:w(()=>[x("div",E,[x("img",{src:s.icon,width:"40",class:"rouned-full",height:"40",style:{"margin-top":"8px"}},null,8,J)])]),_:2},1032,["options","onClick"]))),256))]),_:1},8,["api-key","center","zoom"])):$("",!0)])}const A=P(S,[["render",T]]);export{A as r};
