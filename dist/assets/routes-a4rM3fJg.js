import{_ as O,E as U,z as u,s as q,r as k,o as a,c,j as y,d as r,a as t,t as h,w as G,v as J,F as V,i as D,n as T,l as j,k as K,u as A,b as H,x as E,y as M,q as Q,B as W,p as X}from"./index-ghXfiaMh.js";const Y=E(()=>M(()=>import("./map-t0yXlqnI.js"),__vite__mapDeps([0,1,2]))),Z=E(()=>M(()=>import("./side-form-create-utiaFufh.js"),__vite__mapDeps([3,1,2,4,5,6]))),$=E(()=>M(()=>import("./side-form-update-3JjyWDne.js"),__vite__mapDeps([7,1,2,4,5,6]))),ee={components:{datatabble:U,SideFormCreate:Z,SideFormUpdate:$,maps:Y},name:"Students",setup(x){const n=x.conf.url+x.path+"?load=json",_=u(!1),e=u(!1),C=u(null),d=u({}),f=u({}),g=u({}),S=u([]);u(!0);const v=u(""),L=u(null),l=u(!1),p=()=>{_.value=!1,e.value=!1};(()=>{Q(n).then(s=>{f.value=JSON.parse(JSON.stringify(s)),I()})})();const b=async()=>{navigator.geolocation?(console.log("position 1"),navigator.geolocation.getCurrentPosition(s=>{g.value={lat:s.coords.latitude,lng:s.coords.longitude}},s=>{W(s.message,5e3)})):L.value="Geolocation is not supported by this browser."};b();const I=()=>{for(let s=0;s<f.value.items.length;s++)f.value.items[s].active=v.value.trim()?P(f.value.items[s]):1},P=s=>{let i=!!s.route_name.toLowerCase().includes(v.value.toLowerCase());return i||!!s.description.toLowerCase().includes(v.toLowerCase())},B=(s,i)=>{d.value=s;for(let o=0;o<f.value.items.length;o++)f.value.items[o].selected=!1;f.value.items[i].selected=!0,S.value=R(s)},N=(s,i,o)=>{d.value.latitude=o.latLng.lat(),d.value.longitude=o.latLng.lng(),F("edit",d.value)},z=(s,i,o)=>{d.value.latitude=o.latLng.lat(),d.value.longitude=o.latLng.lng(),F("edit",d.value)},R=s=>{let i,o=[];for(let w=0;w<s.pickup_locations.length;w++)i=s.pickup_locations[w],o[w]={icon:x.conf.url+"uploads/images/blue_pin.gif",origin:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)},destination:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)}};return o[o.length]={icon:x.conf.url+"uploads/images/car.svg",origin:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)},destination:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)}},g.value=o[0].destination,o[o.length]={drag:!0,icon:x.conf.url+"uploads/images/destination.svg",origin:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)},destination:{lat:parseFloat(s.latitude),lng:parseFloat(s.longitude)}},o},F=(s,i)=>{switch(s){case"view":break;case"edit":d.value=i,_.value=!1,e.value=!0,C.value=!0;break;case"delete":X("driver_id",i,"Driver.delete");break;case"close":e.value=!1,_.value=!1,C.value=!1,d.value={};break}};return console.log(g.value),{showAddSide:_,showEditSide:e,url:n,content:f,center:g,activeItem:d,translate:q,setLocationsPickups:R,clickMarker:z,updateMarker:N,setLocationsMarkers:B,checkSimilar:P,searchTextChanged:I,searchText:v,getUserLocation:b,collapsed:l,closeSide:p,handleAction:F}},props:["path","lang","setting","conf","auth"]},te={class:"w-full flex overflow-auto",style:{height:"85vh","z-index":"9999"}},le={key:0,class:"w-full relative"},se={class:"self-stretch py-4 flex-col justify-center items-start flex"},ne=["textContent"],oe=["textContent"],ae={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},ie=["placeholder"],ce={class:"w-full grow shrink basis-0 px-6 py-4 flex-col justify-center items-start gap-4 inline-flex"},re={class:"w-full self-stretch justify-start items-start inline-flex cursor-pointer"},de=["onClick"],ue=["textContent"],fe=["textContent"],he={class:"gap-2 py-2 flex justify-start items-start gap-2.5 inline-flex"},_e=["onClick"],xe=t("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[t("i",{class:"fa fa-location-dot"})],-1),me=[xe],ge=["onClick"],ve=t("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[t("i",{class:"fa fa-edit"})],-1),pe=[ve],ke=t("hr",{class:"w-full"},null,-1),be={class:"w-full h-8 relative flex"},we=["src"],ye=t("i",{class:"fa fa-location-dot text-sm"},null,-1),Ce=["textContent"],Se={class:"right-0 absolute self-stretch text-slate-500 text-base font-normal"},Le=t("i",{class:"fa fa-car px-2"},null,-1),Fe=["textContent"],Te={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},je=["textContent"],Ae=["textContent"],Ee=t("hr",{class:"mt-2"},null,-1),Me={class:"flex-1 overflow-x-hidden overflow-y-auto w-full relative"},Ie={class:"px-4 mb-6 py-4 rounded-lg shadow-lg bg-white dark:bg-gray-700 flex w-full"},Pe=["textContent"],Re=t("hr",{class:"mt-2"},null,-1),Ve={class:"w-full"},De=["src"],Be=["onClick"],Ne=t("i",{class:"fa fa-edit"},null,-1),ze=[Ne],Oe=["onClick"];function Ue(x,n,_,e,C,d){const f=k("maps"),g=k("close_icon"),S=k("datatabble"),v=k("side-form-create"),L=k("side-form-update");return a(),c("div",te,[e.content?(a(),c("div",le,[e.center?(a(),y(f,{conf:_.conf,setting:_.setting,key:e.center,center:e.center,onUpdateMarker:e.updateMarker,onClickMarker:e.clickMarker,waypoints:x.locations,showroute:!1},null,8,["conf","setting","center","onUpdateMarker","onClickMarker","waypoints"])):r("",!0),t("div",{style:j(e.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-16 h-full absolute top-4 rounded-lg p-4 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[t("div",se,[t("div",{class:"text-black text-lg font-semibold",textContent:h(e.translate("Routes"))},null,8,ne),t("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:h(e.translate("Routes description"))},null,8,oe)]),e.collapsed?r("",!0):(a(),c("div",ae,[G(t("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:e.translate("find by name and address"),"onUpdate:modelValue":n[0]||(n[0]=l=>e.searchText=l),onChange:n[1]||(n[1]=(...l)=>e.searchTextChanged&&e.searchTextChanged(...l)),onInput:n[2]||(n[2]=(...l)=>e.searchTextChanged&&e.searchTextChanged(...l)),onKeydown:n[3]||(n[3]=(...l)=>e.searchTextChanged&&e.searchTextChanged(...l))},null,40,ie),[[J,e.searchText]])])),!e.collapsed&&e.content.items?(a(),c("div",{key:e.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[(a(!0),c(V,null,D(e.content.items,(l,p)=>(a(),c("div",{key:l.active,class:"w-full"},[l.active?(a(),c("div",{key:0,class:T([l.selected?"text-fuchsia-600":"bg-gray-50","mb-4 w-full rounded-lg justify-start items-center inline-flex"])},[t("div",ce,[t("div",re,[t("div",{onClick:m=>e.setLocationsMarkers(l,p),class:"w-full grow shrink basis-0 flex-col justify-start items-start inline-flex"},[t("div",{class:T([l.selected?"text-fuchsia-600":"text-gray-800","self-stretch text-base font-semibold tracking-tight"]),textContent:h(l.route_name)},null,10,ue),t("div",{class:"py-1 self-stretch text-slate-500 text-sm font-semibold leading-relaxed tracking-wide",textContent:h(l.description)},null,8,fe)],8,de),t("div",he,[t("div",{class:"px-3 py-2 bg-purple-800 rounded-full justify-center items-center flex cursor-pointer",onClick:m=>e.setLocationsMarkers(l,p)},me,8,_e),t("div",{class:"px-3 py-2 bg-purple-800 rounded justify-center items-center flex cursor-pointer",onClick:m=>e.handleAction("edit",l)},pe,8,ge)])]),ke,t("div",be,[(a(!0),c(V,null,D(l.pickup_locations,(m,b)=>(a(),c("img",{style:j("left: "+20*b+"px"),class:"rounded-full w-8 h-8 left-0 top-0 absolute rounded-[50px] border-2 border-purple-800",src:m.student&&m.student.picture?m.student.picture:"https://via.placeholder.com/37x37"},null,12,we))),256)),t("span",{class:"absolute pt-2",style:j("left: "+(20*l.pickup_locations.length+20)+"px")},[ye,K(),l.pickup_locations?(a(),c("span",{key:0,class:"font-semibold px-1",textContent:h(l.pickup_locations.length)},null,8,Ce)):r("",!0)],4),t("div",Se,[Le,l.vehicle?(a(),c("span",{key:0,class:"font-semibold text-sm",textContent:h(l.vehicle.plate_number)},null,8,Fe)):r("",!0)])])])],2)):r("",!0)]))),128))])):r("",!0),t("div",Te,[t("div",{class:"menu-dark rounded-lg text-white text-xs font-medium px-4 py-3 uppercase cursor-pointer",onClick:n[4]||(n[4]=l=>{e.showAddSide=!0,e.activeItem={}}),textContent:h(e.translate("add new"))},null,8,je),t("div",{onClick:n[5]||(n[5]=l=>e.collapsed=!e.collapsed),class:"cursor-pointer p-2 block text-center"},[t("i",{class:T(["fa",e.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),t("p",{class:"font-semibold",textContent:h(e.collapsed?e.translate("Expand"):e.translate("Collapse"))},null,8,Ae)])])],4),Ee,t("main",Me,[t("div",Ie,[t("h1",{class:"font-bold text-lg w-full",textContent:h(e.content.title)},null,8,Pe),t("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg menu-dark hover:bg-purple-800",onClick:n[6]||(n[6]=l=>{e.showAddSide=!0,e.activeItem={}})},h(e.translate("add_new")),1)]),Re,t("div",Ve,[e.content.columns?(a(),y(S,{key:0,"body-text-direction":e.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:e.content.columns,items:e.content.items},{"item-picture":A(l=>[t("img",{src:l.picture,class:"w-8 h-8 rounded-full"},null,8,De)]),"item-edit":A(l=>[l.not_editable?r("",!0):(a(),c("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:p=>e.handleAction("edit",l)},ze,8,Be))]),"item-delete":A(l=>[l.not_removeable?r("",!0):(a(),c("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:p=>e.handleAction("delete",l)},[H(g,{class:"w-4"})],8,Oe))]),_:1},8,["body-text-direction","headers","items"])):r("",!0),e.showAddSide&&e.content&&e.content.fillable?(a(),y(v,{key:1,onCallback:e.closeSide,conf:_.conf,model:"Routes.create",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","columns"])):r("",!0),e.showEditSide&&!e.showAddSide?(a(),y(L,{onCallback:e.closeSide,key:e.activeItem,conf:_.conf,model:"Routes.update",item:e.activeItem,model_id:e.activeItem.route_id,index:"route_id",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","item","model_id","columns"])):r("",!0)])])])):r("",!0)])}const Ge=O(ee,[["render",Ue]]);export{Ge as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/map-t0yXlqnI.js","assets/index-ghXfiaMh.js","assets/index-0QZ6nb97.css","assets/side-form-create-utiaFufh.js","assets/Field-svu0iQ1t.js","assets/Manager-IB1cWjt2.js","assets/Manager-Cgf44v6b.css","assets/side-form-update-3JjyWDne.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}