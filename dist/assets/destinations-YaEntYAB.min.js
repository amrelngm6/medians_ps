import{_ as F,D as N,e as P,z as U,A as z,f as c,t as R,r as g,o as s,c as u,g as o,l as y,i as r,H as G,h,B as J,C as K,F as q,j as H,a as j,y as Q,G as L,d as T,b as D,m as W,s as X,p as Y}from"./index.min.js";const Z=T(()=>D(()=>import("./map-jgKxgDMN.min.js"),__vite__mapDeps([0,1,2,3]))),$=T(()=>D(()=>import("./side-form-create-1jFihfhr.min.js"),__vite__mapDeps([4,2,3,5,6]))),ee=T(()=>D(()=>import("./side-form-update-Q_-rVJdX.min.js"),__vite__mapDeps([7,2,3,5,6,8,9,1]))),te={components:{datatabble:N,SideFormCreate:$,SideFormUpdate:ee,maps:Z,delete_icon:P,car_icon:U,route_icon:z},name:"Destinations",setup(m){const l=m.conf.url+m.path+"?load=json",_=c(!1),e=c(!1);c(null);const f=c({}),d=c({}),w=c({}),x=c([]);c(!0);const v=c("");c(null);const C=c(!1),p=()=>{_.value=!1,e.value=!1};(()=>{W(l).then(t=>{d.value=JSON.parse(JSON.stringify(t)),n(d.value.items),E()})})();const n=t=>{let a=[];for(let i=0;i<t.length;i++)a[i]=O(t[i]);x.value=a},k=(t,a)=>{f.value=t;for(let A=0;A<d.value.items.length;A++)d.value.items[A].selected=!1;d.value.items[a].selected=!0;let i=O(t);x.value=[i],w.value=i.destination},b=async()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{w.value={lat:t.coords.latitude,lng:t.coords.longitude}},t=>{X(t.message,5e3)})};b();const E=()=>{for(let t=0;t<d.value.items.length;t++)d.value.items[t].active=v.value.trim()?I(d.value.items[t]):1},I=t=>{let a=!!t.student_name.toLowerCase().includes(v.value.toLowerCase());return a||!!t.location_name.toLowerCase().includes(v.toLowerCase())},V=t=>{f.value=t,S("edit",t)},B=(t,a,i)=>{f.value=i,f.value.latitude=i.destination.lat,f.value.longitude=i.destination.lng,S("edit",f.value)},O=t=>(t.icon=m.conf.url+"uploads/images/blue_pin.gif",t.origin=t.destination={lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)},t.drag=!0,t),S=(t,a)=>{switch(t){case"view":break;case"edit":e.value=!0,_.value=!1,f.value=a;break;case"delete":Y("destination_id",a,"Destination.delete");break}};return{locations:x,showAddSide:_,showEditSide:e,url:l,content:d,center:w,activeItem:f,translate:R,clickMarker:B,updateMarker:V,setLocationsMarkers:k,checkSimilar:I,searchTextChanged:E,searchText:v,getUserLocation:b,collapsed:C,closeSide:p,handleAction:S}},props:["path","lang","setting","conf","auth"]},ne={class:"w-full flex overflow-auto"},oe={class:"w-full"},le={key:0,class:"relative flex-1 overflow-x-hidden overflow-y-auto w-full"},se={class:"self-stretch py-4 flex-col justify-center items-start flex"},ae=["textContent"],ie=["textContent"],ce={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},re=["placeholder"],de={key:0,class:"grow shrink basis-0 gap-4 justify-start items-center flex"},ue={class:"justify-start items-center flex"},fe=["src"],he=["onClick"],me=["textContent"],_e=["textContent"],xe={class:"justify-center items-center flex"},ve=["onClick"],ge={class:"text-center text-xs text-white uppercase tracking-tight"},we={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},ke=["textContent"],be=["textContent"],ye={class:"px-4 mb-6 py-4 rounded-lg shadow-md bg-white dark:bg-gray-700 flex w-full"},Ce=["textContent"],pe=o("hr",{class:"mt-2"},null,-1),Se={class:"w-full bg-white"},Ae=["src"],je=["onClick"],Le=["onClick"];function Te(m,l,_,e,f,d){const w=g("maps"),x=g("vue-feather"),v=g("delete_icon"),C=g("datatabble"),p=g("side-form-create"),M=g("side-form-update");return s(),u("div",ne,[o("div",oe,[e.content&&!m.showLoader?(s(),u("main",le,[e.locations.length?(s(),y(w,{showroute:!1,onUpdateMarker:e.updateMarker,onClickMarker:e.clickMarker,setting:_.setting,draggable:!0,key:e.center,center:e.center,waypoints:e.locations},null,8,["onUpdateMarker","onClickMarker","setting","center","waypoints"])):r("",!0),e.content.items?(s(),u("div",{key:e.content.items,style:G(e.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-16 h-full absolute top-4 rounded-lg p-4 w-96 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[o("div",se,[o("div",{class:"text-black text-lg font-semibold",textContent:h(e.translate("Destinations"))},null,8,ae),o("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:h(e.translate("Destinations description"))},null,8,ie)]),e.collapsed?r("",!0):(s(),u("div",ce,[J(o("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:e.translate("find by name and address"),"onUpdate:modelValue":l[0]||(l[0]=n=>e.searchText=n),onChange:l[1]||(l[1]=(...n)=>e.searchTextChanged&&e.searchTextChanged(...n)),onInput:l[2]||(l[2]=(...n)=>e.searchTextChanged&&e.searchTextChanged(...n)),onKeydown:l[3]||(l[3]=(...n)=>e.searchTextChanged&&e.searchTextChanged(...n))},null,40,re),[[K,e.searchText]])])),e.collapsed?r("",!0):(s(),u("div",{key:e.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[(s(!0),u(q,null,H(e.content.items,(n,k)=>(s(),u("div",{key:n,class:"pt-2 w-full self-stretch justify-start items-center inline-flex"},[n.active?(s(),u("div",de,[o("div",ue,[o("img",{class:"w-10 h-10 rounded-full shadow-inner border-2 border-black",src:n.student&&n.student.picture?n.student.picture:"https://via.placeholder.com/60x6"},null,8,fe)]),o("div",{onClick:b=>e.setLocationsMarkers(n,k),class:"grow shrink basis-0 flex-col justify-center items-start gap-[3px] inline-flex cursor-pointer"},[o("div",{class:"text-black font-semibold text-base",textContent:h(n.student_name)},null,8,me),o("div",{class:"self-stretch text-slate-500 text-sm font-normal",textContent:h(n.location_name+" - "+n.address)},null,8,_e)],8,he)])):r("",!0),o("div",xe,[o("div",{class:"w-10 h-10 p-2 bg-purple-800 rounded justify-center items-center flex mr-2 cursor-pointer",onClick:b=>e.handleAction("edit",n)},[o("div",ge,[j(x,{class:"w-5",type:"edit"})])],8,ve)])]))),128))])),o("div",we,[o("div",{class:"menu-dark rounded-lg text-white text-xs font-medium px-4 py-3 uppercase cursor-pointer",onClick:l[4]||(l[4]=n=>{e.showAddSide=!0,e.activeItem={}}),textContent:h(e.translate("add new"))},null,8,ke),o("div",{onClick:l[5]||(l[5]=n=>e.collapsed=!e.collapsed),class:"cursor-pointer p-2 block text-center"},[o("i",{class:Q(["fa",e.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),o("p",{class:"font-semibold",textContent:h(e.collapsed?e.translate("Expand"):e.translate("Collapse"))},null,8,be)])])],4)):r("",!0),o("div",ye,[o("h1",{class:"font-bold text-lg w-full",textContent:h(e.content.title)},null,8,Ce),o("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg bg-danger",onClick:l[6]||(l[6]=n=>{m.showLoader=!0,e.showAddSide=!0,e.activeItem={},m.showLoader=!1})},h(e.translate("add_new")),1)]),pe,o("div",Se,[e.content.columns?(s(),y(C,{key:0,"body-text-direction":e.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:e.content.columns,items:e.content.items},{"item-picture":L(n=>[o("img",{src:n.picture,class:"w-8 h-8 rounded-full"},null,8,Ae)]),"item-edit":L(n=>[n.not_editable?r("",!0):(s(),u("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:k=>e.handleAction("edit",n)},[j(x,{class:"w-5",type:"edit"})],8,je))]),"item-delete":L(n=>[n.not_removeable?r("",!0):(s(),u("button",{key:0,class:"p-2 hover:text-gray-600 text-red-500",onClick:k=>e.handleAction("delete",n)},[j(v,{class:"w-5"})],8,Le))]),_:1},8,["body-text-direction","headers","items"])):r("",!0),e.showAddSide&&e.content&&e.content.fillable?(s(),y(p,{key:1,onCallback:e.closeSide,conf:_.conf,model:"Destination.create",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","columns"])):r("",!0),e.showEditSide&&!e.showAddSide?(s(),y(M,{key:2,onCallback:e.closeSide,conf:_.conf,model:"Destination.update",item:e.activeItem,model_id:e.activeItem.destination_id,index:"destination_id",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","item","model_id","columns"])):r("",!0)])])):r("",!0)])])}const Me=F(te,[["render",Te]]);export{Me as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["map-jgKxgDMN.min.js","index.es-dVNFsHlS.min.js","index.min.js","index.min.css","side-form-create-1jFihfhr.min.js","Field-HcJWtOn8.min.js","Field.min.css","side-form-update-Q_-rVJdX.min.js","form_field-U9gnZiHm.min.js","editable_map_location-HWXHnUGu.min.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
