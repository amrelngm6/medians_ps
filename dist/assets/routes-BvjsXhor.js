import{_ as O,E as U,G,z as r,s as q,r as k,o as n,c,j as b,d,a as l,t as h,w as J,v as K,F as j,i as A,n as E,l as M,k as H,u as C,b as Q,x as I,y as P,q as W,B as X,p as Y}from"./index-AOwosMHJ.js";const Z=I(()=>P(()=>import("./map-FQHPSRm_.js"),__vite__mapDeps([0,1,2]))),$=I(()=>P(()=>import("./side-form-create-Fd7YWqr8.js"),__vite__mapDeps([3,1,2,4,5,6]))),ee=I(()=>P(()=>import("./side-form-update-WwcC_u0x.js"),__vite__mapDeps([7,1,2,4,5,6]))),te={components:{datatabble:U,SideFormCreate:$,SideFormUpdate:ee,maps:Z,delete_icon:G},name:"Students",setup(m){const o=m.conf.url+m.path+"?load=json",_=r(!1),e=r(!1),S=r(null),u=r({}),f=r({}),p=r({});r([]),r(!0);const g=r(""),L=r(null),F=r(!1),t=()=>{_.value=!1,e.value=!1};(()=>{W(o).then(s=>{f.value=JSON.parse(JSON.stringify(s)),w()})})();const x=async()=>{navigator.geolocation?(console.log("position 1"),navigator.geolocation.getCurrentPosition(s=>{p.value={lat:s.coords.latitude,lng:s.coords.longitude}},s=>{X(s.message,5e3)})):L.value="Geolocation is not supported by this browser."};x();const w=()=>{for(let s=0;s<f.value.items.length;s++)f.value.items[s].active=g.value.trim()?R(f.value.items[s]):1},R=s=>{let i=!!s.route_name.toLowerCase().includes(g.value.toLowerCase());return i||!!s.description.toLowerCase().includes(g.toLowerCase())},B=(s,i)=>{u.value=s;for(let a=0;a<f.value.items.length;a++)f.value.items[a].selected=!1;f.value.items[i].selected=!0,D.value=V(s)},N=(s,i,a)=>{u.value.latitude=a.latLng.lat(),u.value.longitude=a.latLng.lng(),T("edit",u.value)},z=(s,i,a)=>{u.value.latitude=a.latLng.lat(),u.value.longitude=a.latLng.lng(),T("edit",u.value)},V=s=>{let i,a=[];for(let y=0;y<s.pickup_locations.length;y++)i=s.pickup_locations[y],a[y]={icon:m.conf.url+"uploads/images/blue_pin.gif",origin:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)},destination:{lat:parseFloat(i.latitude),lng:parseFloat(i.longitude)}};return a[a.length]={icon:m.conf.url+"uploads/images/car.svg",origin:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)},destination:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)}},p.value=a[0].destination,a[a.length]={drag:!0,icon:m.conf.url+"uploads/images/destination.svg",origin:{lat:parseFloat(s.vehicle.last_latitude),lng:parseFloat(s.vehicle.last_longitude)},destination:{lat:parseFloat(s.latitude),lng:parseFloat(s.longitude)}},a},T=(s,i)=>{switch(s){case"view":break;case"edit":u.value=i,_.value=!1,e.value=!0,S.value=!0;break;case"delete":Y("driver_id",i,"Driver.delete");break;case"close":e.value=!1,_.value=!1,S.value=!1,u.value={};break}},D=r([]);return{showAddSide:_,waypoints:D,showEditSide:e,url:o,content:f,center:p,activeItem:u,translate:q,setLocationsPickups:V,clickMarker:z,updateMarker:N,setLocationsMarkers:B,checkSimilar:R,searchTextChanged:w,searchText:g,getUserLocation:x,collapsed:F,closeSide:t,handleAction:T}},props:["path","lang","setting","conf","auth"]},le={class:"w-full flex overflow-auto",style:{height:"85vh","z-index":"9999"}},se={key:0,class:"w-full relative"},ne={class:"self-stretch py-4 flex-col justify-center items-start flex"},oe=["textContent"],ae=["textContent"],ie={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},ce=["placeholder"],re={class:"w-full grow shrink basis-0 px-6 py-4 flex-col justify-center items-start gap-4 inline-flex"},de={class:"w-full self-stretch justify-start items-start inline-flex cursor-pointer"},ue=["onClick"],fe=["textContent"],he=["textContent"],_e={class:"gap-2 py-2 flex justify-start items-start gap-2.5 inline-flex"},xe=["onClick"],me=l("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[l("i",{class:"fa fa-location-dot"})],-1),ge=[me],ve=["onClick"],pe=l("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[l("i",{class:"fa fa-edit"})],-1),ke=[pe],we=l("hr",{class:"w-full"},null,-1),ye={class:"w-full h-8 relative flex"},be=["src"],Ce=l("i",{class:"fa fa-location-dot text-sm"},null,-1),Se=["textContent"],Le={class:"right-0 absolute self-stretch text-slate-500 text-base font-normal"},Fe=l("i",{class:"fa fa-car px-2"},null,-1),Te=["textContent"],je={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},Ae=["textContent"],Ee=["textContent"],Me=l("hr",{class:"mt-2"},null,-1),Ie={class:"flex-1 overflow-x-hidden overflow-y-auto w-full relative"},Pe={class:"px-4 mb-6 py-4 rounded-lg shadow-lg bg-white dark:bg-gray-700 flex w-full"},Re=["textContent"],Ve=l("hr",{class:"mt-2"},null,-1),De={class:"w-full"},Be=["src"],Ne=["src"],ze=["onClick"],Oe=l("i",{class:"fa fa-edit"},null,-1),Ue=[Oe],Ge=["onClick"];function qe(m,o,_,e,S,u){const f=k("maps"),p=k("delete_icon"),g=k("datatabble"),L=k("side-form-create"),F=k("side-form-update");return n(),c("div",le,[e.content?(n(),c("div",se,[e.center?(n(),b(f,{conf:_.conf,setting:_.setting,key:e.center,center:e.center,onUpdateMarker:e.updateMarker,onClickMarker:e.clickMarker,waypoints:e.waypoints,showroute:!1},null,8,["conf","setting","center","onUpdateMarker","onClickMarker","waypoints"])):d("",!0),l("div",{style:M(e.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-16 h-full absolute top-4 rounded-lg p-4 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[l("div",ne,[l("div",{class:"text-black text-lg font-semibold",textContent:h(e.translate("Routes"))},null,8,oe),l("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:h(e.translate("Routes description"))},null,8,ae)]),e.collapsed?d("",!0):(n(),c("div",ie,[J(l("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:e.translate("find by name and address"),"onUpdate:modelValue":o[0]||(o[0]=t=>e.searchText=t),onChange:o[1]||(o[1]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t)),onInput:o[2]||(o[2]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t)),onKeydown:o[3]||(o[3]=(...t)=>e.searchTextChanged&&e.searchTextChanged(...t))},null,40,ce),[[K,e.searchText]])])),!e.collapsed&&e.content.items?(n(),c("div",{key:e.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[(n(!0),c(j,null,A(e.content.items,(t,v)=>(n(),c("div",{key:t.active,class:"w-full"},[t.active?(n(),c("div",{key:0,class:E([t.selected?"text-fuchsia-600":"bg-gray-50","mb-4 w-full rounded-lg justify-start items-center inline-flex"])},[l("div",re,[l("div",de,[l("div",{onClick:x=>e.setLocationsMarkers(t,v),class:"w-full grow shrink basis-0 flex-col justify-start items-start inline-flex"},[l("div",{class:E([t.selected?"text-fuchsia-600":"text-gray-800","self-stretch text-base font-semibold tracking-tight"]),textContent:h(t.route_name)},null,10,fe),l("div",{class:"py-1 self-stretch text-slate-500 text-sm font-semibold leading-relaxed tracking-wide",textContent:h(t.description)},null,8,he)],8,ue),l("div",_e,[l("div",{class:"px-3 py-2 bg-purple-800 rounded-full justify-center items-center flex cursor-pointer",onClick:x=>e.setLocationsMarkers(t,v)},ge,8,xe),l("div",{class:"px-3 py-2 bg-purple-800 rounded justify-center items-center flex cursor-pointer",onClick:x=>e.handleAction("edit",t)},ke,8,ve)])]),we,l("div",ye,[(n(!0),c(j,null,A(t.pickup_locations,(x,w)=>(n(),c("img",{style:M("left: "+20*w+"px"),class:"rounded-full w-8 h-8 left-0 top-0 absolute rounded-[50px] border-2 border-purple-800",src:x.student&&x.student.picture?x.student.picture:"https://via.placeholder.com/37x37"},null,12,be))),256)),l("span",{class:"absolute pt-2",style:M("left: "+(20*t.pickup_locations.length+20)+"px")},[Ce,H(),t.pickup_locations?(n(),c("span",{key:0,class:"font-semibold px-1",textContent:h(t.pickup_locations.length)},null,8,Se)):d("",!0)],4),l("div",Le,[Fe,t.vehicle?(n(),c("span",{key:0,class:"font-semibold text-sm",textContent:h(t.vehicle.plate_number)},null,8,Te)):d("",!0)])])])],2)):d("",!0)]))),128))])):d("",!0),l("div",je,[l("div",{class:"menu-dark rounded-lg text-white text-xs font-medium px-4 py-3 uppercase cursor-pointer",onClick:o[4]||(o[4]=t=>{e.showAddSide=!0,e.activeItem={}}),textContent:h(e.translate("add new"))},null,8,Ae),l("div",{onClick:o[5]||(o[5]=t=>e.collapsed=!e.collapsed),class:"cursor-pointer p-2 block text-center"},[l("i",{class:E(["fa",e.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),l("p",{class:"font-semibold",textContent:h(e.collapsed?e.translate("Expand"):e.translate("Collapse"))},null,8,Ee)])])],4),Me,l("main",Ie,[l("div",Pe,[l("h1",{class:"font-bold text-lg w-full",textContent:h(e.content.title)},null,8,Re),l("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg menu-dark hover:bg-purple-800",onClick:o[6]||(o[6]=t=>{e.showAddSide=!0,e.activeItem={}})},h(e.translate("add_new")),1)]),Ve,l("div",De,[e.content.columns?(n(),b(g,{key:0,"body-text-direction":e.translate("lang")=="ar"?"right":"left","fixed-checkbox":"",headers:e.content.columns,items:e.content.items},{"item-picture":C(t=>[l("img",{src:t.picture,class:"w-8 h-8 rounded-full"},null,8,Be)]),"item-pickup_locations":C(t=>[(n(!0),c(j,null,A(t.pickup_locations,v=>(n(),c("img",{src:t.picture,class:"w-8 h-8 rounded-full"},null,8,Ne))),256))]),"item-edit":C(t=>[t.not_editable?d("",!0):(n(),c("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:v=>e.handleAction("edit",t)},Ue,8,ze))]),"item-delete":C(t=>[t.not_removeable?d("",!0):(n(),c("button",{key:0,class:"p-2 hover:text-gray-600 text-purple",onClick:v=>e.handleAction("delete",t)},[Q(p,{class:"w-4"})],8,Ge))]),_:1},8,["body-text-direction","headers","items"])):d("",!0),e.showAddSide&&e.content&&e.content.fillable?(n(),b(L,{key:1,onCallback:e.closeSide,conf:_.conf,model:"Routes.create",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","columns"])):d("",!0),e.showEditSide&&!e.showAddSide?(n(),b(F,{onCallback:e.closeSide,key:e.activeItem,conf:_.conf,model:"Routes.update",item:e.activeItem,model_id:e.activeItem.route_id,index:"route_id",columns:e.content.fillable,class:"col-md-3"},null,8,["onCallback","conf","item","model_id","columns"])):d("",!0)])])])):d("",!0)])}const Ke=O(te,[["render",qe]]);export{Ke as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/map-FQHPSRm_.js","assets/index-AOwosMHJ.js","assets/index-0QZ6nb97.css","assets/side-form-create-Fd7YWqr8.js","assets/Field-3EN8y1Z9.js","assets/Manager-tvb9m_Ur.js","assets/Manager-Cgf44v6b.css","assets/side-form-update-WwcC_u0x.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}