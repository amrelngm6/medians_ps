import{_ as P,D as V,p as B,q as r,s as F,r as w,o as c,c as h,a as s,j as C,d as f,l as z,t as m,w as N,v as U,F as R,i as q,n as J,b as K,m as G,x as b,y as H,z as Q,A as W,B as A}from"./index-aQkbjxpI.js";import{c as X,r as Y}from"./car-dEYFmzy6.js";const Z=b(()=>A(()=>import("./map-VSjxMy5h.js"),__vite__mapDeps([0,1,2]))),$=b(()=>A(()=>import("./side-form-create-RD2p9J-X.js"),__vite__mapDeps([3,1,2,4,5,6]))),ee=b(()=>A(()=>import("./side-form-update-BtLYaAcY.js"),__vite__mapDeps([7,1,2,4,5,6]))),te={components:{datatabble:V,SideFormCreate:$,SideFormUpdate:ee,maps:Z,delete_icon:B,car_icon:X,route_icon:Y},name:"Destinations",setup(l){const o=l.conf.url+l.path+"?load=json",v=r(!1),e=r(!1);r(null);const u=r({}),d=r({}),g=r({}),x=r([]);r(!0);const _=r("");r(null);const p=r(!1),n=()=>{v.value=!1,e.value=!1};(()=>{H(o).then(t=>{d.value=JSON.parse(JSON.stringify(t)),E(d.value.items),j()})})();const E=t=>{let a=[];for(let i=0;i<t.length;i++)a[i]=S(t[i]);x.value=a},I=(t,a)=>{u.value=t;for(let y=0;y<d.value.items.length;y++)d.value.items[y].selected=!1;d.value.items[a].selected=!0;let i=S(t);x.value=[i],g.value=i.destination},T=async()=>{navigator.geolocation&&(console.log("position 1"),navigator.geolocation.getCurrentPosition(t=>{g.value={lat:t.coords.latitude,lng:t.coords.longitude}},t=>{Q(t.message,5e3)}))};T();const j=()=>{for(let t=0;t<d.value.items.length;t++)d.value.items[t].active=_.value.trim()?D(d.value.items[t]):1},D=t=>{let a=!!t.student_name.toLowerCase().includes(_.value.toLowerCase());return a||!!t.location_name.toLowerCase().includes(_.toLowerCase())},M=t=>{console.log("updated"),u.value=t,k("edit",t)},O=(t,a,i)=>{u.value=i,u.value.latitude=i.destination.lat,u.value.longitude=i.destination.lng,k("edit",u.value)},S=t=>(t.icon=l.conf.url+"uploads/images/blue_pin.gif",t.origin=t.destination={lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)},t.drag=!0,t),k=(t,a)=>{switch(t){case"view":break;case"edit":e.value=!0,v.value=!1,u.value=a;break;case"delete":W("pickup_id",a,"PickupLocation.delete");break}};return{locations:x,showAddSide:v,showEditSide:e,url:o,content:d,center:g,activeItem:u,translate:F,clickMarker:O,updateMarker:M,setLocationsMarkers:I,checkSimilar:D,searchTextChanged:j,searchText:_,getUserLocation:T,collapsed:p,closeSide:n,handleAction:k}},props:["path","lang","setting","conf","auth"]},se={class:"w-full flex overflow-auto",style:{height:"85vh","z-index":"9999"}},ne={class:"w-full"},oe={key:0,class:"relative flex-1 overflow-x-hidden overflow-y-auto w-full"},le={class:"self-stretch py-4 flex-col justify-center items-start flex"},ae=["textContent"],ie=["textContent"],re={key:0,class:"w-full self-stretch pt-2 flex-col justify-center items-start flex"},ce=["placeholder"],de={key:0,class:"grow shrink basis-0 gap-4 justify-start items-center flex"},ue={class:"justify-start items-center flex"},fe=["src"],he=["onClick"],me=["textContent"],ve=["textContent"],_e={class:"justify-center items-center flex"},ge=["onClick"],xe=s("div",{class:"text-center text-xs text-white uppercase tracking-tight"},[s("i",{class:"fa fa-edit"})],-1),we=[xe],pe={class:"flex self-stretch grow shrink basis-0 justify-between items-center inline-flex"},ke=["textContent"],ye=["textContent"],Ce={class:"px-4 mb-6 py-4 rounded-lg shadow-lg bg-white dark:bg-gray-700 flex w-full"},be=["textContent"],Ae=s("hr",{class:"mt-2"},null,-1),Le={class:"w-full flex gap gap-6"};function Te(l,o,v,e,u,d){const g=w("maps"),x=w("data-table"),_=w("side-form-create"),p=w("side-form-update");return c(),h("div",se,[s("div",ne,[e.content&&!l.showLoader?(c(),h("main",oe,[e.locations.length?(c(),C(g,{showroute:!1,onUpdateMarker:l.updatedDestination,onClickMarker:l.updatedDestination,setting:v.setting,key:e.center,center:e.center,waypoints:e.locations},null,8,["onUpdateMarker","onClickMarker","setting","center","waypoints"])):f("",!0),e.locations.length?(c(),h("div",{key:1,style:z(e.collapsed?"max-height:240px":"max-height:calc(100vh - 140px)"),class:"mx-16 h-full absolute top-4 rounded-lg p-4 w-96 bg-white rounded-xl flex-col justify-start items-start inline-flex"},[s("div",le,[s("div",{class:"text-black text-lg font-semibold",textContent:m(e.translate("Destinations"))},null,8,ae),s("div",{class:"py-2 self-stretch text-zinc-600 text-base tracking-wide",textContent:m(e.translate("Destinations description"))},null,8,ie)]),e.collapsed?f("",!0):(c(),h("div",re,[N(s("input",{class:"w-full bg-gray-100 rounded-lg px-4 py-2",placeholder:e.translate("find by name and address"),"onUpdate:modelValue":o[0]||(o[0]=n=>e.searchText=n),onChange:o[1]||(o[1]=(...n)=>e.searchTextChanged&&e.searchTextChanged(...n)),onInput:o[2]||(o[2]=(...n)=>e.searchTextChanged&&e.searchTextChanged(...n)),onKeydown:o[3]||(o[3]=(...n)=>e.searchTextChanged&&e.searchTextChanged(...n))},null,40,ce),[[U,e.searchText]])])),e.collapsed?f("",!0):(c(),h("div",{key:e.collapsed,class:"max-h-[400px] overflow-auto my-4 w-full self-stretch py-4"},[l.showList&&l.destination.active?(c(!0),h(R,{key:0},q(e.content.items,n=>(c(),h("div",{key:n.active,class:"pt-2 w-full self-stretch justify-start items-center inline-flex"},[n.active?(c(),h("div",de,[s("div",ue,[s("img",{class:"w-10 h-10 rounded-full shadow-inner border-2 border-black",src:n.student&&n.student.picture?n.student.picture:"https://via.placeholder.com/60x6"},null,8,fe)]),s("div",{onClick:L=>l.setDestinationsMarkers(n),class:"grow shrink basis-0 flex-col justify-center items-start gap-[3px] inline-flex cursor-pointer"},[s("div",{class:"text-black font-semibold text-base",textContent:m(n.student_name)},null,8,me),s("div",{class:"self-stretch text-slate-500 text-sm font-normal",textContent:m(n.location_name+" - "+n.address)},null,8,ve)],8,he)])):f("",!0),s("div",_e,[s("div",{class:"px-3 py-2 bg-purple-800 rounded justify-center items-center flex mr-2 cursor-pointer",onClick:L=>e.handleAction("edit",n)},we,8,ge)])]))),128)):f("",!0)])),s("div",pe,[s("div",{class:"menu-dark rounded-lg text-white text-xs font-medium px-4 py-3 uppercase cursor-pointer",onClick:o[4]||(o[4]=n=>{l.showLoader=!0,e.showAddSide=!0,e.activeItem={},l.showLoader=!1}),textContent:m(e.translate("add new"))},null,8,ke),s("div",{onClick:o[5]||(o[5]=n=>e.collapsed=!e.collapsed),class:"cursor-pointer p-2 block text-center"},[s("i",{class:J(["fa",e.collapsed?"fa-circle-down":"fa-circle-up"])},null,2),s("p",{class:"font-semibold",textContent:m(e.collapsed?e.translate("Expand"):e.translate("Collapse"))},null,8,ye)])])],4)):f("",!0),s("div",Ce,[s("h1",{class:"font-bold text-lg w-full",textContent:m(e.content.title)},null,8,be),s("a",{href:"javascript:;",class:"uppercase p-2 mx-2 text-center text-white w-32 rounded-lg menu-dark hover:bg-purple-800",onClick:o[6]||(o[6]=n=>{l.showLoader=!0,e.showAddSide=!0,e.activeItem={},l.showLoader=!1})},m(e.translate("add_new")),1)]),Ae,s("div",Le,[K(x,G({ref:"destinations",onActionTriggered:e.handleAction},l.bindings),null,16,["onActionTriggered"]),e.showAddSide&&e.content&&e.content.fillable?(c(),C(_,{key:0,conf:v.conf,model:"Destination.create",columns:e.content.fillable,class:"col-md-3"},null,8,["conf","columns"])):f("",!0),e.showEditSide&&!e.showAddSide?(c(),C(p,{key:1,conf:v.conf,model:"Destination.update",item:e.activeItem,model_id:e.activeItem.destination_id,index:"destination_id",columns:e.content.fillable,class:"col-md-3"},null,8,["conf","item","model_id","columns"])):f("",!0)])])):f("",!0)])])}const Se=P(te,[["render",Te]]);export{Se as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/map-VSjxMy5h.js","assets/index-aQkbjxpI.js","assets/index-OY3wY1QZ.css","assets/side-form-create-RD2p9J-X.js","assets/Field-HV6FzDiX.js","assets/Manager-CesiHNTE.js","assets/Manager-Cgf44v6b.css","assets/side-form-update-BtLYaAcY.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}